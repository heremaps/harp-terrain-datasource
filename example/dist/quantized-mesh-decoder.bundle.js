!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=31)}([function(e,t){e.exports=THREE},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=180/Math.PI,i=Math.PI/180,o=function(){function e(e,t,n){this.latitude=e,this.longitude=t,this.altitude=n}return e.fromDegrees=function(t,n,r){return new e(t,n,r)},e.fromRadians=function(t,n,i){return new e(t*r,n*r,i)},Object.defineProperty(e.prototype,"latitudeInRadians",{get:function(){return this.latitude*i},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeInRadians",{get:function(){return this.longitude*i},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeInDegrees",{get:function(){return this.latitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeInDegrees",{get:function(){return this.longitude},enumerable:!0,configurable:!0}),e.prototype.isValid=function(){return!isNaN(this.latitude)&&!isNaN(this.longitude)},e.prototype.normalized=function(){var t,n=this.latitude,r=this.longitude;if(isNaN(n)||isNaN(r))return this;n>90&&((t=(n+90)%360)>=180&&(r+=180,t=360-t),n=t-90);n<-90&&((t=(n-90)%360)<=-180&&(r+=180,t=-360-t),n=t+90);return(r<-180||r>180)&&(r=(r+180)%360-180),n===this.latitude&&r===this.longitude?this:new e(n,r,this.altitude)},e.prototype.equals=function(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.altitude===e.altitude},e.prototype.copy=function(e){return this.latitude=e.latitude,this.longitude=e.longitude,this.altitude=e.altitude,this},e.prototype.clone=function(){return new e(this.latitude,this.longitude,this.altitude)},e}();t.GeoCoordinates=o},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(44)),r(n(45)),r(n(49)),r(n(50)),r(n(51)),r(n(52)),r(n(53)),r(n(54)),r(n(55)),r(n(56))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=Math.PI/180,o=function(){function e(e,t){this.southWest=e,this.northEast=t}return e.fromCoordinates=function(t,n){return new e(t,n)},Object.defineProperty(e.prototype,"minAltitude",{get:function(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.min(this.southWest.altitude,this.northEast.altitude)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxAltitude",{get:function(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.max(this.southWest.altitude,this.northEast.altitude)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"south",{get:function(){return this.southWest.latitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"north",{get:function(){return this.northEast.latitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"west",{get:function(){return this.southWest.longitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"east",{get:function(){return this.northEast.longitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){var e,t=.5*(this.south+this.north),n=this.west,i=this.east,o=this.minAltitude,a=this.altitudeSpan;if(void 0!==o&&void 0!==a&&(e=o+.5*a),n<i)return new r.GeoCoordinates(t,.5*(n+i),e);var s=.5*(360+i+n);return s>360&&(s-=360),new r.GeoCoordinates(t,s,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeSpanInRadians",{get:function(){return this.latitudeSpan*i},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeSpanInRadians",{get:function(){return this.longitudeSpan*i},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeSpan",{get:function(){return this.north-this.south},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altitudeSpan",{get:function(){if(void 0!==this.maxAltitude&&void 0!==this.minAltitude)return this.maxAltitude-this.minAltitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeSpan",{get:function(){var e=this.northEast.longitude-this.southWest.longitude;return e<0&&(e+=360),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeSpanInDegrees",{get:function(){return this.latitudeSpan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeSpanInDegrees",{get:function(){return this.longitudeSpan},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){if(void 0===e.altitude||void 0===this.minAltitude||void 0===this.maxAltitude)return this.containsHelper(e);var t=this.minAltitude===this.maxAltitude,n=this.minAltitude===e.altitude,r=this.minAltitude<=e.altitude&&this.maxAltitude>e.altitude;return!(t?!n:!r)&&this.containsHelper(e)},e.prototype.clone=function(){return new e(this.southWest,this.northEast)},e.prototype.containsHelper=function(e){if(e.latitude<this.southWest.latitude||e.latitude>=this.northEast.latitude)return!1;var t=this.west,n=this.east;return n>t?e.longitude>=t&&e.longitude<n:e.longitude>n||e.longitude<=t},e}();t.GeoBox=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Math.PI/180,i=180/Math.PI;!function(e){function t(e){return(e%=360)<0&&(e+=360),e}function n(e,n){var r=(e=t(e))-(n=t(n));return r>180?r-360:r<=-180?r+360:r}e.newEmptyBox3=function(){return{min:{x:1/0,y:1/0,z:1/0},max:{x:-1/0,y:-1/0,z:-1/0}}},e.degToRad=function(e){return e*r},e.radToDeg=function(e){return e*i},e.clamp=function(e,t,n){return e<t?t:e>n?n:e},e.normalizeAngleDeg=t,e.angleDistanceDeg=n,e.interpolateAnglesDeg=function(e,t,r){return(e+n(t,e)*r)%360}}(t.MathUtils||(t.MathUtils={}))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(35)),r(n(29)),r(n(66)),r(n(67)),r(n(68))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,9007199254740992,0x8000000000000],i=function(){function e(e,t,n){this.row=e,this.column=t,this.level=n}return e.fromRowColumnLevel=function(t,n,r){return new e(t,n,r)},e.fromQuadKey=function(t){for(var n=t.length,r=0,i=0,o=0;o<t.length;++o){var a=1<<o,s=parseInt(t.charAt(n-o-1),10);1&s&&(i|=a),2&s&&(r|=a)}return e.fromRowColumnLevel(r,i,n)},e.fromMortonCode=function(t){for(var n=0,r=0,i=0,o=t;o>1;){var a=1<<n;1&o&&(i|=a),2&o&&(r|=a),n++,o=(o-(3&o))/4}var s=e.fromRowColumnLevel(r,i,n);return s.m_mortonCode=t,s},e.fromHereTile=function(t){var n=e.fromMortonCode(parseInt(t,10));return n.m_hereTile=t,n},e.columnsAtLevel=function(e){return Math.pow(2,e)},e.rowsAtLevel=function(e){return Math.pow(2,e)},e.atCoords=function(t,n,r,i,o){return e.fromRowColumnLevel(Math.floor(r/(o/e.rowsAtLevel(t))),Math.floor(n/(i/e.columnsAtLevel(t))),t)},e.parentMortonCode=function(e){return Math.floor(e/4)},e.prototype.parent=function(){if(0===this.level)throw new Error("Cannot get the parent of the root tile key");return e.fromRowColumnLevel(this.row>>>1,this.column>>>1,this.level-1)},e.prototype.changedLevelBy=function(t){var n=Math.max(0,this.level+t),r=this.row,i=this.column;return t>=0?(r<<=t,i<<=t):(r>>>=-t,i>>>=-t),e.fromRowColumnLevel(r,i,n)},e.prototype.changedLevelTo=function(e){return this.changedLevelBy(e-this.level)},e.prototype.mortonCode=function(){if(void 0===this.m_mortonCode){for(var e=this.column,t=this.row,n=r[this.level<<1],i=0;i<this.level;++i)1&e&&(n+=r[2*i]),1&t&&(n+=r[2*i+1]),e>>>=1,t>>>=1;this.m_mortonCode=n}return this.m_mortonCode},e.prototype.toHereTile=function(){return void 0===this.m_hereTile&&(this.m_hereTile=this.mortonCode().toString()),this.m_hereTile},e.prototype.toQuadKey=function(){for(var e="",t=this.level;t>0;--t){var n=1<<t-1,r=0!=(this.column&n),i=0!=(this.row&n);e+=r&&i?"3":i?"2":r?"1":"0"}return e},e.prototype.equals=function(e){return this.row===e.row&&this.column===e.column&&this.level===e.level},e.prototype.addedSubKey=function(t){var n=e.fromQuadKey(0===t.length?"-":t),r=this.changedLevelBy(n.level);return e.fromRowColumnLevel(r.row+n.row,r.column+n.column,r.level)},e.prototype.addedSubHereTile=function(t){var n=e.fromHereTile(t),r=this.changedLevelBy(n.level);return e.fromRowColumnLevel(r.row+n.row,r.column+n.column,r.level)},e.prototype.getSubHereTile=function(e){var t=1<<2*e;return(this.mortonCode()&t-1|t).toString()},e.prototype.rowCount=function(){return e.rowsAtLevel(this.level)},e.prototype.columnCount=function(){return e.columnsAtLevel(this.level)},e}();t.TileKey=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(21),o=n(22),a=function(){function e(e,t){this.subdivisionScheme=e,this.projection=t,this.boundingBoxGenerator=new r.FlatTileBoundingBoxGenerator(this),this.tileTreeTraverse=new o.TileTreeTraverse(e)}return e.prototype.getSubTileKeys=function(e){return this.tileTreeTraverse.subTiles(e)},e.prototype.getTileKey=function(e,t){return i.TileKeyUtils.geoCoordinatesToTileKey(this,e,t)},e.prototype.getTileKeys=function(e,t){return i.TileKeyUtils.geoRectangleToTileKeys(this,e,t)},e.prototype.getGeoBox=function(e){return this.boundingBoxGenerator.getGeoBox(e)},e.prototype.getWorldBox=function(e,t){return this.boundingBoxGenerator.getWorldBox(e,t)},e}();t.TilingScheme=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.EQUATORIAL_CIRCUMFERENCE=40075016.68557849,e}();t.EarthConstants=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(1),o=n(4),a=n(8),s=function(){function e(){}return e.clamp=function(e,t,n){return Math.min(Math.max(t,e),n)},e.latitudeClamp=function(t){return e.clamp(t,-e.MAXIMUM_LATITUDE,e.MAXIMUM_LATITUDE)},e.latitudeProject=function(e){return Math.log(Math.tan(.25*Math.PI+.5*e))/Math.PI},e.latitudeClampProject=function(t){return e.latitudeProject(e.latitudeClamp(t))},e.unprojectLatitude=function(e){return 2*Math.atan(Math.exp(Math.PI*e))-.5*Math.PI},e.prototype.getScaleFactor=function(e){return Math.cosh(2*Math.PI*(e.y/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE-.5))},e.prototype.worldExtent=function(e,t,n){return n||(n=o.MathUtils.newEmptyBox3()),n.min.x=0,n.min.y=0,n.min.z=e,n.max.x=a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,n.max.y=a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,n.max.z=t,n},e.prototype.projectPoint=function(t,n){var r;return r=t instanceof i.GeoCoordinates?t.normalized():new i.GeoCoordinates(t.latitude,t.longitude,t.altitude).normalized(),n||(n={x:0,y:0,z:0}),n.x=(r.longitude+180)/360*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,n.y=(.5*e.latitudeClampProject(r.latitudeInRadians)+.5)*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,n.z=t.altitude||0,n},e.prototype.unprojectPoint=function(t){return i.GeoCoordinates.fromRadians(e.unprojectLatitude(2*(t.y/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE-.5)),t.x/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE*2*Math.PI-Math.PI,t.z)},e.prototype.projectBox=function(t,n){var r=t.center,s=this.projectPoint(new i.GeoCoordinates(r.latitude,r.longitude,0)),u=(.5*e.latitudeClampProject(t.northEast.latitudeInRadians)+.5)*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,l=(.5*e.latitudeClampProject(t.southWest.latitudeInRadians)+.5)*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,c=.5*(u+l);s.y=c;var f=u-l,d=t.longitudeSpan/360*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE;n||(n=o.MathUtils.newEmptyBox3()),n.min.x=s.x-.5*d,n.min.y=s.y-.5*f,n.max.x=s.x+.5*d,n.max.y=s.y+.5*f;var p=t.altitudeSpan;return void 0!==p?(n.min.z=s.z-.5*p,n.max.z=s.z+.5*p):(n.min.z=0,n.max.z=0),n},e.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),n=this.unprojectPoint(e.max);return r.GeoBox.fromCoordinates(t,n)},e.MAXIMUM_LATITUDE=1.4844222297453322,e}();t.MercatorProjection=s,t.mercatorProjection=new s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getSubdivisionX=function(){return 2},e.prototype.getSubdivisionY=function(){return 2},e.prototype.getLevelDimensionX=function(e){return 1<<e},e.prototype.getLevelDimensionY=function(e){return 1<<e},e}();t.quadTreeSubdivisionScheme=new r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(2),a=n(0),s=n(57);function u(e,t){return e*t.far}!function(e){e.DEFAULT_FADE_NEAR=-1,e.DEFAULT_FADE_FAR=-1,e.patchGlobalShaderChunks=function(){void 0===a.ShaderChunk.fading_pars_vertex&&Object.assign(a.ShaderChunk,s.default)},e.updateDistanceFadeFeature=function(e){e.needsUpdate=!0,void 0===e.defines&&(e.defines={}),void 0!==e.fadeFar&&e.fadeFar>0&&(e.defines.FADING_MATERIAL="")},e.insertShaderInclude=function(e,t,n,r){var i=!0===r?"\t":"";return e.replace("#include <"+t+">","\n#include <"+t+">\n// << Patched fading shader START >>\n"+i+"#include <"+n+">\n// << Patched fading shader END >>\n")},e.onBeforeCompile=function(t,n){if(!(void 0===t.fadeFar||t.fadeFar<=0)){var r=n.uniforms;r.fadeNear={value:t.fadeNear},r.fadeFar={value:t.fadeFar},n.vertexShader=e.insertShaderInclude(n.vertexShader,"fog_pars_vertex","fading_pars_vertex"),n.vertexShader=e.insertShaderInclude(n.vertexShader,"fog_vertex","fading_vertex",!0),n.fragmentShader=e.insertShaderInclude(n.fragmentShader,"fog_pars_fragment","fading_pars_fragment"),n.fragmentShader=e.insertShaderInclude(n.fragmentShader,"fog_fragment","fading_fragment",!0)}},e.addRenderHelper=function(t,n,r,i,o,a){t.onBeforeRender=function(t,s,l,c,f){i&&(f.transparent=!0);var d=f;if(d.fadeNear=void 0===n?e.DEFAULT_FADE_NEAR:u(n,l),d.fadeFar=void 0===r?e.DEFAULT_FADE_FAR:u(r,l),o){var p=t.properties.get(f);void 0!==p.shader&&(p.shader.uniforms.fadeNear.value=d.fadeNear,p.shader.uniforms.fadeFar.value=d.fadeFar,d.uniformsNeedUpdate=!0)}void 0!==a&&a(t,f)},i&&(t.onAfterRender=function(e,t,n,r,i){i.transparent=!1})}}(i=t.FadingFeature||(t.FadingFeature={}));var l=function(){function e(){this.m_fadeNear=i.DEFAULT_FADE_NEAR,this.m_fadeFar=i.DEFAULT_FADE_FAR}return e.prototype.getFadeNear=function(){return this.m_fadeNear},e.prototype.setFadeNear=function(e){this.needsUpdate=this.needsUpdate||e!==this.m_fadeNear,this.m_fadeNear=e,this.needsUpdate&&i.updateDistanceFadeFeature(this)},e.prototype.getFadeFar=function(){return this.m_fadeFar},e.prototype.setFadeFar=function(e){this.needsUpdate=this.needsUpdate||e!==this.m_fadeFar,this.m_fadeFar=e,this.needsUpdate&&i.updateDistanceFadeFeature(this)},e.prototype.addFadingProperties=function(){var e=this;Object.defineProperty(this,"fadeNear",{get:function(){return e.getFadeNear()},set:function(t){e.setFadeNear(t)}}),Object.defineProperty(this,"fadeFar",{get:function(){return e.getFadeFar()},set:function(t){e.setFadeFar(t)}})},e.prototype.applyFadingParameters=function(e){var t=this;void 0!==e&&(void 0!==e.fadeNear&&this.setFadeNear(e.fadeNear),void 0!==e.fadeFar&&this.setFadeFar(e.fadeFar)),this.onBeforeCompile=function(e){i.onBeforeCompile(t,e)}},e.prototype.copyFadingParameters=function(e){return this.setFadeNear(void 0===e.fadeNear?i.DEFAULT_FADE_NEAR:e.fadeNear),this.setFadeFar(void 0===e.fadeFar?i.DEFAULT_FADE_FAR:e.fadeFar),this},e}();t.FadingFeatureMixin=l;var c=function(e){function t(t){var n=e.call(this,t)||this;return i.patchGlobalShaderChunks(),n.addFadingProperties(),n.applyFadingParameters(t),n}return r(t,e),t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.copyFadingParameters(t),this},Object.defineProperty(t.prototype,"fadeNear",{get:function(){return i.DEFAULT_FADE_NEAR},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeFar",{get:function(){return i.DEFAULT_FADE_FAR},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.addFadingProperties=function(){},t.prototype.applyFadingParameters=function(e){},t.prototype.copyFadingParameters=function(e){},t}(a.MeshBasicMaterial);t.MapMeshBasicMaterial=c;var f=function(e){function t(t){var n=e.call(this,t)||this;return i.patchGlobalShaderChunks(),n.addFadingProperties(),n.applyFadingParameters(t),n}return r(t,e),t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.copyFadingParameters(t),this},Object.defineProperty(t.prototype,"fadeNear",{get:function(){return i.DEFAULT_FADE_NEAR},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeFar",{get:function(){return i.DEFAULT_FADE_FAR},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.addFadingProperties=function(){},t.prototype.applyFadingParameters=function(e){},t.prototype.copyFadingParameters=function(e){},t}(a.MeshStandardMaterial);t.MapMeshStandardMaterial=f,o.applyMixinsWithoutProperties(c,[l]),o.applyMixinsWithoutProperties(f,[l])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Log=2]="Log",e[e.Info=3]="Info",e[e.Warn=4]="Warn",e[e.Error=5]="Error"}(t.LogLevel||(t.LogLevel={}));var r=function(){return function(){}}();t.LoggerOptions=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={project_line_vert_func:"\nvoid projectVertex(vec2 segment, vec2 t0, vec2 t1, float lineWidth, inout vec2 pos, inout vec2 uv) {\n        float uu = uv.x / 2.0 + 0.5;\n        float ss = mix(segment.x, segment.y, uu);\n\n        if (t0 != t1) {\n            float angle = atan(t0.x * t1.y - t0.y * t1.x, t0.x * t1.x + t0.y * t1.y);\n            vec2 t = normalize(t0 + t1);\n            vec2 n = vec2(t.y, -t.x);\n            pos += uv.y * lineWidth * n / cos(angle / 2.0);\n            uv.x = ss + uv.x * lineWidth * uv.y * tan(angle / 2.0);\n        }\n        else {\n            vec2 n = vec2(t0.y, -t0.x);\n            pos += uv.y * lineWidth * n + uv.x * lineWidth * mix(t0, t1, uu);\n            uv.x = ss + uv.x * lineWidth;\n        }\n}\n",join_dist_func:"\nfloat joinDist(vec2 segment, vec2 texcoord) {\n    float d = abs(texcoord.y);\n    float dx = texcoord.x;\n    if (dx < segment.x) {\n        d = max(d, length(texcoord - vec2(segment.x, 0.0)));\n    } else if (dx > segment.y) {\n        d = max(d, length(texcoord - vec2(segment.y, 0.0)));\n    }\n    return d;\n}\n",tile_clip_func:"\nvoid tileClip(vec2 tilePos, vec2 tileSize) {\n    if (tileSize.x > 0.0 && (tilePos.x < -tileSize.x / 2.0 || tilePos.x > tileSize.x / 2.0))\n        discard;\n    if (tileSize.y > 0.0 && (tilePos.y < -tileSize.y / 2.0 || tilePos.y > tileSize.y / 2.0))\n        discard;\n}\n",high_precision_vert2D_func:"\nvec2 subtractDblEyePos( const in vec2 pos ) {\n    vec2 t1 = positionLow - u_eyepos_lowpart.xy;\n    vec2 e = t1 - positionLow.xy;\n    vec2 t2 = ((-u_eyepos_lowpart.xy - e) + (positionLow.xy - (t1 - e))) + pos - u_eyepos.xy;\n    vec2 high_delta = t1 + t2;\n    vec2 low_delta = t2 - (high_delta - t1);\n    return (high_delta + low_delta);\n}\n",high_precision_vert3D_func:"\nvec3 subtractDblEyePos( const in vec3 pos ) {\n    vec3 t1 = positionLow - u_eyepos_lowpart;\n    vec3 e = t1 - positionLow;\n    vec3 t2 = ((-u_eyepos_lowpart - e) + (positionLow - (t1 - e))) + pos - u_eyepos;\n    vec3 high_delta = t1 + t2;\n    vec3 low_delta = t2 - (high_delta - t1);\n    return (high_delta + low_delta);\n}\n"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(2).LoggerManager.instance.create("WorkerService",{enabled:!1}),o=function(){function e(e){var t=this;this.serviceId=e,this.m_pendingRequests=new Map,this.onMessage=function(e){if("string"==typeof e.data.service&&e.data.service===t.serviceId)try{if(r.isRequestMessage(e.data)){var n=e.data,o={service:n.service,messageId:n.messageId,responseSent:!1};t.m_pendingRequests.set(n.messageId,o),t.tryHandleRequest(n.request).then(function(e){t.doSendResponse(o,{service:t.serviceId,type:r.DecodedTileMessageName.Response,messageId:n.messageId,response:e.response},e.transferList)}).catch(function(e){t.doSendResponse(o,{service:t.serviceId,type:r.DecodedTileMessageName.Response,messageId:n.messageId,error:e.toString()})})}else t.tryHandleMessage(e.data)}catch(n){i.error("["+t.serviceId+"]: Unhandled exception when handling "+e.type)}},self.addEventListener("message",this.onMessage);var n={service:e,type:r.DecodedTileMessageName.Initialized};self.postMessage(n)}return e.prototype.destroy=function(){this.cancelAllPendingRequests(),self.removeEventListener("message",this.onMessage)},e.prototype.handleMessage=function(e){i.error("["+this.serviceId+"]: Invalid message "+e.type)},e.prototype.handleRequest=function(e){throw new Error("ServiceAdapter["+this.serviceId+"]: Invalid request '"+e.type+"'")},e.prototype.tryHandleMessage=function(e){try{this.handleMessage(e)}catch(t){i.error("["+this.serviceId+"]: Failed, handling message "+e.type)}},e.prototype.tryHandleRequest=function(e){try{return this.handleRequest(e)}catch(e){return i.error("["+this.serviceId+"]: Failure",e),Promise.reject(e)}},e.prototype.doSendResponse=function(e,t,n){e.responseSent||(self.postMessage(t,n),e.responseSent=!0,this.m_pendingRequests.delete(e.messageId))},e.prototype.cancelAllPendingRequests=function(){var e=this;this.m_pendingRequests.forEach(function(t){e.doSendResponse(t,{service:e.serviceId,type:r.DecodedTileMessageName.Response,messageId:t.messageId,error:"cancelled"})})},e}();t.WorkerService=o},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(3)),r(n(36)),r(n(1)),r(n(8)),r(n(16)),r(n(37)),r(n(9)),r(n(17)),r(n(18)),r(n(19)),r(n(10)),r(n(38)),r(n(20)),r(n(6)),r(n(21)),r(n(22)),r(n(7)),r(n(39)),r(n(40)),r(n(41)),r(n(42)),r(n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(1),o=n(4),a=Math.PI/180,s=function(){function e(){}return e.prototype.getScaleFactor=function(e){return 1},e.prototype.worldExtent=function(e,t,n){return n||(n=o.MathUtils.newEmptyBox3()),n.min.x=0,n.min.y=0,n.min.z=e,n.max.x=1,n.max.y=.5,n.max.z=t,n},e.prototype.projectPoint=function(t,n){return void 0===n&&(n={x:0,y:0,z:0}),n.x=(t.longitude*a+Math.PI)*e.geoToWorldScale,n.y=(t.latitude*a+.5*Math.PI)*e.geoToWorldScale,n.z=t.altitude||0,n},e.prototype.unprojectPoint=function(t){return i.GeoCoordinates.fromRadians(t.y*e.worldToGeoScale-.5*Math.PI,t.x*e.worldToGeoScale-Math.PI,t.z)},e.prototype.projectBox=function(t,n){var r=this.projectPoint(new i.GeoCoordinates(t.center.latitude,t.center.longitude,0)),a=t.latitudeSpanInRadians,s=t.longitudeSpanInRadians,u=t.altitudeSpan,l=s*e.geoToWorldScale,c=a*e.geoToWorldScale;return n||(n=o.MathUtils.newEmptyBox3()),n.min.x=r.x-.5*l,n.min.y=r.y-.5*c,n.max.x=r.x+.5*l,n.max.y=r.y+.5*c,void 0!==u?(n.min.z=r.z-.5*u,n.max.z=r.z+.5*u):(n.min.z=0,n.max.z=0),n},e.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),n=this.unprojectPoint(e.max);return r.GeoBox.fromCoordinates(t,n)},e.geoToWorldScale=1/(2*Math.PI),e.worldToGeoScale=2*Math.PI/1,e}();t.equirectangularProjection=new s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),o=n(1),a=n(8),s=n(9),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.projectPoint=function(e,t){var n;n=e instanceof o.GeoCoordinates?e.normalized():new o.GeoCoordinates(e.latitude,e.longitude,e.altitude).normalized(),t||(t={x:0,y:0,z:0}),t.x=(n.longitude+180)/360*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE;var r=Math.sin(s.MercatorProjection.latitudeClamp(n.latitudeInRadians));return t.y=(.5-Math.log((1+r)/(1-r))/(4*Math.PI))*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,t.z=e.altitude||0,t},t.prototype.unprojectPoint=function(e){var t=s.MercatorProjection.clamp(e.x,0,a.EarthConstants.EQUATORIAL_CIRCUMFERENCE)/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE-.5,n=.5-s.MercatorProjection.clamp(e.y,0,a.EarthConstants.EQUATORIAL_CIRCUMFERENCE)/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,r=360*t,i=90-360*Math.atan(Math.exp(2*-n*Math.PI))/Math.PI;return new o.GeoCoordinates(i,r,e.z)},t.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),n=this.unprojectPoint(e.max);return new i.GeoBox(new o.GeoCoordinates(n.latitude,t.longitude,t.altitude),new o.GeoCoordinates(t.latitude,n.longitude,n.altitude))},t.MAXIMUM_LATITUDE=1.4844222297453322,t}(s.MercatorProjection);t.webMercatorProjection=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.tilingScheme=e,this.minElevation=t,this.maxElevation=n,this.m_tilingScheme=e,this.m_worldBox=e.projection.worldExtent(t,n);var r=this.m_worldBox,i=r.min,o=r.max;this.m_worldDimensions={x:o.x-i.x,y:o.y-i.y,z:o.z-i.z}}return Object.defineProperty(e.prototype,"projection",{get:function(){return this.m_tilingScheme.projection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subdivisionScheme",{get:function(){return this.m_tilingScheme.subdivisionScheme},enumerable:!0,configurable:!0}),e.prototype.getWorldBox=function(e,t){var n=e.level,i=this.subdivisionScheme.getLevelDimensionX(n),o=this.subdivisionScheme.getLevelDimensionY(n),a=this.m_worldDimensions.x/i,s=this.m_worldDimensions.y/o,u=this.m_worldBox.min.x+a*e.column,l=this.m_worldBox.min.y+s*e.row;return t||(t=r.MathUtils.newEmptyBox3()),t.min.x=u,t.min.y=l,t.min.z=this.m_worldBox.min.z,t.max.x=u+a,t.max.y=l+s,t.max.z=this.m_worldBox.max.z,t},e.prototype.getGeoBox=function(e){var t=this.getWorldBox(e);return this.projection.unprojectBox(t)},e}();t.FlatTileBoundingBoxGenerator=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getSubdivisionX=function(){return 2},e.prototype.getSubdivisionY=function(e){return 0===e?1:2},e.prototype.getLevelDimensionX=function(e){return 1<<e},e.prototype.getLevelDimensionY=function(e){return 0!==e?1<<e-1:1},e}();t.halfQuadTreeSubdivisionScheme=new r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=function(){function e(e,t,n){this.m_tileKey=e,this.m_level=t,this.m_count=1<<(t<<1),this.m_mask=n,this.m_shift=t>2?t-2<<1:0}return Object.defineProperty(e.prototype,"length",{get:function(){return this.m_count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this.m_level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileKey",{get:function(){return this.m_tileKey},enumerable:!0,configurable:!0}),e.prototype.iterator=function(){return new e.Iterator(this)},e.prototype.skip=function(e){if(-1!==this.m_mask)for(;e<this.m_count&&0==(this.m_mask&1<<(e>>this.m_shift));)++e;return e},e}();t.SubTiles=i,function(e){var t=function(){function e(e,t){void 0===t&&(t=0),this.m_parent=e,this.m_index=e.skip(t)}return Object.defineProperty(e.prototype,"value",{get:function(){var e=this.m_parent.tileKey,t=this.m_parent.level;return r.TileKey.fromRowColumnLevel(e.row<<t|this.m_index>>t,e.column<<t|this.m_index&(1<<t)-1,e.level+t)},enumerable:!0,configurable:!0}),e.prototype.next=function(){this.m_index=this.m_parent.skip(++this.m_index)},e}();e.Iterator=t}(i=t.SubTiles||(t.SubTiles={})),t.SubTiles=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(6),o=function(){function e(){}return e.geoCoordinatesToTileKey=function(e,t,n){var r=e.projection,o=e.subdivisionScheme,a=r.projectPoint(t),s=o.getLevelDimensionX(n),u=o.getLevelDimensionY(n),l=r.worldExtent(0,0),c=l.min,f=l.max,d=f.x-c.x,p=f.y-c.y;if(a.x<c.x||a.x>f.x)return null;if(a.y<c.y||a.y>f.y)return null;var h=Math.min(s-1,Math.floor(s*(a.x-c.x)/d)),v=Math.min(u-1,Math.floor(u*(a.y-c.y)/p));return i.TileKey.fromRowColumnLevel(v,h,n)},e.geoRectangleToTileKeys=function(t,n,o){var a=function(e,t,n){return e<t?n-(t-e)%(n-t):t+(e-t)%(n-t)},s=function(e,t,n){return Math.min(Math.max(e,t),n)},u=a(n.southWest.longitudeInRadians,-Math.PI,Math.PI),l=s(n.southWest.latitudeInRadians,-.5*Math.PI,.5*Math.PI),c=a(n.northEast.longitudeInRadians,-Math.PI,Math.PI),f=s(n.northEast.latitudeInRadians,-.5*Math.PI,.5*Math.PI),d=e.geoCoordinatesToTileKey(t,r.GeoCoordinates.fromRadians(l,u),o),p=e.geoCoordinatesToTileKey(t,r.GeoCoordinates.fromRadians(f,c),o),h=t.subdivisionScheme.getLevelDimensionX(o);if(!d||!p)throw new Error("Invalid coordinates");var v=d.column,y=p.column;u>c&&(y+=y!==v?h:h-1);for(var g=Math.min(d.row,p.row),m=Math.max(d.row,p.row),_=new Array,x=g;x<=m;++x)for(var E=v;E<=y;++E)_.push(i.TileKey.fromRowColumnLevel(x,E%h,o));return _},e}();t.TileKeyUtils=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),i=function(){function e(e){this.m_subdivisionScheme=e}return e.prototype.subTiles=function(e){for(var t=~(-1<<this.m_subdivisionScheme.getSubdivisionX(e.level)*this.m_subdivisionScheme.getSubdivisionY(e.level)),n=new r.SubTiles(e,1,t),i=n.iterator(),o=new Array,a=0;a<n.length;++a)o.push(i.value),i.next();return o},e}();t.TileTreeTraverse=i},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(24)),r(n(43)),r(n(58)),r(n(11)),r(n(59)),r(n(60)),r(n(61)),r(n(62)),r(n(25)),r(n(63)),r(n(64)),r(n(65))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"\n    uniform float opacity;\n    uniform sampler2D tDiffuse;\n    varying vec2 vUv;\n    void main() {\n        vec4 texel = texture2D( tDiffuse, vUv );\n        gl_FragColor = opacity * texel;\n    }"}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(11),a=n(13),s="\nattribute vec2 position;\nattribute vec4 tangents;\nattribute vec2 segment;\nattribute vec2 angles;\nattribute vec2 texcoord;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float lineWidth;\n\nvarying vec2 vPosition;\nvarying vec2 vTexcoord;\nvarying vec2 vSegment;\nvarying float vLinewidth;\n\n#ifdef USE_COLOR\nattribute vec4 color;\nvarying vec3 vColor;\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\n#include <fog_pars_vertex>\n#include <project_line_vert_func>\n\nvoid main() {\n    vLinewidth = lineWidth;\n    vSegment = segment;\n\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec2 pos = position;\n    vec2 uvs = texcoord;\n    projectVertex(segment, normalize(tangents.xy), normalize(tangents.zw), lineWidth, pos, uvs);\n\n    vPosition = pos;\n    vTexcoord = vec2(uvs.x, uvs.y * lineWidth);\n    vec4 mvPosition = modelViewMatrix * vec4(pos, 0.0, 1.0);\n    gl_Position = projectionMatrix * mvPosition;\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n\n    #include <fog_vertex>\n}",u="\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform vec2 tileSize;\n#if DASHED_LINE\nuniform float dashSize;\nuniform float gapSize;\n#endif\n\nvarying vec2 vPosition;\nvarying vec2 vTexcoord;\nvarying vec2 vSegment;\nvarying float vLinewidth;\n#ifdef USE_COLOR\nvarying vec3 color;\n#endif\n\n#include <join_dist_func>\n#include <tile_clip_func>\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\n#include <fog_pars_fragment>\n\nvoid main() {\n\n    float alpha = opacity;\n\n    #if TILE_CLIP\n    tileClip(vPosition, tileSize);\n    #endif\n\n    #if DASHED_LINE\n    float halfSegment = (dashSize + gapSize) / dashSize * 0.5;\n    float segmentDist = mod(vTexcoord.x, dashSize + gapSize) / dashSize;\n    float dist = 0.5 - distance(segmentDist, halfSegment);\n    float width = fwidth(dist);\n    alpha *= smoothstep(-width, width, dist);\n    #else\n    float dist = joinDist(vSegment, vTexcoord) - vLinewidth;\n    float width = fwidth(dist);\n    alpha *= (1.0 - smoothstep(-width, width, dist));\n    #endif\n\n    #ifdef USE_COLOR\n    gl_FragColor = vec4( diffuse * vColor, alpha );\n    #else\n    gl_FragColor = vec4( diffuse, alpha );\n    #endif\n    #include <fog_fragment>\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n}",l=function(e){function t(n){var r=this;Object.assign(i.ShaderChunk,a.default),o.FadingFeature.patchGlobalShaderChunks();var l={DASHED_LINE:0,TILE_CLIP:0},c=void 0!==n&&!0===n.fog;c&&(l.USE_FOG="");var f={name:"SolidLineMaterial",vertexShader:s,fragmentShader:u,uniforms:i.UniformsUtils.merge([{diffuse:new i.Uniform(new i.Color(t.DEFAULT_COLOR)),lineWidth:new i.Uniform(t.DEFAULT_WIDTH),opacity:new i.Uniform(t.DEFAULT_OPACITY),tileSize:new i.Uniform(new i.Vector2),fadeNear:new i.Uniform(o.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new i.Uniform(o.FadingFeature.DEFAULT_FADE_FAR)},i.UniformsLib.fog]),defines:l,transparent:!0,fog:!0};return(r=e.call(this,f)||this).extensions.derivatives=!0,void 0!==n&&(void 0!==n.color&&r.color.set(n.color),void 0!==n.lineWidth&&(r.lineWidth=n.lineWidth),void 0!==n.opacity&&(r.opacity=n.opacity),void 0!==n.depthTest&&(r.depthTest=n.depthTest),void 0!==n.fadeNear&&(r.fadeNear=n.fadeNear),void 0!==n.fadeFar&&(r.fadeFar=n.fadeFar),r.fog=c),r}return r(t,e),t.prototype.updateFog=function(e){e?this.defines.USE_FOG="":delete this.defines.USE_FOG},Object.defineProperty(t.prototype,"color",{get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this.uniforms.lineWidth.value},set:function(e){this.uniforms.lineWidth.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeNear",{get:function(){return this.uniforms.fadeNear.value},set:function(e){this.uniforms.fadeNear.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeFar",{get:function(){return this.uniforms.fadeFar.value},set:function(e){var t=this.uniforms.fadeFar.value;this.uniforms.fadeFar.value=e,void 0!==t&&t>0?this.defines.USE_FADING="":delete this.defines.USE_FADING},enumerable:!0,configurable:!0}),t.DEFAULT_COLOR=16711680,t.DEFAULT_WIDTH=1,t.DEFAULT_OPACITY=1,t}(i.RawShaderMaterial);t.SolidLineMaterial=l},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,i([e],t))},e.prototype.debug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.debug.apply(console,i([e],t))},e.prototype.info=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.info.apply(console,i([e],t))},e.prototype.log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log.apply(console,i([e],t))},e.prototype.trace=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.trace.apply(console,i([e],t))},e.prototype.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.warn.apply(console,i([e],t))},e}();t.ConsoleChannel=o},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),a=function(){function e(e,t,n){this.name=e,this.m_channel=t,this.enabled=!0,this.level=o.LogLevel.Trace,void 0!==n&&this.update(n)}return e.prototype.error=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.enabled&&this.level<=o.LogLevel.Error&&(t=this.m_channel).error.apply(t,i([this.prefix,e],n))},e.prototype.debug=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.enabled&&this.level<=o.LogLevel.Debug&&(t=this.m_channel).debug.apply(t,i([this.prefix,e],n))},e.prototype.info=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.enabled&&this.level<=o.LogLevel.Info&&(t=this.m_channel).info.apply(t,i([this.prefix,e],n))},e.prototype.log=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.enabled&&this.level<=o.LogLevel.Log&&(t=this.m_channel).log.apply(t,i([this.prefix,e],n))},e.prototype.trace=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.enabled&&this.level<=o.LogLevel.Trace&&(t=this.m_channel).trace.apply(t,i([this.prefix,e],n))},e.prototype.warn=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.enabled&&this.level<=o.LogLevel.Warn&&(t=this.m_channel).warn.apply(t,i([this.prefix,e],n))},e.prototype.update=function(e){this.enabled=void 0===e.enabled?this.enabled:e.enabled,this.level=void 0===e.level?this.level:e.level},Object.defineProperty(e.prototype,"prefix",{get:function(){return this.name+":"},enumerable:!0,configurable:!0}),e}();t.Logger=a},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(12);t.WORKERCHANNEL_MSG_TYPE="worker-channel-message";var a=function(){function e(){}return e.prototype.error=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var a={message:i([e],n),type:t.WORKERCHANNEL_MSG_TYPE,level:o.LogLevel.Error};self.postMessage(a)},e.prototype.debug=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var a={message:i([e],n),type:t.WORKERCHANNEL_MSG_TYPE,level:o.LogLevel.Debug};self.postMessage(a)},e.prototype.info=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var a={message:i([e],n),type:t.WORKERCHANNEL_MSG_TYPE,level:o.LogLevel.Info};self.postMessage(a)},e.prototype.log=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var a={message:i([e],n),type:t.WORKERCHANNEL_MSG_TYPE,level:o.LogLevel.Log};self.postMessage(a)},e.prototype.trace=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var a={message:i([e],n),type:t.WORKERCHANNEL_MSG_TYPE,level:o.LogLevel.Trace};self.postMessage(a)},e.prototype.warn=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var a={message:i([e],n),type:t.WORKERCHANNEL_MSG_TYPE,level:o.LogLevel.Warn};self.postMessage(a)},e}();t.WorkerChannel=a},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),o=n(0);function a(e){return e instanceof Array&&e.length>0&&void 0!==e[0].value}function s(e,t){var n,i;if(!(e instanceof Array))return e;try{for(var o=r(e),a=o.next();!a.done;a=o.next()){var s=a.value;if(!(void 0!==s.minLevel&&t<s.minLevel)&&!(void 0!==s.maxLevel&&t>s.maxLevel))return s.value}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}!function(e){e.ShowInStack="show-in-stack",e.HideInStack="hide-in-stack",e.ShowParent="show-parent"}(t.PoiStackMode||(t.PoiStackMode={})),t.isCirclesTechnique=function(e){return"circles"===e.name},t.isSquaresTechnique=function(e){return"squares"===e.name},t.isPoiTechnique=function(e){return"labeled-icon"===e.name},t.isLineMarkerTechnique=function(e){return"line-marker"===e.name},t.isLineTechnique=function(e){return"line"===e.name},t.isSolidLineTechnique=function(e){return"solid-line"===e.name},t.isSegmentsTechnique=function(e){return"segments"===e.name},t.isExtrudedLineTechnique=function(e){return"extruded-line"===e.name},t.isFillTechnique=function(e){return"fill"===e.name},t.isExtrudedPolygonTechnique=function(e){return"extruded-polygon"===e.name},t.isStandardTechnique=function(e){return"standard"===e.name},t.isStandardTexturedTechnique=function(e){return"standard-textured"===e.name},t.isLandmarkTechnique=function(e){return"landmark"===e.name},t.isTextTechnique=function(e){return"text"===e.name},t.isShaderTechnique=function(e){return"shader"===e.name},t.getMaterialConstructor=function(e){switch(e.name){case"extruded-line":return"standard"===e.shading?i.MapMeshStandardMaterial:i.MapMeshBasicMaterial;case"standard":case"standard-textured":case"landmark":case"extruded-polygon":return i.MapMeshStandardMaterial;case"solid-line":return i.SolidLineMaterial;case"dashed-line":return i.DashedLineMaterial;case"fill":return i.MapMeshBasicMaterial;case"squares":return o.PointsMaterial;case"circles":return i.CirclePointsMaterial;case"line":case"segments":return o.LineBasicMaterial;case"shader":return o.ShaderMaterial;case"text":case"labeled-icon":case"line-marker":return}},t.getObjectConstructor=function(e){switch(e.name){case"extruded-line":case"standard":case"standard-textured":case"landmark":case"extruded-polygon":case"fill":case"solid-line":case"dashed-line":return o.Mesh;case"circles":case"squares":return o.Points;case"line":case"segments":return o.LineSegments;case"shader":switch(e.primitive){case"line":return o.Line;case"segments":return o.LineSegments;case"point":return o.Points;case"mesh":return o.Mesh;default:return}case"text":case"labeled-icon":case"line-marker":return}},t.BASE_TECHNIQUE_NON_MATERIAL_PROPS=["name","id","renderOrder","renderOrderBiasProperty","renderOrderBiasGroup","renderOrderBiasRange","transient"],t.getPropertyValue=s,t.isTextureBuffer=function(e){return e&&e.buffer&&"string"==typeof e.format},t.getAttributeValue=function(e,t){return a(e)?s(e,t):e},t.toWrappingMode=function(e){if("clamp"===e)return o.ClampToEdgeWrapping;if("repeat"===e)return o.RepeatWrapping;if("mirror"===e)return o.MirroredRepeatWrapping;throw new Error("invalid wrapping: "+e)},t.applyTechniqueToMaterial=function(e,n,r,i){Object.getOwnPropertyNames(e).forEach(function(u){if(!(u.startsWith("_")||-1!==t.BASE_TECHNIQUE_NON_MATERIAL_PROPS.indexOf(u)||void 0!==i&&-1!==i.indexOf(u))){var l=u,c=n,f=e[l];void 0!==c[l]&&(void 0!==r&&a(f)&&(f=s(f,r)),c[l]instanceof o.Color?c[l].set(f):c[l]=f)}})}},function(e,t,n){"use strict";n.r(t);const r=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function i(e){return e>>1^-(1&e)}function o(e,t,n,r,i=!0){let o;if(o=2===r?new Uint16Array(e,t,n):new Uint32Array(e,t,n),!i)return o;let a=0;for(let e=0;e<o.length;++e){let t=o[e];o[e]=a-t,0===t&&++a}return o}function a(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function s(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const u={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},l={maxDecodingStep:u.extensions};function c(e,t){const n=Object.assign({},l,t),c=new DataView(e),{header:f,headerEndPosition:d}=function(e){let t=0;const n={};for(let[i,o]of r){const r=8===o?e.getFloat64:e.getFloat32;n[i]=r.call(e,t,!0),t+=o}return{header:n,headerEndPosition:t}}(c);if(n.maxDecodingStep<u.vertices)return{header:f};const{vertexData:p,vertexDataEndPosition:h}=function(e,t){let n=t;const r=e.getUint32(n,!0),o=new Uint16Array(3*r);n+=Uint32Array.BYTES_PER_ELEMENT;const a=Uint16Array.BYTES_PER_ELEMENT,s=r*a,u=n,l=u+s,c=l+s;let f=0,d=0,p=0;for(let t=0;t<r;t++)f+=i(e.getUint16(u+a*t,!0)),d+=i(e.getUint16(l+a*t,!0)),p+=i(e.getUint16(c+a*t,!0)),o[t]=f,o[t+r]=d,o[t+2*r]=p;return{vertexData:o,vertexDataEndPosition:n+=3*s}}(c,d);if(n.maxDecodingStep<u.triangleIndices)return{header:f,vertexData:p};const{triangleIndices:v,triangleIndicesEndPosition:y}=function(e,t,n){let r=n;const i=t.length/3>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;r%i!=0&&(r+=i-r%i);const a=e.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const s=3*a,u=o(e.buffer,r,s,i);return{triangleIndicesEndPosition:r+=s*i,triangleIndices:u}}(c,p,h);if(n.maxDecodingStep<u.edgeIndices)return{header:f,vertexData:p,triangleIndices:v};const{westIndices:g,southIndices:m,eastIndices:_,northIndices:x,edgeIndicesEndPosition:E}=function(e,t,n){let r=n;const i=t.length/3>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,a=e.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const s=o(e.buffer,r,a,i,!1);r+=a*i;const u=e.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const l=o(e.buffer,r,u,i,!1);r+=u*i;const c=e.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const f=o(e.buffer,r,c,i,!1);r+=c*i;const d=e.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const p=o(e.buffer,r,d,i,!1);return{edgeIndicesEndPosition:r+=d*i,westIndices:s,southIndices:l,eastIndices:f,northIndices:p}}(c,p,y);if(n.maxDecodingStep<u.extensions)return{header:f,vertexData:p,triangleIndices:v,westIndices:g,northIndices:x,eastIndices:_,southIndices:m};const{extensions:b}=function(e,t){const n={};if(e.byteLength<=t)return{extensions:n,extensionsEndPosition:t};let r=t;for(;r<e.byteLength;){const t=e.getUint8(r,!0);r+=Uint8Array.BYTES_PER_ELEMENT;const i=e.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const o=new DataView(e.buffer,r,i);switch(t){case 1:n.vertexNormals=a(o);break;case 2:n.waterMask=s(o);break;default:console.warn(`Unknown extension with id ${t}`)}r+=i}return{extensions:n,extensionsEndPosition:r}}(c,E);return{header:f,vertexData:p,triangleIndices:v,westIndices:g,northIndices:x,eastIndices:_,southIndices:m,extensions:b}}n.d(t,"QUANTIZED_MESH_TILE_DECODER_ID",function(){return f}),n.d(t,"QuantizedMeshTileDecoder",function(){return d});const f="quantized-mesh-tile-decoder";class d{connect(){return Promise.resolve()}constructPositionArray(e){const t=e.length/3,n=new Float32Array(e.length);for(let r=0;r<t;r++)n[3*r]=e[r]/32767,n[3*r+1]=e[r+t]/32767,n[3*r+2]=e[r+2*t]/32767;return n}constructUvArray(e){return e.filter((e,t)=>t%3<2)}decodeTile(e){const t=c(e),n=this.constructPositionArray(t.vertexData),r=this.constructUvArray(n),i=[];i.push({name:"position",type:"float",buffer:n,itemCount:3,metadata:t.header},{name:"uv",type:"float",buffer:r,itemCount:2}),Object.keys(t.extensions).forEach(e=>{if("vertexNormals"===e&&t.extensions[e].byteLength>0){let n=new Uint8Array(t.extensions[e]);i.push({name:"octNormal",type:"float",buffer:n,itemCount:2})}});const o={techniques:[],geometries:[{index:{name:"index",type:"uint16",buffer:t.triangleIndices,itemCount:1},vertexAttributes:i}]};return Promise.resolve(o)}}},function(e,t,n){importScripts("three/build/three.js"),n(32)},function(e,t,n){const{WorkerServiceManager:r,TileDecoderService:i}=n(33),{QUANTIZED_MESH_TILE_DECODER_ID:o}=n(30),{QuantizedMeshTileDecoder:a}=n(30);r.getInstance().register({serviceType:o,factory:e=>i.start(e,new a)})},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(34)),r(n(69)),r(n(14)),r(n(70))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=function(){function e(){}return e.prototype.dispose=function(){},e.prototype.decodeTile=function(e,t,n){return void 0===this.m_styleSetEvaluator?Promise.reject(new Error("No style is defined")):this.decodeThemedTile(e,t,this.m_styleSetEvaluator,n)},e.prototype.getTileInfo=function(e,t,n){return Promise.resolve(void 0)},e.prototype.configure=function(e,t,n){void 0!==e&&(this.m_styleSetEvaluator=new r.StyleSetEvaluator(e)),void 0!==t&&(this.languages=t)},e}();t.ThemedTileDecoder=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(15),o=n(23),a=n(29);t.getArrayConstructor=function(e){switch(e){case"float":return Float32Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array}},function(e){e[e.Unspecified=0]="Unspecified",e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.SolidLine=3]="SolidLine",e[e.Text=4]="Text",e[e.TextPath=5]="TextPath",e[e.ExtrudedLine=6]="ExtrudedLine",e[e.Polygon=7]="Polygon",e[e.ExtrudedPolygon=8]="ExtrudedPolygon",e[e.Object3D=9]="Object3D",e[e.Other=1e3]="Other"}(t.GeometryType||(t.GeometryType={})),t.createMaterial=function(e){var t=a.getMaterialConstructor(e.technique),n={};if(void 0!==t){t.prototype instanceof r.RawShaderMaterial&&t!==o.HighPrecisionLineMaterial&&(n.fog=e.fog);var i=new t(n);if(void 0!==e.technique.id&&(i.name=e.technique.id),"extruded-polygon"===e.technique.name&&(i.flatShading=!0),i.depthTest="extruded-polygon"===e.technique.name&&!1!==e.technique.depthTest,"shader"===e.technique.name){var s=e.technique.params;Object.getOwnPropertyNames(s).forEach(function(e){var t=e;if("name"!==t){var n=i;n[t]instanceof r.Color?n[t].set(s[t]):n[t]=s[t]}})}else a.applyTechniqueToMaterial(e.technique,i,e.level,e.skipExtraProps);return i}},t.getProjection=function(e){switch(e){case"mercator":return i.mercatorProjection;case"webMercator":return i.webMercatorProjection;default:throw new Error("Unknown projection "+e)}},t.getProjectionName=function(e){if(e===i.mercatorProjection)return"mercator";if(e===i.webMercatorProjection)return"webMercator";throw new Error("Unknown projection")},t.getBufferAttribute=function(e){switch(e.type){case"float":return new r.BufferAttribute(new Float32Array(e.buffer),e.itemCount);case"uint16":return new r.BufferAttribute(new Uint16Array(e.buffer),e.itemCount);case"uint32":return new r.BufferAttribute(new Uint32Array(e.buffer),e.itemCount);default:throw new Error("unsupported buffer of type "+e.type)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoCoordinatesLike=function(e){return e&&"number"==typeof e.latitude&&"number"==typeof e.longitude&&("number"==typeof e.altitude||void 0===e.altitude)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(1),o=n(4),a=Math.PI/180,s=function(){function e(){}return e.prototype.getScaleFactor=function(e){return 1},e.prototype.worldExtent=function(e,t,n){return n||(n=o.MathUtils.newEmptyBox3()),n.min.x=-Math.PI,n.min.y=.5*-Math.PI,n.min.z=e,n.max.x=Math.PI,n.max.y=.5*Math.PI,n.max.z=t,n},e.prototype.projectPoint=function(e,t){return t||(t={x:0,y:0,z:0}),t.x=e.longitude*a,t.y=e.latitude*a,t.z=e.altitude||0,t},e.prototype.unprojectPoint=function(e){return i.GeoCoordinates.fromRadians(e.y,e.x,e.z)},e.prototype.projectBox=function(e,t){return t||(t=o.MathUtils.newEmptyBox3()),this.projectPoint(new i.GeoCoordinates(e.south,e.west,e.minAltitude),t.min),this.projectPoint(new i.GeoCoordinates(e.north,e.east,e.maxAltitude),t.max),t},e.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),n=this.unprojectPoint(e.max);return r.GeoBox.fromCoordinates(t,n)},e}();t.identityProjection=new s},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=function(){function e(e){this.tilingScheme=e}return e.prototype.visit=function(e){this.visitTileKey(i.TileKey.fromRowColumnLevel(0,0,0),e)},e.prototype.visitTileKey=function(e,t){var n,i;if(t(e,this.tilingScheme.getGeoBox(e)))try{for(var o=r(this.tilingScheme.getSubTileKeys(e)),a=o.next();!a.done;a=o.next()){var s=a.value;this.visitTileKey(s,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e}();t.QuadTree=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(19),o=n(7);t.hereTilingScheme=new o.TilingScheme(i.halfQuadTreeSubdivisionScheme,r.equirectangularProjection)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),i=n(10),o=n(7);t.webMercatorTilingScheme=new o.TilingScheme(i.quadTreeSubdivisionScheme,r.webMercatorProjection)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(10),o=n(7);t.mercatorTilingScheme=new o.TilingScheme(i.quadTreeSubdivisionScheme,r.mercatorProjection)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVector3Like=function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){function t(n){var r=this,o={};return void 0!==n&&void 0!==n.color&&(o.color=n.color),void 0!==n&&void 0!==n.lineWidth&&(o.lineWidth=n.lineWidth),void 0!==n&&void 0!==n.opacity&&(o.opacity=n.opacity),void 0!==n&&void 0!==n.fog&&(o.fog=n.fog),(r=e.call(this,o)||this).name="DashedLineMaterial",Object.assign(r.uniforms,{dashSize:new i.Uniform(t.DEFAULT_DASH_SIZE),gapSize:new i.Uniform(t.DEFAULT_GAP_SIZE)}),void 0!==n&&(void 0!==n.dashSize&&(r.dashSize=n.dashSize),void 0!==n.gapSize&&(r.gapSize=n.gapSize),void 0!==n.fog&&(r.fog=null!==n.fog)),r}return r(t,e),Object.defineProperty(t.prototype,"dashSize",{get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gapSize",{get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e,this.updateDashedFeature()},enumerable:!0,configurable:!0}),t.prototype.updateDashedFeature=function(){this.defines.DASHED_LINE=this.gapSize>0?1:0},t.DEFAULT_DASH_SIZE=1,t.DEFAULT_GAP_SIZE=1,t}(n(25).SolidLineMaterial);t.DashedLineMaterial=o},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){void 0===t&&(t=new Array),this.priority=e,this.elements=t}}();t.PriorityListGroup=i;var o=function(){function e(){this.groups=new Map}return e.prototype.add=function(e){this.getGroup(e.priority).elements.push(e)},e.prototype.remove=function(e){var t=this.getGroup(e.priority);if(void 0!==t){var n=t.elements.indexOf(e);if(n>=0){if(t.elements.splice(n,1),0===t.elements.length){var r=Math.floor(e.priority);this.groups.delete(r)}return!0}}return!1},e.prototype.clear=function(){this.groups.clear()},e.prototype.merge=function(e){var t,n;try{for(var i=r(e.groups),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.findGroup(a[1].priority);void 0!==s?s.elements=s.elements.concat(a[1].elements):this.groups.set(Math.floor(a[1].priority),a[1])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return this},Object.defineProperty(e.prototype,"sortedGroups",{get:function(){var e,t,n=[];try{for(var i=r(this.groups),o=i.next();!o.done;o=i.next()){var a=o.value;n.push(a[1])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n.sort(function(e,t){return t.priority-e.priority}),n},enumerable:!0,configurable:!0}),e.prototype.findGroup=function(e){var t=Math.floor(e);return this.groups.get(t)},e.prototype.getGroup=function(e){var t=this.findGroup(e);if(void 0===t){var n=Math.floor(e);t=new i(n),this.groups.set(n,t)}return t},e}();t.GroupedPriorityList=o},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(26)),r(n(12)),r(n(27)),r(n(46)),r(n(48)),r(n(28))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(47),i=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new r.LoggerManagerImpl)},enumerable:!0,configurable:!0}),e}();t.LoggerManager=i},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(26),o=n(27),a=n(28),s=function(){function e(){this.m_loggers=[],this.channel="undefined"==typeof self||void 0!==self.document?new i.ConsoleChannel:new a.WorkerChannel}return e.prototype.getLoggerNames=function(){return this.m_loggers.map(function(e){return e.name})},e.prototype.getLogger=function(e){return this.m_loggers.find(function(t){return t.name===e})},e.prototype.create=function(e,t){var n=new o.Logger(e,this.channel,t);return this.m_loggers.push(n),n},e.prototype.dispose=function(e){var t=this.m_loggers.indexOf(e);if(t<0)throw new Error('Cannot unregister "'+e+'" : no such logger registered.');this.m_loggers.splice(t,1)},e.prototype.updateAll=function(e){var t,n;try{for(var i=r(this.m_loggers),o=i.next();!o.done;o=i.next()){o.value.update(e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.update=function(e,t){var n,i;try{for(var o=r(this.m_loggers),a=o.next();!a.done;a=o.next()){var s=a.value;s.name===e&&s.update(t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.enableAll=function(e){var t,n;try{for(var i=r(this.m_loggers),o=i.next();!o.done;o=i.next()){o.value.enabled=e}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.enable=function(e,t){this.update(e,{enabled:t})},e.prototype.setLogLevelForAll=function(e){var t,n;try{for(var i=r(this.m_loggers),o=i.next();!o.done;o=i.next()){o.value.level=e}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.setLogLevel=function(e,t){this.update(e,{level:t})},e.prototype.setChannel=function(e){this.channel=e},e}();t.LoggerManagerImpl=s},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.channels=[],this.channels=e}return e.prototype.error=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];try{for(var s=r(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.error.apply(l,o([e],i))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e.prototype.debug=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];try{for(var s=r(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.debug.apply(l,o([e],i))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e.prototype.info=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];try{for(var s=r(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.info.apply(l,o([e],i))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e.prototype.log=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];try{for(var s=r(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.log.apply(l,o([e],i))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e.prototype.trace=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];try{for(var s=r(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.trace.apply(l,o([e],i))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e.prototype.warn=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];try{for(var s=r(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.warn.apply(l,o([e],i))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e}();t.MultiChannel=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=e,this.y=t,this.w=n,this.h=r}return e.prototype.set=function(e,t,n,r){this.x=e,this.y=t,this.w=n,this.h=r},e.prototype.contains=function(e,t){return this.x<=e&&this.x+this.w>=e&&this.y<=t&&this.y+this.h>=t},e.prototype.intersects=function(e){return this.x<=e.x+e.w&&this.x+this.w>=e.x&&this.y<=e.y+e.h&&this.y+this.h>=e.y},e}();function n(e,t,n,r){return(e-n)*(e-n)+(t-r)*(t-r)}e.Box=t,e.distSquared=n,e.computeSquaredLineLength=function(e){for(var t=0,n=e.length-3,r=0;r<n;r+=2){var i=e[r+2]-e[r],o=e[r+3]-e[r+1];t+=i*i+o*o}return t},e.distToSegmentSquared=function(e,t,r,i,o,a){var s=n(r,i,o,a);if(0===s)return n(e,t,r,i);var u=((e-r)*(o-r)+(t-i)*(a-i))/s;return n(e,t,r+(u=Math.max(0,Math.min(1,u)))*(o-r),i+u*(a-i))}}(t.Math2D||(t.Math2D={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function t(e,t,n){return e<t?t:e>n?n:e}e.clamp=t,e.smoothStep=function(e,n,r){return(r=t((r-e)/(n-e),0,1))*r*(3-2*r)},e.smootherStep=function(e,n,r){return(r=t((r-e)/(n-e),0,1))*r*r*(r*(6*r-15)+10)},e.lerp=function(e,t,n,r,i){return(e-t)*(i-r)/(n-t)+r},e.min2=function(e,t){var n;return void 0!==e&&(n=e),void 0!==t&&(n=void 0===n?t:Math.min(n,t)),n},e.max2=function(e,t){var n;return void 0!==e&&(n=e),void 0!==t&&(n=void 0===n?t:Math.max(n,t)),n},e.isClamped=function(e,t,n){return void 0!==t&&e<t||void 0!==n&&e>n}}(t.MathUtils||(t.MathUtils={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyMixins=function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(n){e.prototype[n]=t.prototype[n]})})},t.applyMixinsWithoutProperties=function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t.prototype,n);void 0!==r&&void 0===r.get&&(e.prototype[n]=t.prototype[n])})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!0;t.assert=function(e,t){if(!r&&!e)throw new Error(void 0!==t?t:"ASSERTION failed")},t.assertExists=function(e,t){if(!r&&(void 0===e||null===e))throw new Error(void 0!==t?t:"ASSERTION failed: Element is undefined or null");return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.now=function(){return e.nowFunc()},e.getNowFunc=function(){return"undefined"!=typeof performance&&void 0!==performance.now?function(){return performance.now()}:function(){return(new Date).getTime()}},e.instance=new e,e.nowFunc=e.getNowFunc(),e}();t.PerformanceTimer=r},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getOptionValue=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var o=i(n),a=o.next();!a.done;a=o.next()){var s=a.value;if(void 0!==s&&null!==s)return s}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},t.mergeWithOptions=function(e,t){var n=r({},e);if(void 0===t||null===t)return n;for(var i in e)if(e.hasOwnProperty(i)){var o=t[i];void 0!==o&&null!==o&&(n[i]=o)}return n}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultUrlResolver=function(e){return void 0!==r?r(e):e},t.setDefaultUrlResolver=function(e){r=e},t.composeUrlResolvers=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduce(function(e,t){return void 0!==t?t(e):e},t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveReferenceUrl=function(e,t){return r.test(t)?t:t.startsWith("/")?o(e)+t:(t.startsWith("./")&&(t=t.substr(2)),i(e)+t)};var r=new RegExp("^(?:[a-z]+:)?//","i");function i(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substring(0,t+1)}function o(e){var t=a(e);return"file:"===t.protocol?"file://":t.host&&t.protocol?t.protocol+"//"+t.host:t.host?"//"+t.host:t.protocol?t.protocol+"//":""}function a(e){var t=new RegExp(/^(?:([a-z]+:))?\/\/([^\/]*)/,"i"),n=e.match(t);if(!n)throw new Error("getUrlHostAndProtocol: unable to parse URL '"+e+"'");return{protocol:n[1],host:n[2]}}t.baseUrl=i,t.getUrlOrigin=o,t.getUrlHostAndProtocol=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={fading_pars_vertex:"\nvarying float fadingDepth;\n",fading_vertex:"\nfadingDepth = -mvPosition.z;\n",fading_pars_fragment:"\nvarying float fadingDepth;\nuniform float fadeNear;\nuniform float fadeFar;\n",fading_fragment:'\n\n// lerp with "hard" edges\n//float fadingFactor = 1.0 - clamp((fadingDepth - fadeNear) / (fadeFar - fadeNear), 0.0, 1.0);\n\n// smooth transitions\nfloat fadingFactor = smoothstep( fadeNear, fadeFar, fadingDepth );\n\ngl_FragColor.a *= 1.0 - fadingFactor;\n\n// debugging color:\n// gl_FragColor = vec4(1., fadingFactor, fadingFactor, 1.0);\n'}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(11),a="\nattribute vec3 position;\nattribute vec4 color;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform vec3 edgeColor;\nuniform float edgeColorMix;\n\nvarying vec3 vColor;\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\nvoid main() {\n    #if USE_COLOR\n    vColor = mix(edgeColor.rgb, color.rgb, edgeColorMix);\n    #else\n    vColor = edgeColor.rgb;\n    #endif\n\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n}",s="\nprecision highp float;\nprecision highp int;\n\nvarying vec3 vColor;\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\nvoid main() {\n    float alphaValue = 1.0;\n    gl_FragColor = vec4(vColor, alphaValue);\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n}",u=function(e){function t(n){var r=this,u={name:"EdgeMaterial",vertexShader:a,fragmentShader:s,uniforms:{edgeColor:new i.Uniform(new i.Color(t.DEFAULT_COLOR)),edgeColorMix:new i.Uniform(t.DEFAULT_COLOR_MIX),fadeNear:new i.Uniform(o.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new i.Uniform(o.FadingFeature.DEFAULT_FADE_FAR)},depthWrite:!1};return r=e.call(this,u)||this,o.FadingFeature.patchGlobalShaderChunks(),void 0!==n&&(void 0!==n.color&&r.color.set(n.color),void 0!==n.colorMix&&(r.colorMix=n.colorMix),void 0!==n.fadeNear&&(r.fadeNear=n.fadeNear),void 0!==n.fadeFar&&(r.fadeFar=n.fadeFar)),r}return r(t,e),Object.defineProperty(t.prototype,"color",{get:function(){return this.uniforms.edgeColor.value},set:function(e){this.uniforms.edgeColor.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorMix",{get:function(){return this.uniforms.edgeColorMix.value},set:function(e){this.uniforms.edgeColorMix.value=e,this.updateColorMixFeature()},enumerable:!0,configurable:!0}),t.prototype.updateColorMixFeature=function(){this.defines.USE_COLOR=this.colorMix>0?1:0},Object.defineProperty(t.prototype,"fadeNear",{get:function(){return this.uniforms.fadeNear.value},set:function(e){this.uniforms.fadeNear.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeFar",{get:function(){return this.uniforms.fadeFar.value},set:function(e){this.uniforms.fadeFar.value=e,void 0!==e&&e>0?(this.needsUpdate=this.needsUpdate||void 0===this.defines.USE_FADING,this.defines.USE_FADING=""):(this.needsUpdate=this.needsUpdate||void 0!==this.defines.USE_FADING,delete this.defines.USE_FADING)},enumerable:!0,configurable:!0}),t.DEFAULT_COLOR=0,t.DEFAULT_COLOR_MIX=0,t}(i.RawShaderMaterial);t.EdgeMaterial=u},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o="\nattribute vec4 position;\nattribute vec3 uv;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvarying vec3 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n}",a="\nprecision highp float;\nprecision highp int;\n\nuniform float pageOffset;\nuniform sampler2D page0;\nuniform sampler2D page1;\nuniform sampler2D page2;\nuniform sampler2D page3;\nuniform sampler2D page4;\nuniform sampler2D page5;\nuniform sampler2D page6;\nuniform sampler2D page7;\n\nvarying vec3 vUv;\n\nvoid main() {\n    float sample = 0.0;\n    if (vUv.z < pageOffset || vUv.z > (pageOffset + 7.0)) discard;\n    else if (vUv.z < pageOffset + 1.0) sample = texture2D(page0, vUv.xy).a;\n    else if (vUv.z < pageOffset + 2.0) sample = texture2D(page1, vUv.xy).a;\n    else if (vUv.z < pageOffset + 3.0) sample = texture2D(page2, vUv.xy).a;\n    else if (vUv.z < pageOffset + 4.0) sample = texture2D(page3, vUv.xy).a;\n    else if (vUv.z < pageOffset + 5.0) sample = texture2D(page4, vUv.xy).a;\n    else if (vUv.z < pageOffset + 6.0) sample = texture2D(page5, vUv.xy).a;\n    else if (vUv.z < pageOffset + 7.0) sample = texture2D(page6, vUv.xy).a;\n    else sample = texture2D(page7, vUv.xy).a;\n\n    gl_FragColor = vec4(sample, sample, sample, 1.0);\n}",s=function(e){function t(){var t={name:"GlyphCopyMaterial",vertexShader:o,fragmentShader:a,uniforms:{pageOffset:new i.Uniform(0),page0:new i.Uniform(i.Texture.DEFAULT_IMAGE),page1:new i.Uniform(i.Texture.DEFAULT_IMAGE),page2:new i.Uniform(i.Texture.DEFAULT_IMAGE),page3:new i.Uniform(i.Texture.DEFAULT_IMAGE),page4:new i.Uniform(i.Texture.DEFAULT_IMAGE),page5:new i.Uniform(i.Texture.DEFAULT_IMAGE),page6:new i.Uniform(i.Texture.DEFAULT_IMAGE),page7:new i.Uniform(i.Texture.DEFAULT_IMAGE)},depthTest:!1,depthWrite:!1};return e.call(this,t)||this}return r(t,e),t}(i.RawShaderMaterial);t.GlyphCopyMaterial=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(13),a="\n#ifdef USE_COLOR\nattribute vec4 color;\nvarying vec3 vColor;\n#endif\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 position;        // high part\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert3D_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n}",s="\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifdef USE_COLOR\nvarying vec3 color;\n#endif\n\nvoid main() {\n    #ifdef USE_COLOR\n    gl_FragColor = vec4( diffuse * vColor, opacity );\n    #else\n    gl_FragColor = vec4( diffuse, opacity );\n    #endif\n}",u=function(e){function t(n){var r=this;Object.assign(i.ShaderChunk,o.default);var u={name:"HighPrecisionLineMaterial",vertexShader:a,fragmentShader:s,uniforms:{diffuse:new i.Uniform(new i.Color(t.DEFAULT_COLOR)),opacity:new i.Uniform(t.DEFAULT_OPACITY),u_mvp:new i.Uniform(new i.Matrix4),u_eyepos:new i.Uniform(new i.Vector3),u_eyepos_lowpart:new i.Uniform(new i.Vector3)}};return Object.assign(u,n),(r=e.call(this,u)||this).type="HighPrecisionLineMaterial",r.isHighPrecisionLineMaterial=!0,r.dimensionality=3,void 0!==n&&(void 0!==n.color&&r.color.set(n.color),void 0!==n.opacity&&(r.opacity=n.opacity)),r.updateTransparencyFeature(),r}return r(t,e),Object.defineProperty(t.prototype,"color",{get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e},enumerable:!0,configurable:!0}),t.prototype.setDimensionality=function(e){e!==this.dimensionality&&(this.dimensionality=e,this.vertexShader=2===this.dimensionality?"\n#ifdef USE_COLOR\nattribute vec4 color;\nvarying vec3 vColor;\n#endif\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec2 position;        // high part\nattribute vec2 positionLow;     // low part\n\n#include <high_precision_vert2D_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec2 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 0.0, 1.0);\n}":a)},t.prototype.updateTransparencyFeature=function(){this.transparent=this.opacity<1},t.DEFAULT_COLOR=80,t.DEFAULT_OPACITY=1,t}(i.RawShaderMaterial);t.HighPrecisionLineMaterial=u},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(13),a="\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n\nuniform float size;\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert3D_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n\n    // ignore sizeAttenuation for now!\n    gl_PointSize = size;\n}",s=function(e){function t(n){var r=this;Object.assign(i.ShaderChunk,o.default);var s=n;return(r=e.call(this,s)||this).type="HighPrecisionPointMaterial",r.vertexShader=a,r.fragmentShader=i.ShaderChunk.points_frag,r.fog=!1,r.uniforms={diffuse:new i.Uniform(new i.Color(t.DEFAULT_COLOR)),opacity:new i.Uniform(t.DEFAULT_OPACITY),size:new i.Uniform(t.DEFAULT_SIZE),scale:new i.Uniform(t.DEFAULT_SCALE),map:new i.Uniform(new i.Texture),uvTransform:new i.Uniform(new i.Matrix3),u_mvp:new i.Uniform(new i.Matrix4),u_eyepos:new i.Uniform(new i.Vector3),u_eyepos_lowpart:new i.Uniform(new i.Vector3)},r.isHighPrecisionPointMaterial=!0,r.dimensionality=3,void 0!==n&&(void 0!==n.color&&r.color.set(n.color),void 0!==n.opacity&&(r.opacity=n.opacity),void 0!==n.size&&(r.size=n.size),void 0!==n.scale&&(r.scale=n.scale),void 0!==n.uvTransform&&(r.uvTransform=n.uvTransform),void 0!==n.map&&(r.map=n.map)),r}return r(t,e),Object.defineProperty(t.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(e){this.uniforms.scale.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uvTransform",{get:function(){return this.uniforms.uvTransform.value},set:function(e){this.uniforms.uvTransform.value=e},enumerable:!0,configurable:!0}),t.prototype.setDimensionality=function(e){e!==this.dimensionality&&(this.dimensionality=e,this.vertexShader=2===this.dimensionality?"\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n\nuniform float size;\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec2 position;        // high part\nattribute vec2 positionLow;     // low part\n\n#include <high_precision_vert2D_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec2 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 0.0, 1.0);\n\n    // ignore sizeAttenuation for now!\n    gl_PointSize = size;\n}":a)},t.DEFAULT_COLOR=80,t.DEFAULT_OPACITY=1,t.DEFAULT_SIZE=1,t.DEFAULT_SCALE=1,t}(i.PointsMaterial);t.HighPrecisionPointMaterial=s,t.isHighPrecisionPointMaterial=function(e){return void 0!==e&&!0===e.isHighPrecisionPointMaterial}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o="\nattribute vec4 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    vColor = color;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n}",a="\nprecision highp float;\nprecision highp int;\n\nuniform sampler2D map;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 color = texture2D(map, vUv.xy);\n    color *= vColor.a;\n    if (color.a < 0.05) {\n        discard;\n    }\n    gl_FragColor = color;\n}",s=function(e){function t(t){var n={name:"IconMaterial",vertexShader:o,fragmentShader:a,uniforms:{map:new i.Uniform(t.map)},depthTest:!0,depthWrite:!0,transparent:!0,vertexColors:i.VertexColors,premultipliedAlpha:!0,blending:i.NormalBlending};return e.call(this,n)||this}return r(t,e),Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.map.value},enumerable:!0,configurable:!0}),t}(i.RawShaderMaterial);t.IconMaterial=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o="\nuniform float size;\n\nvoid main() {\n    vec3 transformed = vec3(position);\n    vec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n    gl_Position = projectionMatrix * mvPosition;\n    gl_PointSize = size;\n}\n",a="\nuniform vec3 diffuse;\n\nvoid main() {\n    float alpha = 1.0;\n\n    float radius = 0.5;\n    vec2 coords = gl_PointCoord.xy - vec2(0.5);\n    float len = length(coords);\n    float falloff = fwidth(len);\n    float threshold = 1.0 - smoothstep(radius - falloff, radius, len);\n    alpha *= threshold;\n\n    gl_FragColor = vec4(diffuse, alpha);\n}",s=1,u=function(e){function t(t){void 0===t&&(t={});var n=this;return t.depthTest=!1,(n=e.call(this,t)||this).isCirclePointsMaterial=!0,n.type="CirclePointsMaterial",n.vertexShader=o,n.fragmentShader=a,n.m_size=t.size||s,n.m_color=new i.Color,n.uniforms={diffuse:new i.Uniform(n.m_color),size:new i.Uniform(n.m_size)},n.extensions.derivatives=!0,n}return r(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return this.m_size},set:function(e){this.m_size=e,this.uniforms.size.value=e,this.needsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return"#"+this.m_color.getHexString()},set:function(e){this.m_color.set(e),this.uniforms.diffuse.value.set(this.m_color),this.needsUpdate=!0},enumerable:!0,configurable:!0}),t}(i.ShaderMaterial);t.CirclePointsMaterial=u},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(24),a=function(e){function t(t){return e.call(this,{uniforms:t,vertexShader:o.CopyShader.vertexShader,fragmentShader:o.CopyShader.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:i.AdditiveBlending,depthTest:!1,depthWrite:!1})||this}return r(t,e),t}(i.ShaderMaterial);t.MSAAMaterial=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o="\nattribute vec4 position;\nattribute vec4 color;\nattribute vec4 uv;\nattribute vec2 glyphAxis;\nattribute vec2 dummy_for_alignment;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvarying vec4 vColor;\nvarying vec4 vUv;\nvarying float vWeight;\nvarying float vBG;\n\nvoid main() {\n    vColor = color;\n    vUv = vec4(uv.xy, glyphAxis.xy);\n    vWeight = uv.z;\n    vBG = uv.w;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n}",a='\nprecision highp float;\nprecision highp int;\n\n// Make sure this parameter matches the "distanceRange" used when generating these fonts (found in:\n// @here/harp-map-theme/scripts/create-font-catalog.js).\n#define SDF_DISTANCE_RANGE 8.0\n\nuniform sampler2D texture;\nuniform float textureSize;\n\n#if BG_TEXT\nuniform vec3 bgColor;\nuniform float bgFactor;\nuniform float bgAlpha;\n#endif\n\nvarying vec4 vColor;\nvarying vec4 vUv;\nvarying float vWeight;\nvarying float vBG;\n\nvoid main() {\n\n    vec4 color = vec4(vColor);\n    vec3 sample = texture2D(texture, vUv.xy).rgb;\n\n    float h = sqrt(vUv.z * vUv.z + vUv.w * vUv.w);\n    float textScale = max(abs(vUv.z / h), 0.000001);\n    float dx = abs(dFdx( vUv.x ) * textureSize);\n    float dy = abs(dFdy( vUv.y ) * textureSize);\n    // Special case for glyphs perfectly aligned with the screen Y axis.\n    if (dx == 0.0 && dy == 0.0) {\n        textScale = 1.0;\n        dx = abs(dFdy( vUv.x ) * textureSize);\n        dy = abs(dFdx( vUv.y ) * textureSize);\n    }\n    float toPixels = SDF_DISTANCE_RANGE * inversesqrt( dx * dx + dy * dy ) * textScale;\n\n    float distScale = vWeight;\n    float alphaScale = 1.0;\n    #if BG_TEXT\n    // TODO: Make this less hard-coded with proper outlines specified in pixel width.\n    distScale = (1.0 + (bgFactor * (vWeight - 1.0 ))) * bgFactor;\n    alphaScale = bgAlpha;\n    color.rgb = bgColor;\n\n    float dist = sample.r * distScale - 0.5;\n    float alpha = 1.0;\n    if (vBG < 1.0) alpha = clamp( dist * toPixels + 0.5, 0.0, alphaScale);\n    else alpha = (dist + 0.5) * alphaScale;\n    #else\n    float dist = sample.r * distScale - 0.5;\n    float alpha = clamp( dist * toPixels + 0.5, 0.0, alphaScale);\n    #endif\n    color.a *= alpha;\n    if (color.a < 0.05) {\n        discard;\n    }\n\n    gl_FragColor = color;\n}',s=function(e){function t(n){var r=this,s={name:"TextMaterial",vertexShader:o,fragmentShader:a,uniforms:{texture:new i.Uniform(n.texture),textureSize:new i.Uniform(n.textureSize),bgFactor:new i.Uniform(t.DEFAULT_BG_FACTOR),bgColor:new i.Uniform(new i.Color(t.DEFAULT_BG_COLOR)),bgAlpha:new i.Uniform(t.DEFAULT_BG_ALPHA)},defines:{BG_TEXT:0},depthTest:!0,depthWrite:!0,side:i.DoubleSide,transparent:!0};return(r=e.call(this,s)||this).extensions.derivatives=!0,void 0!==n&&(void 0!==n.bgColor&&r.bgColor.set(n.bgColor),void 0!==n.bgFactor&&(r.bgFactor=n.bgFactor),void 0!==n.bgAlpha&&(r.bgAlpha=n.bgAlpha)),r}return r(t,e),Object.defineProperty(t.prototype,"bgFactor",{get:function(){return this.uniforms.bgFactor.value},set:function(e){this.uniforms.bgFactor.value=e,this.updateBackgroundFeature()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bgColor",{get:function(){return this.uniforms.bgColor.value},set:function(e){this.uniforms.bgColor.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bgAlpha",{get:function(){return this.uniforms.bgAlpha.value},set:function(e){this.uniforms.bgAlpha.value=e},enumerable:!0,configurable:!0}),t.prototype.updateBackgroundFeature=function(){this.defines.BG_TEXT=this.bgFactor>0?1:0},t.DEFAULT_BG_FACTOR=0,t.DEFAULT_BG_COLOR=14737632,t.DEFAULT_BG_ALPHA=1,t}(i.RawShaderMaterial);t.TextMaterial=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),s=n(0),u=a.LoggerManager.instance.create("Theme"),l=function(){function e(){}return e.prototype.lookup=function(e){},e.prototype.unmap=function(){return{}},e}();t.Env=l;var c=function(e){function t(t,n,r){var i=e.call(this)||this;return i.name=t,i.value=n,i.parent=r,i}return r(t,e),t.prototype.lookup=function(e){return e===this.name?this.value:this.parent?this.parent.lookup(e):void 0},t.prototype.unmap=function(){var e=this.parent?this.parent.unmap():{};return e[this.name]=this.value,e},t}(l);t.Bind=c,t.EmptyEnv={lookup:function(e){},unmap:function(){return{}}};var f=function(e){function t(t,n){var r=e.call(this)||this;return r.entries=t,r.parent=n,r}return r(t,e),t.prototype.lookup=function(e){var t=this.entries[e];return void 0!==t?t:this.parent?this.parent.lookup(e):void 0},t.prototype.unmap=function(){var e=this.parent?this.parent.unmap():{};for(var t in this.entries)this.entries.hasOwnProperty(t)&&(e[t]=this.entries[t]);return e},t}(l);t.MapEnv=f;var d=function(){function e(e){this.kind=e}return e.parse=function(e){return new C(e).parse()},e}();t.Expr=d;var p,h,v=function(e){function t(t){var n=e.call(this,"var")||this;return n.name=t,n}return r(t,e),t.prototype.evaluate=function(e){return e.lookup(this.name)},t}(d),y=function(e){function t(t){var n=e.call(this,"number")||this;return n.value=t,n}return r(t,e),t.prototype.evaluate=function(){return this.value},t}(d),g=function(e){function t(t){var n=e.call(this,"string")||this;return n.value=t,n}return r(t,e),t.prototype.evaluate=function(){return this.value},t}(d),m=function(e){function t(t){var n=e.call(this,"has")||this;return n.attribute=t,n}return r(t,e),t.prototype.evaluate=function(e){return void 0!==e.lookup(this.attribute)},t}(d),_=function(e){function t(t,n){var r=e.call(this,"in")||this;return r.value=t,r.elements=n,r}return r(t,e),t.prototype.evaluate=function(e){var t,n,r=this.value.evaluate(e);try{for(var o=i(this.elements),a=o.next();!a.done;a=o.next()){if(r===a.value.evaluate(e))return!0}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1},t}(d),x=function(e){function t(t){var n=e.call(this,"!")||this;return n.expr=t,n}return r(t,e),t.prototype.evaluate=function(e){return!this.expr.evaluate(e)},t}(d),E=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.op=t,i.left=n,i.right=r,i}return r(t,e),t.prototype.evaluate=function(e){var t=this.left.evaluate(e),n=this.right.evaluate(e);switch(this.op){case"~=":return"string"==typeof t&&"string"==typeof n&&-1!==t.indexOf(n);case"^=":return"string"==typeof t&&"string"==typeof n&&t.startsWith(n);case"$=":return"string"==typeof t&&"string"==typeof n&&t.endsWith(n);case"==":return t===n;case"!=":return t!==n;case"<":return void 0!==t&&void 0!==n?t<n:void 0;case">":return void 0!==t&&void 0!==n?t>n:void 0;case"<=":return void 0!==t&&void 0!==n?t<=n:void 0;case">=":return void 0!==t&&void 0!==n?t>=n:void 0}throw new Error("invalid relational op "+this.op)},t}(d),b=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.op=t,i.left=n,i.right=r,i}return r(t,e),t.prototype.evaluate=function(e){var t=this.left.evaluate(e);switch(this.op){case"||":return t||this.right.evaluate(e);case"&&":return t&&this.right.evaluate(e)}throw new Error("invalid logical op "+this.op)},t}(d);function w(e){switch(e){case p.Tab:case p.Lf:case p.Cr:case p.Space:return!0;default:return!1}}function P(e){return e>=p._0&&e<=p._9}function S(e){return e>=p.a&&e<=p.z||e>=p.A&&e<=p.Z}function M(e){return function(e){return S(e)||P(e)}(e)||e===p._||e===p.Dollar||e===p.Dot||e===p.LBracket||e===p.RBracket}function O(e){switch(e){case h.Eof:return"eof";case h.Error:return"error";case h.Identifier:return"identifier";case h.Number:return"number";case h.String:return"string";case h.Comma:return",";case h.LParen:return"(";case h.RParen:return")";case h.LBracket:return"[";case h.RBracket:return"]";case h.Exclaim:return"!";case h.TildeEqual:return"~=";case h.CaretEqual:return"^=";case h.DollarEqual:return"$=";case h.EqualEqual:return"==";case h.ExclaimEqual:return"!=";case h.Less:return"<";case h.Greater:return">";case h.LessEqual:return"<=";case h.GreaterEqual:return">=";case h.BarBar:return"||";case h.AmpAmp:return"&&";default:throw new Error("invalid token "+e)}}!function(e){e[e.Tab=9]="Tab",e[e.Lf=10]="Lf",e[e.Cr=13]="Cr",e[e.Space=32]="Space",e[e.LParen=40]="LParen",e[e.RParen=41]="RParen",e[e.Comma=44]="Comma",e[e.Dot=46]="Dot",e[e.LBracket=91]="LBracket",e[e.Backslash=92]="Backslash",e[e.RBracket=93]="RBracket",e[e._0=48]="_0",e[e._9=57]="_9",e[e._=95]="_",e[e.A=64]="A",e[e.Z=90]="Z",e[e.a=97]="a",e[e.z=122]="z",e[e.DoubleQuote=34]="DoubleQuote",e[e.SingleQuote=39]="SingleQuote",e[e.Exclaim=33]="Exclaim",e[e.Equal=61]="Equal",e[e.Caret=94]="Caret",e[e.Tilde=126]="Tilde",e[e.Dollar=36]="Dollar",e[e.Less=60]="Less",e[e.Greater=62]="Greater",e[e.Bar=124]="Bar",e[e.Amp=38]="Amp"}(p||(p={})),function(e){e[e.Eof=0]="Eof",e[e.Error=1]="Error",e[e.Identifier=2]="Identifier",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Comma=5]="Comma",e[e.LParen=6]="LParen",e[e.RParen=7]="RParen",e[e.LBracket=8]="LBracket",e[e.RBracket=9]="RBracket",e[e.Exclaim=10]="Exclaim",e[e.TildeEqual=11]="TildeEqual",e[e.CaretEqual=12]="CaretEqual",e[e.DollarEqual=13]="DollarEqual",e[e.EqualEqual=14]="EqualEqual",e[e.ExclaimEqual=15]="ExclaimEqual",e[e.Less=16]="Less",e[e.Greater=17]="Greater",e[e.LessEqual=18]="LessEqual",e[e.GreaterEqual=19]="GreaterEqual",e[e.BarBar=20]="BarBar",e[e.AmpAmp=21]="AmpAmp"}(h||(h={}));var T=function(){function e(e){this.code=e,this.m_token=h.Error,this.m_index=0,this.m_char=p.Lf}return e.prototype.token=function(){return this.m_token},e.prototype.text=function(){return this.m_text||""},e.prototype.next=function(){if(this.m_token=this.yylex(),this.m_token===h.Error)throw new Error("unexpected character "+this.m_char);return this.m_token},e.prototype.yyinp=function(){this.m_char=this.code.codePointAt(this.m_index++)||0},e.prototype.yylex=function(){for(this.m_text=void 0;w(this.m_char);)this.yyinp();if(0===this.m_char)return h.Eof;var e=this.m_char;switch(this.yyinp(),e){case p.LParen:return h.LParen;case p.RParen:return h.RParen;case p.LBracket:return h.LBracket;case p.RBracket:return h.RBracket;case p.Comma:return h.Comma;case p.SingleQuote:case p.DoubleQuote:for(var t=this.m_index-1;this.m_char&&this.m_char!==e;)this.yyinp();if(this.m_char!==e)throw new Error("Unfinished string literal");return this.yyinp(),this.m_text=this.code.substring(t,this.m_index-2),h.String;case p.Exclaim:return this.m_char===p.Equal?(this.yyinp(),h.ExclaimEqual):h.Exclaim;case p.Caret:return this.m_char===p.Equal?(this.yyinp(),h.CaretEqual):h.Error;case p.Tilde:return this.m_char===p.Equal?(this.yyinp(),h.TildeEqual):h.Error;case p.Equal:return this.m_char===p.Equal?(this.yyinp(),h.EqualEqual):h.Error;case p.Less:return this.m_char===p.Equal?(this.yyinp(),h.LessEqual):h.Less;case p.Greater:return this.m_char===p.Equal?(this.yyinp(),h.GreaterEqual):h.Greater;case p.Bar:return this.m_char===p.Bar?(this.yyinp(),h.BarBar):h.Error;case p.Amp:return this.m_char===p.Amp?(this.yyinp(),h.AmpAmp):h.Error;default:t=this.m_index-2;if(S(e)||e===p._||e===p.Dollar&&M(this.m_char)){for(;M(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),h.Identifier}if(P(e)){for(;P(this.m_char);)this.yyinp();if(this.m_char===p.Dot)for(this.yyinp();P(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),h.Number}if(e===p.Dollar)return this.m_char===p.Equal?(this.yyinp(),h.DollarEqual):h.Error}return h.Error},e}();function A(e){switch(e){case h.TildeEqual:return"~=";case h.CaretEqual:return"^=";case h.DollarEqual:return"$=";case h.EqualEqual:return"==";case h.ExclaimEqual:return"!=";default:return}}function I(e){switch(e){case h.Less:return"<";case h.Greater:return">";case h.LessEqual:return"<=";case h.GreaterEqual:return">=";default:return}}var C=function(){function e(e){this.lex=new T(e),this.lex.next()}return e.prototype.parse=function(){return this.parseLogicalOr()},e.prototype.yyexpect=function(e){if(this.lex.token()!==e)throw new Error("Syntax error: Expected token '"+O(e)+"' but found '"+O(this.lex.token())+"'");this.lex.next()},e.prototype.parsePrimary=function(){switch(this.lex.token()){case h.Identifier:var e=this.lex.text();if("has"!==e){var t=new v(e);return this.lex.next(),t}this.lex.next(),this.yyexpect(h.LParen);var n=this.lex.text();return this.yyexpect(h.Identifier),this.yyexpect(h.RParen),new m(n);case h.Number:t=new y(parseFloat(this.lex.text()));return this.lex.next(),t;case h.String:t=new g(this.lex.text());return this.lex.next(),t;case h.LParen:this.lex.next();t=this.parseLogicalOr();return this.yyexpect(h.RParen),t}throw new Error("Syntax error")},e.prototype.parseUnary=function(){return this.lex.token()===h.Exclaim?(this.lex.next(),new x(this.parseUnary())):this.parsePrimary()},e.prototype.parseRelational=function(){for(var e=this.parseUnary();;)if(this.lex.token()===h.Identifier&&"in"===this.lex.text()){this.lex.next(),this.yyexpect(h.LBracket);for(var t=[this.parsePrimary()];this.lex.token()===h.Comma;)this.lex.next(),t.push(this.parsePrimary());this.yyexpect(h.RBracket),e=new _(e,t)}else{var n=I(this.lex.token());if(void 0===n)break;this.lex.next();var r=this.parseUnary();e=new E(n,e,r)}return e},e.prototype.parseEquality=function(){for(var e=this.parseRelational();;){var t=A(this.lex.token());if(void 0===t)break;this.lex.next();var n=this.parseRelational();e=new E(t,e,n)}return e},e.prototype.parseLogicalAnd=function(){for(var e=this.parseEquality();this.lex.token()===h.AmpAmp;){this.lex.next();var t=this.parseEquality();e=new b("&&",e,t)}return e},e.prototype.parseLogicalOr=function(){for(var e=this.parseLogicalAnd();this.lex.token()===h.BarBar;){this.lex.next();var t=this.parseLogicalAnd();e=new b("||",e,t)}return e},e}();t.createLight=function(e){switch(e.type){case"ambient":return(t=new s.AmbientLight(e.color,e.intensity)).name=e.name,t;case"directional":var t;return(t=new s.DirectionalLight(e.color,e.intensity)).name=e.name,void 0!==e.castShadow&&(t.castShadow=e.castShadow),t.position.set(e.direction.x,e.direction.y,e.direction.z),t.position.normalize(),t}};var L=function(){function e(e,t){var n,r,a=this;this.styleSet=e,this.validate=t,this.m_renderOrderBiasGroups=new Map,this.m_techniques=new Array;var s=0,l=function(e){var t,n;if(void 0!==e.renderOrderBiasGroup){var r=e.renderOrderBiasGroup?a.m_renderOrderBiasGroups.get(e.renderOrderBiasGroup):void 0;if(void 0!==e.renderOrderBiasRange&&void 0===r){void 0!==e.renderOrder&&u.warn("WARN: style.renderOrder will be overriden if renderOrderBiasGroup is set:",e);var c=o(e.renderOrderBiasRange,2),f=c[0],d=c[1];e.renderOrder=f<0?s+Math.abs(f):s,s+=Math.abs(f)+d,e.renderOrderBiasGroup&&a.m_renderOrderBiasGroups.set(e.renderOrderBiasGroup,e.renderOrder),s++}else r&&(void 0!==e.renderOrder&&u.warn("WARN: style.renderOrder will be overriden if renderOrderBiasGroup is set:",e),e.renderOrder=r)}if(void 0!==e.styles){a.validate&&(Array.isArray(e.styles)||u.error("ERROR: style.styles must be an Array:",e));try{for(var p=i(e.styles),h=p.next();!h.done;h=p.next()){var v=h.value;l(v)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}}else void 0!==e.technique&&void 0!==e.attr&&void 0===e.attr.renderOrder&&(e.attr._renderOrderAuto=s++)};try{for(var c=i(e),f=c.next();!f.done;f=c.next()){var d=f.value;l(d)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}return e.prototype.getMatchingTechniques=function(e){var t,n,r=[],o=new Array;try{for(var a=i(this.styleSet),s=a.next();!s.done;s=a.next()){var u=s.value;if(this.validate&&0!==o.length)throw new Error("Internal error: sytle stack cleanup failed");if(this.processStyle(e,o,u,r))break}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r},e.prototype.checkAddTechnique=function(e,t){var n=void 0===e._index?-1:e._index;return n<0?(t._index=n=this.m_techniques.length,this.m_techniques.push(t),e._index=n):t._index=n,n},Object.defineProperty(e.prototype,"techniques",{get:function(){return this.m_techniques},enumerable:!0,configurable:!0}),e.prototype.cleanupStyle=function(e,t){return"styles"===e?"[...]":e.startsWith("_")?void 0:t},e.prototype.processStyle=function(e,t,n,r){var o,a,s,l,c=this;if(void 0!==n.when&&(void 0===n._whenExpr&&(n._whenExpr=d.parse(n.when)),!n._whenExpr.evaluate(e)))return!1;if(void 0!==n.styles){if(n.debug&&u.log("\n======== style group =========\nenv:",JSON.stringify(e.unmap(),void 0,2),"\nstyle group:",JSON.stringify(n,this.cleanupStyle,2)),t.push(n),this.validate&&!Array.isArray(n.styles))return u.error("ERROR: style.styles must be an Array:",n),t.pop(),!1;try{for(var f=i(n.styles),p=f.next();!p.done;p=f.next()){var h=p.value;if(this.processStyle(e,t,h,r))return t.pop(),!0}}catch(e){o={error:e}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}t.pop()}else{if(void 0!==n.technique){if(void 0===n._index){var v={};v.name=n.technique;var y=function(e){void 0!==e.renderOrder&&(v.renderOrder=e.renderOrder),void 0!==e.transient&&(v.transient=e.transient),void 0!==e.renderOrderBiasProperty&&(v.renderOrderBiasProperty=e.renderOrderBiasProperty),void 0!==e.labelProperty&&(v.label=e.labelProperty),void 0!==e.renderOrderBiasRange&&(v.renderOrderBiasRange=e.renderOrderBiasRange),void 0!==e.renderOrderBiasGroup&&(v.renderOrderBiasGroup=e.renderOrderBiasGroup),void 0!==e.attr&&Object.getOwnPropertyNames(e.attr).forEach(function(t){c.validate&&("technique"===t?u.warn("WARNING: technique defined in attr (deprecated):",e):"renderOrder"===t&&u.warn("WARNING: renderOrder defined in attr (deprecated):",e)),void 0!==e.attr&&(v[t]=e.attr[t])})};try{for(var g=i(t),m=g.next();!m.done;m=g.next()){y(h=m.value)}}catch(e){s={error:e}}finally{try{m&&!m.done&&(l=g.return)&&l.call(g)}finally{if(s)throw s.error}}y(n),this.checkAddTechnique(n,v),r.push(v),n.debug&&u.log("\n======== style w/ technique =========\nenv:",JSON.stringify(e.unmap(),void 0,2),"\nstyle:",JSON.stringify(n,this.cleanupStyle,2),"\ntechnique:",JSON.stringify(v,this.cleanupStyle,2))}else r.push(this.m_techniques[n._index]);return!0===n.final}this.validate&&u.warn("WARNING: No technique defined in style. Either sub-styles or a technique must be defined:",JSON.stringify(n))}return!1},e}();t.StyleSetEvaluator=L;var F=function(){function e(e){this.theme=e}return e.prototype.visitStyles=function(e){var t,n,r=function(t){var n,o;if(e(t))return!0;if(void 0!==t.styles)try{for(var a=i(t.styles),s=a.next();!s.done;s=a.next()){var u=s.value;if(r(u))return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return!1};if(void 0!==this.theme.styles)for(var o in this.theme.styles)if(void 0!==this.theme.styles[o])try{for(var a=i(this.theme.styles[o]),s=a.next();!s.done;s=a.next()){var u=s.value;if(r(u))return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!1},e}();t.ThemeVisitor=F},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=function(){return function(e,t){void 0===t&&(t=5e3),this.featureIds=new Array,this.numFeatures=0,this.numPositions=0,this.featureIds=new Array(t),this.featureIds.length=t,this.techniqueIndex=new Array(t),this.techniqueIndex.length=t,this.textIndex=new Array(t),this.textIndex.length=t,this.positionIndex=new Array(t),this.positionIndex.length=t,this.positions=new Array(10*t),this.positions.length=10*t,e&&(this.layerIndex=new Array(t),this.layerIndex.length=t,this.classIndex=new Array(t),this.classIndex.length=t,this.typeIndex=new Array(t),this.typeIndex.length=t)}}();t.FeatureGroup=a;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userData=[],t}return r(t,e),t}(a);t.LineFeatureGroup=s;var u=function(e){function t(t,n){void 0===n&&(n=5e3);var r=e.call(this,t,n)||this;return r.groupNumRings=0,r.outerRingStartIndex=new Array(n),r.outerRingStartIndex.length=n,r.innerRingIsOuterContour=new Array(n),r.innerRingIsOuterContour.length=n,r.innerRingStartIndex=new Array(n),r.innerRingStartIndex.length=n,r}return r(t,e),t}(a);t.PolygonFeatureGroup=u;var l=function(){return function(e,t){this.tileKey=e,this.textCatalog=new Array,this.techniqueCatalog=new Array,this.setupTime=0,this.pointGroup=new a(t),this.lineGroup=new s(t),this.polygonGroup=new u(t),t&&(this.layerCatalog=new Array,this.classCatalog=new Array,this.typeCatalog=new Array)}}();t.ExtendedTileInfo=l,function(e){function t(e){e.featureIds.length=e.numFeatures,e.techniqueIndex.length=e.numFeatures,e.textIndex.length=e.numFeatures,e.positionIndex.length=e.numFeatures,e.positions.length=e.numPositions,void 0!==e.layerIndex&&(e.layerIndex.length=e.numFeatures),void 0!==e.classIndex&&(e.classIndex.length=e.numFeatures),void 0!==e.typeIndex&&(e.typeIndex.length=e.numFeatures)}function n(e){return e.numPositions===e.positions.length}e.finish=function(e){t(e.pointGroup),function(e){t(e),void 0!==e.segmentIds&&(e.segmentIds.length=e.numFeatures,e.segmentStartOffsets.length=e.numFeatures,e.segmentEndOffsets.length=e.numFeatures)}(e.lineGroup),function(e){t(e),e.outerRingStartIndex.length=e.numFeatures,e.innerRingIsOuterContour.length=e.groupNumRings,e.innerRingStartIndex.length=e.groupNumRings}(e.polygonGroup)},e.featureGroupSize=function(e){return e.numFeatures},e.featureGroupFinished=n,e.tileInfoFinished=function(e){return n(e.pointGroup)&&n(e.lineGroup)&&n(e.polygonGroup)},e.getFeatureName=function(e,t,n,r){var o,a,s;if(t){var u=e.lookup("abbr");if("string"==typeof u&&u.length>0)return u}if(n){var l=e.lookup("iso_code");if("string"==typeof l&&l.length>0)return l}if(void 0!==r)try{for(var c=i(r),f=c.next();!f.done;f=c.next()){var d=f.value;if("string"==typeof(s=e.lookup("name_"+d))&&s.length>0)return s}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}if("string"==typeof(s=e.lookup("name")))return s}}(l=t.ExtendedTileInfo||(t.ExtendedTileInfo={})),t.ExtendedTileInfo=l;var c=function(){function e(e,t,n){this.tileInfo=e,this.storeExtendedTags=t,this.languages=n,this.techniqueIndexMap=new Map,this.stringMap=new Map,this.layerMap=new Map,this.classMap=new Map,this.typeMap=new Map}return e.prototype.addTechnique=function(e){if(void 0===e._index)throw new Error("ExtendedTileInfoEmitter#processPointFeature: Internal error - No technique index");var t=this.techniqueIndexMap.get(e._index);if(void 0!==t)return t;t=this.tileInfo.techniqueCatalog.length;var n={};return Object.getOwnPropertyNames(e).forEach(function(t){t.startsWith("_")||(n[t]=e[t])}),n._index=e._index,this.techniqueIndexMap.set(e._index,t),this.tileInfo.techniqueCatalog.push(n),t},e.prototype.addFeature=function(e,t,n,r,i,a){var s=t,u=s.label,c=s.useAbbreviation,f=s.useIsoCode,d="string"==typeof u?n.lookup(u):l.getFeatureName(n,c,f,this.languages),p=-1;if(d&&"string"==typeof d&&(p=this.addText(d)),e.featureIds[e.numFeatures]=r,e.techniqueIndex[e.numFeatures]=i,e.textIndex[e.numFeatures]=p,e.positionIndex[e.numFeatures]=e.numPositions,a){var h=e;o.assert(void 0!==h.outerRingStartIndex),o.assert(void 0!==h.innerRingStartIndex),o.assert(void 0!==h.innerRingIsOuterContour),h.outerRingStartIndex[e.numFeatures]=h.groupNumRings}this.storeExtendedTags&&(e.layerIndex[e.numFeatures]=this.addLayer(n.lookup("$layer")),e.classIndex[e.numFeatures]=this.addClass(n.lookup("class")),e.typeIndex[e.numFeatures]=this.addType(n.lookup("type"))),e.numFeatures++},e.prototype.addFeaturePoint=function(e,t,n){e.positions[e.numPositions++]=t,e.positions[e.numPositions++]=n},e.prototype.addFeaturePoints=function(e,t){for(var n=e.numPositions,r=t.length,i=e.positions,o=0;o<r;o++)i[n+o]=t[o];e.numPositions+=t.length},e.prototype.addRoadSegments=function(e,t,n,r){void 0===e.segmentIds&&(e.segmentIds=new Array,e.segmentStartOffsets=new Array,e.segmentEndOffsets=new Array),e.segmentIds[e.numFeatures-1]=t,e.segmentStartOffsets[e.numFeatures-1]=n,e.segmentEndOffsets[e.numFeatures-1]=r},e.prototype.addRingPoints=function(e,t,n){e.innerRingStartIndex[e.groupNumRings]=e.numPositions,e.innerRingIsOuterContour[e.groupNumRings]=n?1:0,e.groupNumRings++;for(var r=e.numPositions,i=t.length,o=e.positions,a=0;a<i;a++)o[r+a]=t[a];e.numPositions+=t.length},e.prototype.finish=function(){l.finish(this.tileInfo)},e.prototype.addText=function(e){return this.addStringValue(e,this.tileInfo.textCatalog,this.stringMap)},e.prototype.addLayer=function(e){return this.addStringValue(e,this.tileInfo.layerCatalog,this.layerMap)},e.prototype.addClass=function(e){return this.addStringValue(e,this.tileInfo.classCatalog,this.classMap)},e.prototype.addType=function(e){return this.addStringValue(e,this.tileInfo.typeCatalog,this.typeMap)},e.prototype.addStringValue=function(e,t,n){if(void 0===e)return-1;var r=e.toString(),i=n.get(r);return void 0!==i?i:(i=t.length,t.push(r),n.set(r,i),i)},e}();t.ExtendedTileInfoWriter=c;var f=function(){function e(){this.polygons=new u(!1,5e3),this.featureIndex=0,this.ringStart=0,this.numRings=0}return e.prototype.setup=function(e,t,n,r){this.polygons=e,this.featureIndex=t,this.ringStart=n,this.numRings=r},e.prototype.isOuterRing=function(e){if(o.assert(e>=0),o.assert(e<this.numRings),e<0||e>=this.numRings)throw new Error("ExtendedTileInfoPolygonAccessor: Invalid ring index");return 0!==this.polygons.innerRingIsOuterContour[this.ringStart+e]},e.prototype.getPoints=function(e){if(o.assert(e>=0),o.assert(e<this.numRings),e<0||e>=this.numRings)throw new Error("ExtendedTileInfoPolygonAccessor: Invalid ring index");var t,n=this.polygons.innerRingStartIndex[this.ringStart+e];return t=e<this.numRings-1?this.polygons.innerRingStartIndex[this.ringStart+e+1]-n:this.ringStart+e<this.polygons.innerRingStartIndex.length-1?this.polygons.innerRingStartIndex[this.ringStart+e+1]-n:this.polygons.positions.length-n,{points:this.polygons.positions,pointsStart:n,numPointValues:t}},e}(),d=function(){function e(e){this.tileInfo=e}return e.prototype.visitAll=function(e){this.visitAllPointFeatures(e),this.visitAllLineFeatures(e),this.visitAllPolygonFeatures(e)},e.prototype.visitFeature=function(e,t){for(var n=0,r=this.tileInfo.pointGroup.numFeatures,i=this.tileInfo.pointGroup.featureIds,o=0;o<r;o++)i[o]===e&&(n++,this.visitPointFeature(o,t));var a=this.tileInfo.lineGroup.numFeatures,s=this.tileInfo.lineGroup.featureIds;for(o=0;o<a;o++)s[o]===e&&(n++,this.visitLineFeature(o,t));var u=this.tileInfo.polygonGroup.numFeatures,l=this.tileInfo.polygonGroup.featureIds;for(o=0;o<u;o++)l[o]===e&&(n++,this.visitPolygonFeature(o,t));return n},e.prototype.visitAllPointFeatures=function(e){for(var t=this.tileInfo.pointGroup.numFeatures,n=0;n<t;n++)this.visitPointFeature(n,e)},e.prototype.visitAllLineFeatures=function(e){for(var t=this.tileInfo.lineGroup.numFeatures,n=0;n<t;n++)this.visitLineFeature(n,e)},e.prototype.visitAllPolygonFeatures=function(e){for(var t=this.tileInfo.polygonGroup.numFeatures,n=0;n<t;n++)this.visitPolygonFeature(n,e)},e.prototype.getTag=function(e,t){return void 0!==t&&t[e]>=0?t[e]:-1},e.prototype.visitPointFeature=function(e,t){var n=this.tileInfo.pointGroup,r=n.positionIndex[e],i=n.positions[r],o=n.positions[r+1];t.acceptPoint&&t.acceptPoint(n.featureIds[e],n.techniqueIndex[e],i,o,n.textIndex[e],this.getTag(e,n.layerIndex),this.getTag(e,n.classIndex),this.getTag(e,n.typeIndex))},e.prototype.visitLineFeature=function(e,t){var n,r,i,o=this.tileInfo,a=o.lineGroup,s=a.numFeatures,u=a.positionIndex[e],l=e===s-1?a.positions.length-u:a.positionIndex[e+1]-u;void 0!==a.segmentIds&&(n=a.segmentIds[e],r=a.segmentStartOffsets[e],i=a.segmentEndOffsets[e]),t.acceptLine&&t.acceptLine(a.featureIds[e],a.techniqueIndex[e],a.textIndex[e],this.getTag(e,a.layerIndex),this.getTag(e,a.classIndex),this.getTag(e,a.typeIndex),o.lineGroup.positions,u,l,n,r,i)},e.prototype.visitPolygonFeature=function(t,n){var r=this.tileInfo.polygonGroup,i=r.numFeatures,o=r.outerRingStartIndex[t],a=t===i-1?r.innerRingStartIndex.length-o:r.outerRingStartIndex[t+1]-o;e.polygonAccessor.setup(r,t,o,a),n.acceptPolygon&&n.acceptPolygon(r.featureIds[t],r.techniqueIndex[t],r.textIndex[t],this.getTag(t,r.layerIndex),this.getTag(t,r.classIndex),this.getTag(t,r.typeIndex),e.polygonAccessor)},e.polygonAccessor=new f,e}();t.ExtendedTileInfoVisitor=d},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Configuration="configuration",e.Initialized="initialized",e.Request="request",e.Response="response",e.CreateService="create-service",e.DestroyService="destroy-service"}(r=t.DecodedTileMessageName||(t.DecodedTileMessageName={})),t.WORKER_SERVICE_MANAGER_SERVICE_ID="worker-service-manager",function(e){e.DecodeTileRequest="decode-tile-request",e.TileInfoRequest="tile-info-request"}(i=t.Requests||(t.Requests={})),t.isConfigurationMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===r.Configuration},t.isInitializedMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===r.Initialized},t.isRequestMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===r.Request},t.isResponseMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===r.Response},t.isDecodeTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===i.DecodeTileRequest},t.isTileInfoRequest=function(e){return e&&"string"==typeof e.type&&e.type===i.TileInfoRequest}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(15),a=n(2),s=n(14),u=a.LoggerManager.instance.create("TileDecoderService"),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.serviceId=t,r.m_decoder=n,r.m_decoder.connect(),r}return r(t,e),t.start=function(e,n){return new t(e,n)},t.prototype.handleRequest=function(t){var n=this;return i.isDecodeTileRequest(t)?new Promise(function(e){e(n.handleDecodeTileRequest(t))}):i.isTileInfoRequest(t)?new Promise(function(e){e(n.handleTileInfoRequest(t))}):e.prototype.handleRequest.call(this,t)},t.prototype.handleMessage=function(e){i.isConfigurationMessage(e)?this.handleConfigurationMessage(e):u.error("["+this.serviceId+"]: invalid message "+e.type)},t.prototype.handleDecodeTileRequest=function(e){var t=o.TileKey.fromMortonCode(e.tileKey),n=i.getProjection(e.projection);return this.m_decoder.decodeTile(e.data,t,n).then(function(e){var t=[];return e.geometries.forEach(function(e){e.vertexAttributes.forEach(function(e){e.buffer instanceof ArrayBuffer&&t.push(e.buffer)}),e.index&&e.index.buffer instanceof ArrayBuffer&&t.push(e.index.buffer)}),e.techniques.forEach(function(e){i.isStandardTexturedTechnique(e)&&i.isTextureBuffer(e.texture)&&e.texture.buffer instanceof ArrayBuffer&&t.push(e.texture.buffer)}),{response:e,transferList:t}})},t.prototype.handleTileInfoRequest=function(e){var t=o.TileKey.fromMortonCode(e.tileKey),n=i.getProjection(e.projection);return this.m_decoder.getTileInfo(e.data,t,n).then(function(e){return{response:e,transferList:void 0!==e&&void 0!==e.transferList?e.transferList:[]}})},t.prototype.handleConfigurationMessage=function(e){this.m_decoder.configure(e.styleSet,e.languages,e.options)},t}(s.WorkerService);t.TileDecoderService=l},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(2),a=n(14),s=o.LoggerManager.instance.create("WorkerServiceManager"),u=function(e){function t(t){void 0===t&&(t=i.WORKER_SERVICE_MANAGER_SERVICE_ID);var n=e.call(this,t)||this;return n.m_factories=new Map,n.m_services=new Map,n}return r(t,e),t.getInstance=function(){return void 0===this.m_service&&(this.m_service=new t(i.WORKER_SERVICE_MANAGER_SERVICE_ID)),this.m_service},t.prototype.register=function(e){this.m_factories.set(e.serviceType,e.factory)},t.prototype.handleMessage=function(e){if(e.type===i.DecodedTileMessageName.CreateService){if(void 0!==this.m_services.get(e.targetServiceId))return void s.error("error - service with targetServiceId='"+e.targetServiceId+"' already running, ignoring CreateService request");var t=this.m_factories.get(e.targetServiceType);if(void 0===t)return void s.error("unkown targetServiceType requested: '"+e.targetServiceType+"'");var n=t(e.targetServiceId);this.m_services.set(e.targetServiceId,n)}if(e.type===i.DecodedTileMessageName.DestroyService){if(void 0===(n=this.m_services.get(e.targetServiceId)))return void s.error("unkown targetServiceId '"+e.targetServiceId+"'");n.destroy(),this.m_services.delete(e.targetServiceId)}},t}(a.WorkerService);t.WorkerServiceManager=u}]);
//# sourceMappingURL=quantized-mesh-decoder.bundle.js.map