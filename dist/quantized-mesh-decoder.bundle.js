!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=26)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=180/Math.PI,o=Math.PI/180,i=function(){function e(e,t,r){this.latitude=e,this.longitude=t,this.altitude=r}return e.fromDegrees=function(t,r,n){return new e(t,r,n)},e.fromRadians=function(t,r,o){return new e(t*n,r*n,o)},Object.defineProperty(e.prototype,"latitudeInRadians",{get:function(){return this.latitude*o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeInRadians",{get:function(){return this.longitude*o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeInDegrees",{get:function(){return this.latitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeInDegrees",{get:function(){return this.longitude},enumerable:!0,configurable:!0}),e.prototype.isValid=function(){return!isNaN(this.latitude)&&!isNaN(this.longitude)},e.prototype.normalized=function(){var t,r=this.latitude,n=this.longitude;if(isNaN(r)||isNaN(n))return this;r>90&&((t=(r+90)%360)>=180&&(n+=180,t=360-t),r=t-90);r<-90&&((t=(r-90)%360)<=-180&&(n+=180,t=-360-t),r=t+90);return(n<-180||n>180)&&(n=(n+180)%360-180),r===this.latitude&&n===this.longitude?this:new e(r,n,this.altitude)},e.prototype.equals=function(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.altitude===e.altitude},e.prototype.copy=function(e){return this.latitude=e.latitude,this.longitude=e.longitude,this.altitude=e.altitude,this},e.prototype.clone=function(){return new e(this.latitude,this.longitude,this.altitude)},e}();t.GeoCoordinates=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(38)),n(r(39)),n(r(43)),n(r(44)),n(r(45)),n(r(46)),n(r(47)),n(r(48)),n(r(49)),n(r(50))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(14)),n(r(37)),n(r(51)),n(r(52)),n(r(53)),n(r(54)),n(r(55)),n(r(56)),n(r(57))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=Math.PI/180,i=function(){function e(e,t){this.southWest=e,this.northEast=t}return e.fromCoordinates=function(t,r){return new e(t,r)},Object.defineProperty(e.prototype,"minAltitude",{get:function(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.min(this.southWest.altitude,this.northEast.altitude)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxAltitude",{get:function(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.max(this.southWest.altitude,this.northEast.altitude)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"south",{get:function(){return this.southWest.latitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"north",{get:function(){return this.northEast.latitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"west",{get:function(){return this.southWest.longitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"east",{get:function(){return this.northEast.longitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){var e,t=.5*(this.south+this.north),r=this.west,o=this.east,i=this.minAltitude,a=this.altitudeSpan;if(void 0!==i&&void 0!==a&&(e=i+.5*a),r<o)return new n.GeoCoordinates(t,.5*(r+o),e);var s=.5*(360+o+r);return s>360&&(s-=360),new n.GeoCoordinates(t,s,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeSpanInRadians",{get:function(){return this.latitudeSpan*o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeSpanInRadians",{get:function(){return this.longitudeSpan*o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeSpan",{get:function(){return this.north-this.south},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altitudeSpan",{get:function(){if(void 0!==this.maxAltitude&&void 0!==this.minAltitude)return this.maxAltitude-this.minAltitude},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeSpan",{get:function(){var e=this.northEast.longitude-this.southWest.longitude;return e<0&&(e+=360),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitudeSpanInDegrees",{get:function(){return this.latitudeSpan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitudeSpanInDegrees",{get:function(){return this.longitudeSpan},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){if(void 0===e.altitude||void 0===this.minAltitude||void 0===this.maxAltitude)return this.containsHelper(e);var t=this.minAltitude===this.maxAltitude,r=this.minAltitude===e.altitude,n=this.minAltitude<=e.altitude&&this.maxAltitude>e.altitude;return!(t?!r:!n)&&this.containsHelper(e)},e.prototype.clone=function(){return new e(this.southWest,this.northEast)},e.prototype.containsHelper=function(e){if(e.latitude<this.southWest.latitude||e.latitude>=this.northEast.latitude)return!1;var t=this.west,r=this.east;return r>t?e.longitude>=t&&e.longitude<r:e.longitude>r||e.longitude<=t},e}();t.GeoBox=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Math.PI/180,o=180/Math.PI;!function(e){function t(e){return(e%=360)<0&&(e+=360),e}function r(e,r){var n=(e=t(e))-(r=t(r));return n>180?n-360:n<=-180?n+360:n}e.newEmptyBox3=function(){return{min:{x:1/0,y:1/0,z:1/0},max:{x:-1/0,y:-1/0,z:-1/0}}},e.degToRad=function(e){return e*n},e.radToDeg=function(e){return e*o},e.clamp=function(e,t,r){return e<t?t:e>r?r:e},e.normalizeAngleDeg=t,e.angleDistanceDeg=r,e.interpolateAnglesDeg=function(e,t,n){return(e+r(t,e)*n)%360}}(t.MathUtils||(t.MathUtils={}))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(3)),n(r(30)),n(r(0)),n(r(10)),n(r(15)),n(r(31)),n(r(11)),n(r(16)),n(r(17)),n(r(18)),n(r(12)),n(r(32)),n(r(19)),n(r(6)),n(r(20)),n(r(21)),n(r(7)),n(r(33)),n(r(34)),n(r(35)),n(r(36)),n(r(4))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,9007199254740992,0x8000000000000],o=function(){function e(e,t,r){this.row=e,this.column=t,this.level=r}return e.fromRowColumnLevel=function(t,r,n){return new e(t,r,n)},e.fromQuadKey=function(t){for(var r=t.length,n=0,o=0,i=0;i<t.length;++i){var a=1<<i,s=parseInt(t.charAt(r-i-1),10);1&s&&(o|=a),2&s&&(n|=a)}return e.fromRowColumnLevel(n,o,r)},e.fromMortonCode=function(t){for(var r=0,n=0,o=0,i=t;i>1;){var a=1<<r;1&i&&(o|=a),2&i&&(n|=a),r++,i=(i-(3&i))/4}var s=e.fromRowColumnLevel(n,o,r);return s.m_mortonCode=t,s},e.fromHereTile=function(t){var r=e.fromMortonCode(parseInt(t,10));return r.m_hereTile=t,r},e.columnsAtLevel=function(e){return Math.pow(2,e)},e.rowsAtLevel=function(e){return Math.pow(2,e)},e.atCoords=function(t,r,n,o,i){return e.fromRowColumnLevel(Math.floor(n/(i/e.rowsAtLevel(t))),Math.floor(r/(o/e.columnsAtLevel(t))),t)},e.parentMortonCode=function(e){return Math.floor(e/4)},e.prototype.parent=function(){if(0===this.level)throw new Error("Cannot get the parent of the root tile key");return e.fromRowColumnLevel(this.row>>>1,this.column>>>1,this.level-1)},e.prototype.changedLevelBy=function(t){var r=Math.max(0,this.level+t),n=this.row,o=this.column;return t>=0?(n<<=t,o<<=t):(n>>>=-t,o>>>=-t),e.fromRowColumnLevel(n,o,r)},e.prototype.changedLevelTo=function(e){return this.changedLevelBy(e-this.level)},e.prototype.mortonCode=function(){if(void 0===this.m_mortonCode){for(var e=this.column,t=this.row,r=n[this.level<<1],o=0;o<this.level;++o)1&e&&(r+=n[2*o]),1&t&&(r+=n[2*o+1]),e>>>=1,t>>>=1;this.m_mortonCode=r}return this.m_mortonCode},e.prototype.toHereTile=function(){return void 0===this.m_hereTile&&(this.m_hereTile=this.mortonCode().toString()),this.m_hereTile},e.prototype.toQuadKey=function(){for(var e="",t=this.level;t>0;--t){var r=1<<t-1,n=0!=(this.column&r),o=0!=(this.row&r);e+=n&&o?"3":o?"2":n?"1":"0"}return e},e.prototype.equals=function(e){return this.row===e.row&&this.column===e.column&&this.level===e.level},e.prototype.addedSubKey=function(t){var r=e.fromQuadKey(0===t.length?"-":t),n=this.changedLevelBy(r.level);return e.fromRowColumnLevel(n.row+r.row,n.column+r.column,n.level)},e.prototype.addedSubHereTile=function(t){var r=e.fromHereTile(t),n=this.changedLevelBy(r.level);return e.fromRowColumnLevel(n.row+r.row,n.column+r.column,n.level)},e.prototype.getSubHereTile=function(e){var t=1<<2*e;return(this.mortonCode()&t-1|t).toString()},e.prototype.rowCount=function(){return e.rowsAtLevel(this.level)},e.prototype.columnCount=function(){return e.columnsAtLevel(this.level)},e}();t.TileKey=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),o=r(20),i=r(21),a=function(){function e(e,t){this.subdivisionScheme=e,this.projection=t,this.boundingBoxGenerator=new n.FlatTileBoundingBoxGenerator(this),this.tileTreeTraverse=new i.TileTreeTraverse(e)}return e.prototype.getSubTileKeys=function(e){return this.tileTreeTraverse.subTiles(e)},e.prototype.getTileKey=function(e,t){return o.TileKeyUtils.geoCoordinatesToTileKey(this,e,t)},e.prototype.getTileKeys=function(e,t){return o.TileKeyUtils.geoRectangleToTileKeys(this,e,t)},e.prototype.getGeoBox=function(e){return this.boundingBoxGenerator.getGeoBox(e)},e.prototype.getWorldBox=function(e,t){return this.boundingBoxGenerator.getWorldBox(e,t)},e}();t.TilingScheme=a},function(e,t){e.exports=THREE},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(1).LoggerManager.instance.create("WorkerService",{enabled:!1}),i=function(){function e(e){var t=this;this.serviceId=e,this.m_pendingRequests=new Map,this.onMessage=function(e){if("string"==typeof e.data.service&&e.data.service===t.serviceId)try{if(n.WorkerServiceProtocol.isRequestMessage(e.data)){var r=e.data,i={service:r.service,messageId:r.messageId,responseSent:!1};t.m_pendingRequests.set(r.messageId,i),t.tryHandleRequest(r.request).then(function(e){t.doSendResponse(i,{service:t.serviceId,type:n.WorkerServiceProtocol.ServiceMessageName.Response,messageId:r.messageId,response:e.response},e.transferList)}).catch(function(e){t.doSendResponse(i,{service:t.serviceId,type:n.WorkerServiceProtocol.ServiceMessageName.Response,messageId:r.messageId,error:e.toString()})})}else t.tryHandleMessage(e.data)}catch(r){o.error("["+t.serviceId+"]: Unhandled exception when handling "+e.type)}},self.addEventListener("message",this.onMessage);var r={service:e,type:n.WorkerServiceProtocol.ServiceMessageName.Initialized};self.postMessage(r)}return e.prototype.destroy=function(){this.cancelAllPendingRequests(),self.removeEventListener("message",this.onMessage)},e.prototype.handleMessage=function(e){o.error("["+this.serviceId+"]: Invalid message "+e.type)},e.prototype.handleRequest=function(e){throw new Error("ServiceAdapter["+this.serviceId+"]: Invalid request '"+e.type+"'")},e.prototype.tryHandleMessage=function(e){try{this.handleMessage(e)}catch(t){o.error("["+this.serviceId+"]: Failed, handling message "+e.type)}},e.prototype.tryHandleRequest=function(e){try{return this.handleRequest(e)}catch(e){return o.error("["+this.serviceId+"]: Failure",e),Promise.reject(e)}},e.prototype.doSendResponse=function(e,t,r){e.responseSent||(self.postMessage(t,r),e.responseSent=!0,this.m_pendingRequests.delete(e.messageId))},e.prototype.cancelAllPendingRequests=function(){var e=this;this.m_pendingRequests.forEach(function(t){e.doSendResponse(t,{service:e.serviceId,type:n.WorkerServiceProtocol.ServiceMessageName.Response,messageId:t.messageId,error:"cancelled"})})},e}();t.WorkerService=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.EQUATORIAL_CIRCUMFERENCE=40075016.68557849,e}();t.EarthConstants=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(0),i=r(4),a=r(10),s=function(){function e(){}return e.clamp=function(e,t,r){return Math.min(Math.max(t,e),r)},e.latitudeClamp=function(t){return e.clamp(t,-e.MAXIMUM_LATITUDE,e.MAXIMUM_LATITUDE)},e.latitudeProject=function(e){return Math.log(Math.tan(.25*Math.PI+.5*e))/Math.PI},e.latitudeClampProject=function(t){return e.latitudeProject(e.latitudeClamp(t))},e.unprojectLatitude=function(e){return 2*Math.atan(Math.exp(Math.PI*e))-.5*Math.PI},e.prototype.getScaleFactor=function(e){return Math.cosh(2*Math.PI*(e.y/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE-.5))},e.prototype.worldExtent=function(e,t,r){return r||(r=i.MathUtils.newEmptyBox3()),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,r.max.y=a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,r.max.z=t,r},e.prototype.projectPoint=function(t,r){var n;return n=t instanceof o.GeoCoordinates?t.normalized():new o.GeoCoordinates(t.latitude,t.longitude,t.altitude).normalized(),r||(r={x:0,y:0,z:0}),r.x=(n.longitude+180)/360*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,r.y=(.5*e.latitudeClampProject(n.latitudeInRadians)+.5)*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,r.z=t.altitude||0,r},e.prototype.unprojectPoint=function(t){return o.GeoCoordinates.fromRadians(e.unprojectLatitude(2*(t.y/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE-.5)),t.x/a.EarthConstants.EQUATORIAL_CIRCUMFERENCE*2*Math.PI-Math.PI,t.z)},e.prototype.projectBox=function(t,r){var n=t.center,s=this.projectPoint(new o.GeoCoordinates(n.latitude,n.longitude,0)),u=(.5*e.latitudeClampProject(t.northEast.latitudeInRadians)+.5)*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,l=(.5*e.latitudeClampProject(t.southWest.latitudeInRadians)+.5)*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE,c=.5*(u+l);s.y=c;var f=u-l,h=t.longitudeSpan/360*a.EarthConstants.EQUATORIAL_CIRCUMFERENCE;r||(r=i.MathUtils.newEmptyBox3()),r.min.x=s.x-.5*h,r.min.y=s.y-.5*f,r.max.x=s.x+.5*h,r.max.y=s.y+.5*f;var p=t.altitudeSpan;return void 0!==p?(r.min.z=s.z-.5*p,r.max.z=s.z+.5*p):(r.min.z=0,r.max.z=0),r},e.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,r)},e.MAXIMUM_LATITUDE=1.4844222297453322,e}();t.MercatorProjection=s,t.mercatorProjection=new s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getSubdivisionX=function(){return 2},e.prototype.getSubdivisionY=function(){return 2},e.prototype.getLevelDimensionX=function(e){return 1<<e},e.prototype.getLevelDimensionY=function(e){return 1<<e},e}();t.quadTreeSubdivisionScheme=new n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Log=2]="Log",e[e.Info=3]="Info",e[e.Warn=4]="Warn",e[e.Error=5]="Error"}(t.LogLevel||(t.LogLevel={}));var n=function(){return function(){}}();t.LoggerOptions=n},function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),i=r(8);!function(e){e.Show="show-in-stack",e.Hide="hide-in-stack",e.ShowParent="show-parent"}(t.PoiStackMode||(t.PoiStackMode={})),t.isCirclesTechnique=function(e){return"circles"===e.name},t.isSquaresTechnique=function(e){return"squares"===e.name},t.isPoiTechnique=function(e){return"labeled-icon"===e.name},t.isLineMarkerTechnique=function(e){return"line-marker"===e.name},t.isDashedLineTechnique=function(e){return"dashed-line"===e.name},t.isLineTechnique=function(e){return"line"===e.name},t.isSolidLineTechnique=function(e){return"solid-line"===e.name},t.isSegmentsTechnique=function(e){return"segments"===e.name},t.isExtrudedLineTechnique=function(e){return"extruded-line"===e.name},t.isFillTechnique=function(e){return"fill"===e.name},t.isExtrudedPolygonTechnique=function(e){return"extruded-polygon"===e.name},t.isStandardTechnique=function(e){return"standard"===e.name},t.isStandardTexturedTechnique=function(e){return"standard-textured"===e.name},t.isLandmarkTechnique=function(e){return"landmark"===e.name},t.isTextTechnique=function(e){return"text"===e.name},t.isShaderTechnique=function(e){return"shader"===e.name},t.isTextureBuffer=function(e){return e&&e.buffer&&"string"==typeof e.type};var a=[i.DiscreteInterpolant,i.LinearInterpolant,i.CubicInterpolant];function s(e){return void 0!==e&&void 0!==e.interpolationMode&&void 0!==e.zoomLevels&&void 0!==e.values&&e.values.length>0&&(e.zoomLevels.length===e.values.length/3||e.zoomLevels.length===e.values.length)}!function(e){e[e.Discrete=0]="Discrete",e[e.Linear=1]="Linear",e[e.Cubic=2]="Cubic"}(t.InterpolationMode||(t.InterpolationMode={})),t.isInterpolatedProperty=s,t.getPropertyValue=function(e,t){var r,i;if(s(e)){var u=e.values.length/e.zoomLevels.length,l=u>1,c=new a[e.interpolationMode](e.zoomLevels,e.values,u);c.evaluate(t);var f=l?"#":0;try{for(var h=n(c.resultBuffer),p=h.next();!p.done;p=h.next()){var d=p.value;f+=l?("0"+(255*o.MathUtils.clamp(d,0,1)|0).toString(16)).slice(-2):d}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return f}return e},t.toPixelFormat=function(e){if("Alpha"===e)return i.AlphaFormat;if("RGB"===e)return i.RGBFormat;if("RGBA"===e)return i.RGBAFormat;if("Luminance"===e)return i.LuminanceFormat;if("LuminanceAlpha"===e)return i.LuminanceAlphaFormat;if("RGBE"===e)return i.RGBEFormat;if("Depth"===e)return i.DepthFormat;if("DepthStencil"===e)return i.DepthStencilFormat;throw new Error("invalid pixel format: "+e)},t.toTextureDataType=function(e){if("UnsignedByte"===e)return i.UnsignedByteType;if("Byte"===e)return i.ByteType;if("Short"===e)return i.ShortType;if("UnsignedShort"===e)return i.UnsignedShortType;if("Int"===e)return i.IntType;if("UnsignedInt"===e)return i.UnsignedIntType;if("Float"===e)return i.FloatType;if("HalfFloat"===e)return i.HalfFloatType;throw new Error("invalid texture data type: "+e)},t.toWrappingMode=function(e){if("clamp"===e)return i.ClampToEdgeWrapping;if("repeat"===e)return i.RepeatWrapping;if("mirror"===e)return i.MirroredRepeatWrapping;throw new Error("invalid wrapping: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(0),i=r(4),a=Math.PI/180,s=function(){function e(){}return e.prototype.getScaleFactor=function(e){return 1},e.prototype.worldExtent=function(e,t,r){return r||(r=i.MathUtils.newEmptyBox3()),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=1,r.max.y=.5,r.max.z=t,r},e.prototype.projectPoint=function(t,r){return void 0===r&&(r={x:0,y:0,z:0}),r.x=(t.longitude*a+Math.PI)*e.geoToWorldScale,r.y=(t.latitude*a+.5*Math.PI)*e.geoToWorldScale,r.z=t.altitude||0,r},e.prototype.unprojectPoint=function(t){return o.GeoCoordinates.fromRadians(t.y*e.worldToGeoScale-.5*Math.PI,t.x*e.worldToGeoScale-Math.PI,t.z)},e.prototype.projectBox=function(t,r){var n=this.projectPoint(new o.GeoCoordinates(t.center.latitude,t.center.longitude,0)),a=t.latitudeSpanInRadians,s=t.longitudeSpanInRadians,u=t.altitudeSpan,l=s*e.geoToWorldScale,c=a*e.geoToWorldScale;return r||(r=i.MathUtils.newEmptyBox3()),r.min.x=n.x-.5*l,r.min.y=n.y-.5*c,r.max.x=n.x+.5*l,r.max.y=n.y+.5*c,void 0!==u?(r.min.z=n.z-.5*u,r.max.z=n.z+.5*u):(r.min.z=0,r.max.z=0),r},e.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,r)},e.geoToWorldScale=1/(2*Math.PI),e.worldToGeoScale=2*Math.PI/1,e}();t.equirectangularProjection=new s},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),a=r(0),s=r(10),u=r(11),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.projectPoint=function(e,t){var r;r=e instanceof a.GeoCoordinates?e.normalized():new a.GeoCoordinates(e.latitude,e.longitude,e.altitude).normalized(),t||(t={x:0,y:0,z:0}),t.x=(r.longitude+180)/360*s.EarthConstants.EQUATORIAL_CIRCUMFERENCE;var n=Math.sin(u.MercatorProjection.latitudeClamp(r.latitudeInRadians));return t.y=(.5-Math.log((1+n)/(1-n))/(4*Math.PI))*s.EarthConstants.EQUATORIAL_CIRCUMFERENCE,t.z=e.altitude||0,t},t.prototype.unprojectPoint=function(e){var t=u.MercatorProjection.clamp(e.x,0,s.EarthConstants.EQUATORIAL_CIRCUMFERENCE)/s.EarthConstants.EQUATORIAL_CIRCUMFERENCE-.5,r=.5-u.MercatorProjection.clamp(e.y,0,s.EarthConstants.EQUATORIAL_CIRCUMFERENCE)/s.EarthConstants.EQUATORIAL_CIRCUMFERENCE,n=360*t,o=90-360*Math.atan(Math.exp(2*-r*Math.PI))/Math.PI;return new a.GeoCoordinates(o,n,e.z)},t.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return new i.GeoBox(new a.GeoCoordinates(r.latitude,t.longitude,t.altitude),new a.GeoCoordinates(t.latitude,r.longitude,r.altitude))},t.MAXIMUM_LATITUDE=1.4844222297453322,t}(u.MercatorProjection);t.webMercatorProjection=new l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),this.tilingScheme=e,this.minElevation=t,this.maxElevation=r,this.m_tilingScheme=e,this.m_worldBox=e.projection.worldExtent(t,r);var n=this.m_worldBox,o=n.min,i=n.max;this.m_worldDimensions={x:i.x-o.x,y:i.y-o.y,z:i.z-o.z}}return Object.defineProperty(e.prototype,"projection",{get:function(){return this.m_tilingScheme.projection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subdivisionScheme",{get:function(){return this.m_tilingScheme.subdivisionScheme},enumerable:!0,configurable:!0}),e.prototype.getWorldBox=function(e,t){var r=e.level,o=this.subdivisionScheme.getLevelDimensionX(r),i=this.subdivisionScheme.getLevelDimensionY(r),a=this.m_worldDimensions.x/o,s=this.m_worldDimensions.y/i,u=this.m_worldBox.min.x+a*e.column,l=this.m_worldBox.min.y+s*e.row;return t||(t=n.MathUtils.newEmptyBox3()),t.min.x=u,t.min.y=l,t.min.z=this.m_worldBox.min.z,t.max.x=u+a,t.max.y=l+s,t.max.z=this.m_worldBox.max.z,t},e.prototype.getGeoBox=function(e){var t=this.getWorldBox(e);return this.projection.unprojectBox(t)},e}();t.FlatTileBoundingBoxGenerator=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getSubdivisionX=function(){return 2},e.prototype.getSubdivisionY=function(e){return 0===e?1:2},e.prototype.getLevelDimensionX=function(e){return 1<<e},e.prototype.getLevelDimensionY=function(e){return 0!==e?1<<e-1:1},e}();t.halfQuadTreeSubdivisionScheme=new n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=function(){function e(e,t,r){this.m_tileKey=e,this.m_level=t,this.m_count=1<<(t<<1),this.m_mask=r,this.m_shift=t>2?t-2<<1:0}return Object.defineProperty(e.prototype,"length",{get:function(){return this.m_count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this.m_level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileKey",{get:function(){return this.m_tileKey},enumerable:!0,configurable:!0}),e.prototype.iterator=function(){return new e.Iterator(this)},e.prototype.skip=function(e){if(-1!==this.m_mask)for(;e<this.m_count&&0==(this.m_mask&1<<(e>>this.m_shift));)++e;return e},e}();t.SubTiles=o,function(e){var t=function(){function e(e,t){void 0===t&&(t=0),this.m_parent=e,this.m_index=e.skip(t)}return Object.defineProperty(e.prototype,"value",{get:function(){var e=this.m_parent.tileKey,t=this.m_parent.level;return n.TileKey.fromRowColumnLevel(e.row<<t|this.m_index>>t,e.column<<t|this.m_index&(1<<t)-1,e.level+t)},enumerable:!0,configurable:!0}),e.prototype.next=function(){this.m_index=this.m_parent.skip(++this.m_index)},e}();e.Iterator=t}(o=t.SubTiles||(t.SubTiles={})),t.SubTiles=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(6),i=function(){function e(){}return e.geoCoordinatesToTileKey=function(e,t,r){var n=e.projection,i=e.subdivisionScheme,a=n.projectPoint(t),s=i.getLevelDimensionX(r),u=i.getLevelDimensionY(r),l=n.worldExtent(0,0),c=l.min,f=l.max,h=f.x-c.x,p=f.y-c.y;if(a.x<c.x||a.x>f.x)return null;if(a.y<c.y||a.y>f.y)return null;var d=Math.min(s-1,Math.floor(s*(a.x-c.x)/h)),y=Math.min(u-1,Math.floor(u*(a.y-c.y)/p));return o.TileKey.fromRowColumnLevel(y,d,r)},e.geoRectangleToTileKeys=function(t,r,i){var a=function(e,t,r){return e<t?r-(t-e)%(r-t):t+(e-t)%(r-t)},s=function(e,t,r){return Math.min(Math.max(e,t),r)},u=a(r.southWest.longitudeInRadians,-Math.PI,Math.PI),l=s(r.southWest.latitudeInRadians,-.5*Math.PI,.5*Math.PI),c=a(r.northEast.longitudeInRadians,-Math.PI,Math.PI),f=s(r.northEast.latitudeInRadians,-.5*Math.PI,.5*Math.PI),h=e.geoCoordinatesToTileKey(t,n.GeoCoordinates.fromRadians(l,u),i),p=e.geoCoordinatesToTileKey(t,n.GeoCoordinates.fromRadians(f,c),i),d=t.subdivisionScheme.getLevelDimensionX(i);if(!h||!p)throw new Error("Invalid coordinates");var y=h.column,v=p.column;u>c&&(v+=v!==y?d:d-1);for(var g=Math.min(h.row,p.row),m=Math.max(h.row,p.row),x=new Array,_=g;_<=m;++_)for(var E=y;E<=v;++E)x.push(o.TileKey.fromRowColumnLevel(_,E%d,i));return x},e}();t.TileKeyUtils=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=function(){function e(e){this.m_subdivisionScheme=e}return e.prototype.subTiles=function(e){for(var t=~(-1<<this.m_subdivisionScheme.getSubdivisionX(e.level)*this.m_subdivisionScheme.getSubdivisionY(e.level)),r=new n.SubTiles(e,1,t),o=r.iterator(),i=new Array,a=0;a<r.length;++a)i.push(o.value),o.next();return i},e}();t.TileTreeTraverse=o},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.error.apply(console,o([e],t))},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.debug.apply(console,o([e],t))},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.info.apply(console,o([e],t))},e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.log.apply(console,o([e],t))},e.prototype.trace=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.trace.apply(console,o([e],t))},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.warn.apply(console,o([e],t))},e}();t.ConsoleChannel=i},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(13),a=function(){function e(e,t,r){this.name=e,this.m_channel=t,this.enabled=!0,this.level=i.LogLevel.Trace,void 0!==r&&this.update(r)}return e.prototype.error=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enabled&&this.level<=i.LogLevel.Error&&(t=this.m_channel).error.apply(t,o([this.prefix,e],r))},e.prototype.debug=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enabled&&this.level<=i.LogLevel.Debug&&(t=this.m_channel).debug.apply(t,o([this.prefix,e],r))},e.prototype.info=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enabled&&this.level<=i.LogLevel.Info&&(t=this.m_channel).info.apply(t,o([this.prefix,e],r))},e.prototype.log=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enabled&&this.level<=i.LogLevel.Log&&(t=this.m_channel).log.apply(t,o([this.prefix,e],r))},e.prototype.trace=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enabled&&this.level<=i.LogLevel.Trace&&(t=this.m_channel).trace.apply(t,o([this.prefix,e],r))},e.prototype.warn=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enabled&&this.level<=i.LogLevel.Warn&&(t=this.m_channel).warn.apply(t,o([this.prefix,e],r))},e.prototype.update=function(e){this.enabled=void 0===e.enabled?this.enabled:e.enabled,this.level=void 0===e.level?this.level:e.level},Object.defineProperty(e.prototype,"prefix",{get:function(){return this.name+":"},enumerable:!0,configurable:!0}),e}();t.Logger=a},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(13);t.WORKERCHANNEL_MSG_TYPE="worker-channel-message";var a=function(){function e(){}return e.prototype.error=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a={message:o([e],r),type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Error};self.postMessage(a)},e.prototype.debug=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a={message:o([e],r),type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Debug};self.postMessage(a)},e.prototype.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a={message:o([e],r),type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Info};self.postMessage(a)},e.prototype.log=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a={message:o([e],r),type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Log};self.postMessage(a)},e.prototype.trace=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a={message:o([e],r),type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Trace};self.postMessage(a)},e.prototype.warn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a={message:o([e],r),type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Warn};self.postMessage(a)},e}();t.WorkerChannel=a},function(e,t,r){"use strict";r.r(t);const n=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function o(e){return e>>1^-(1&e)}function i(e,t,r,n,o=!0){let i;if(i=2===n?new Uint16Array(e,t,r):new Uint32Array(e,t,r),!o)return i;let a=0;for(let e=0;e<i.length;++e){let t=i[e];i[e]=a-t,0===t&&++a}return i}function a(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const s={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},u={maxDecodingStep:s.extensions};function l(e,t){const r=Object.assign({},u,t),l=new DataView(e),{header:c,headerEndPosition:f}=function(e){let t=0;const r={};for(let[o,i]of n){const n=8===i?e.getFloat64:e.getFloat32;r[o]=n.call(e,t,!0),t+=i}return{header:r,headerEndPosition:t}}(l);if(r.maxDecodingStep<s.vertices)return{header:c};const{vertexData:h,vertexDataEndPosition:p}=function(e,t){let r=t;const n=e.getUint32(r,!0),i=new Uint16Array(3*n);r+=Uint32Array.BYTES_PER_ELEMENT;const a=Uint16Array.BYTES_PER_ELEMENT,s=n*a,u=r,l=u+s,c=l+s;let f=0,h=0,p=0;for(let t=0;t<n;t++)f+=o(e.getUint16(u+a*t,!0)),h+=o(e.getUint16(l+a*t,!0)),p+=o(e.getUint16(c+a*t,!0)),i[t]=f,i[t+n]=h,i[t+2*n]=p;return{vertexData:i,vertexDataEndPosition:r+=3*s}}(l,f);if(r.maxDecodingStep<s.triangleIndices)return{header:c,vertexData:h};const{triangleIndices:d,triangleIndicesEndPosition:y}=function(e,t,r){let n=r;const o=t.length/3>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;n%o!=0&&(n+=o-n%o);const a=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;const s=3*a,u=i(e.buffer,n,s,o);return{triangleIndicesEndPosition:n+=s*o,triangleIndices:u}}(l,h,p);if(r.maxDecodingStep<s.edgeIndices)return{header:c,vertexData:h,triangleIndices:d};const{westIndices:v,southIndices:g,eastIndices:m,northIndices:x,edgeIndicesEndPosition:_}=function(e,t,r){let n=r;const o=t.length/3>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,a=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;const s=i(e.buffer,n,a,o,!1);n+=a*o;const u=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;const l=i(e.buffer,n,u,o,!1);n+=u*o;const c=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;const f=i(e.buffer,n,c,o,!1);n+=c*o;const h=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;const p=i(e.buffer,n,h,o,!1);return{edgeIndicesEndPosition:n+=h*o,westIndices:s,southIndices:l,eastIndices:f,northIndices:p}}(l,h,y);if(r.maxDecodingStep<s.extensions)return{header:c,vertexData:h,triangleIndices:d,westIndices:v,northIndices:x,eastIndices:m,southIndices:g};const{extensions:E}=function(e,t){const r={};if(e.byteLength<=t)return{extensions:r,extensionsEndPosition:t};let n=t;for(;n<e.byteLength;){const t=e.getUint8(n,!0);n+=Uint8Array.BYTES_PER_ELEMENT;const i=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;const s=new DataView(e.buffer,n,i);switch(t){case 1:r.vertexNormals=(o=s,new Uint8Array(o.buffer,o.byteOffset,o.byteLength));break;case 2:r.waterMask=a(s);break;default:console.warn(`Unknown extension with id ${t}`)}n+=i}var o;return{extensions:r,extensionsEndPosition:n}}(l,_);return{header:c,vertexData:h,triangleIndices:d,westIndices:v,northIndices:x,eastIndices:m,southIndices:g,extensions:E}}r.d(t,"QUANTIZED_MESH_TILE_DECODER_ID",function(){return c}),r.d(t,"QuantizedMeshTileDecoder",function(){return f});const c="quantized-mesh-tile-decoder";class f{connect(){return Promise.resolve()}constructPositionArray(e){const t=e.length/3,r=new Float32Array(e.length);for(let n=0;n<t;n++)r[3*n]=e[n]/32767,r[3*n+1]=e[n+t]/32767,r[3*n+2]=e[n+2*t]/32767;return r}constructUvArray(e){return e.filter((e,t)=>t%3<2)}decodeTile(e){const t=l(e),r=this.constructPositionArray(t.vertexData),n=this.constructUvArray(r),o=[];o.push({name:"position",type:"float",buffer:r,itemCount:3,metadata:t.header},{name:"uv",type:"float",buffer:n,itemCount:2}),Object.keys(t.extensions).forEach(e=>{if("vertexNormals"===e&&t.extensions[e].byteLength>0){let r=new Uint8Array(t.extensions[e]);o.push({name:"octNormal",type:"float",buffer:r,itemCount:2})}});const i={techniques:[],geometries:[{index:{name:"index",type:"uint16",buffer:t.triangleIndices,itemCount:1},vertexAttributes:o}]};return Promise.resolve(i)}}},function(e,t,r){importScripts("three/build/three.js"),r(27)},function(e,t,r){const{WorkerServiceManager:n,TileDecoderService:o}=r(28),{QUANTIZED_MESH_TILE_DECODER_ID:i}=r(25),{QuantizedMeshTileDecoder:a}=r(25);n.getInstance().register({serviceType:i,factory:e=>o.start(e,new a)})},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(29)),n(r(58)),n(r(59)),n(r(9)),n(r(60))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(){}return e.prototype.dispose=function(){},e.prototype.decodeTile=function(e,t,r,n){return void 0===this.m_styleSetEvaluator?Promise.reject(new Error("No style is defined")):this.decodeThemedTile(e,t,this.m_styleSetEvaluator,r,n)},e.prototype.getTileInfo=function(e,t,r,n){return Promise.resolve(void 0)},e.prototype.configure=function(e,t,r){void 0!==e&&(this.m_styleSetEvaluator=new n.StyleSetEvaluator(e)),void 0!==t&&(this.languages=t)},e}();t.ThemedTileDecoder=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoCoordinatesLike=function(e){return e&&"number"==typeof e.latitude&&"number"==typeof e.longitude&&("number"==typeof e.altitude||void 0===e.altitude)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(0),i=r(4),a=Math.PI/180,s=function(){function e(){}return e.prototype.getScaleFactor=function(e){return 1},e.prototype.worldExtent=function(e,t,r){return r||(r=i.MathUtils.newEmptyBox3()),r.min.x=-Math.PI,r.min.y=.5*-Math.PI,r.min.z=e,r.max.x=Math.PI,r.max.y=.5*Math.PI,r.max.z=t,r},e.prototype.projectPoint=function(e,t){return t||(t={x:0,y:0,z:0}),t.x=e.longitude*a,t.y=e.latitude*a,t.z=e.altitude||0,t},e.prototype.unprojectPoint=function(e){return o.GeoCoordinates.fromRadians(e.y,e.x,e.z)},e.prototype.projectBox=function(e,t){return t||(t=i.MathUtils.newEmptyBox3()),this.projectPoint(new o.GeoCoordinates(e.south,e.west,e.minAltitude),t.min),this.projectPoint(new o.GeoCoordinates(e.north,e.east,e.maxAltitude),t.max),t},e.prototype.unprojectBox=function(e){var t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,r)},e}();t.identityProjection=new s},function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(){function e(e){this.tilingScheme=e}return e.prototype.visit=function(e){this.visitTileKey(o.TileKey.fromRowColumnLevel(0,0,0),e)},e.prototype.visitTileKey=function(e,t){var r,o;if(t(e,this.tilingScheme.getGeoBox(e)))try{for(var i=n(this.tilingScheme.getSubTileKeys(e)),a=i.next();!a.done;a=i.next()){var s=a.value;this.visitTileKey(s,t)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},e}();t.QuadTree=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(15),o=r(18),i=r(7);t.hereTilingScheme=new i.TilingScheme(o.halfQuadTreeSubdivisionScheme,n.equirectangularProjection)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16),o=r(12),i=r(7);t.webMercatorTilingScheme=new i.TilingScheme(o.quadTreeSubdivisionScheme,n.webMercatorProjection)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),o=r(12),i=r(7);t.mercatorTilingScheme=new i.TilingScheme(o.quadTreeSubdivisionScheme,n.mercatorProjection)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVector3Like=function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var s=r(1),u=r(14),l=r(8),c=s.LoggerManager.instance.create("Theme"),f=function(){function e(){}return e.prototype.lookup=function(e){},e.prototype.unmap=function(){return{}},e}();t.Env=f;var h=function(e){function t(t,r,n){var o=e.call(this)||this;return o.name=t,o.value=r,o.parent=n,o}return o(t,e),t.prototype.lookup=function(e){return e===this.name?this.value:this.parent?this.parent.lookup(e):void 0},t.prototype.unmap=function(){var e=this.parent?this.parent.unmap():{};return e[this.name]=this.value,e},t}(f);t.Bind=h,t.EmptyEnv={lookup:function(e){},unmap:function(){return{}}};var p=function(e){function t(t,r){var n=e.call(this)||this;return n.entries=t,n.parent=r,n}return o(t,e),t.prototype.lookup=function(e){var t=this.entries[e];return void 0!==t?t:this.parent?this.parent.lookup(e):void 0},t.prototype.unmap=function(){var e=this.parent?this.parent.unmap():{};for(var t in this.entries)this.entries.hasOwnProperty(t)&&(e[t]=this.entries[t]);return e},t}(f);t.MapEnv=p;var d=function(){function e(e){this.kind=e}return e.parse=function(e){return new C(e).parse()},e}();t.Expr=d;var y,v,g=function(e){function t(t){var r=e.call(this,"var")||this;return r.name=t,r}return o(t,e),t.prototype.evaluate=function(e){return e.lookup(this.name)},t}(d),m=function(e){function t(t){var r=e.call(this,"number")||this;return r.value=t,r}return o(t,e),t.prototype.evaluate=function(){return this.value},t}(d),x=function(e){function t(t){var r=e.call(this,"string")||this;return r.value=t,r}return o(t,e),t.prototype.evaluate=function(){return this.value},t}(d),_=function(e){function t(t){var r=e.call(this,"has")||this;return r.attribute=t,r}return o(t,e),t.prototype.evaluate=function(e){return void 0!==e.lookup(this.attribute)},t}(d),E=function(e){function t(t,r){var n=e.call(this,"in")||this;return n.value=t,n.elements=r,n}return o(t,e),t.prototype.evaluate=function(e){var t,r,n=this.value.evaluate(e);try{for(var o=i(this.elements),a=o.next();!a.done;a=o.next()){if(n===a.value.evaluate(e))return!0}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return!1},t}(d),b=function(e){function t(t){var r=e.call(this,"!")||this;return r.expr=t,r}return o(t,e),t.prototype.evaluate=function(e){return!this.expr.evaluate(e)},t}(d),w=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.op=t,o.left=r,o.right=n,o}return o(t,e),t.prototype.evaluate=function(e){var t=this.left.evaluate(e),r=this.right.evaluate(e);switch(this.op){case"~=":return"string"==typeof t&&"string"==typeof r&&-1!==t.indexOf(r);case"^=":return"string"==typeof t&&"string"==typeof r&&t.startsWith(r);case"$=":return"string"==typeof t&&"string"==typeof r&&t.endsWith(r);case"==":return t===r;case"!=":return t!==r;case"<":return void 0!==t&&void 0!==r?t<r:void 0;case">":return void 0!==t&&void 0!==r?t>r:void 0;case"<=":return void 0!==t&&void 0!==r?t<=r:void 0;case">=":return void 0!==t&&void 0!==r?t>=r:void 0}throw new Error("invalid relational op "+this.op)},t}(d),P=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.op=t,o.left=r,o.right=n,o}return o(t,e),t.prototype.evaluate=function(e){var t=this.left.evaluate(e);switch(this.op){case"||":return t||this.right.evaluate(e);case"&&":return t&&this.right.evaluate(e)}throw new Error("invalid logical op "+this.op)},t}(d);function M(e){switch(e){case y.Tab:case y.Lf:case y.Cr:case y.Space:return!0;default:return!1}}function I(e){return e>=y._0&&e<=y._9}function S(e){return e>=y.a&&e<=y.z||e>=y.A&&e<=y.Z}function T(e){return function(e){return S(e)||I(e)}(e)||e===y._||e===y.Dollar||e===y.Dot||e===y.LBracket||e===y.RBracket}function R(e){switch(e){case v.Eof:return"eof";case v.Error:return"error";case v.Identifier:return"identifier";case v.Number:return"number";case v.String:return"string";case v.Comma:return",";case v.LParen:return"(";case v.RParen:return")";case v.LBracket:return"[";case v.RBracket:return"]";case v.Exclaim:return"!";case v.TildeEqual:return"~=";case v.CaretEqual:return"^=";case v.DollarEqual:return"$=";case v.EqualEqual:return"==";case v.ExclaimEqual:return"!=";case v.Less:return"<";case v.Greater:return">";case v.LessEqual:return"<=";case v.GreaterEqual:return">=";case v.BarBar:return"||";case v.AmpAmp:return"&&";default:throw new Error("invalid token "+e)}}!function(e){e[e.Tab=9]="Tab",e[e.Lf=10]="Lf",e[e.Cr=13]="Cr",e[e.Space=32]="Space",e[e.LParen=40]="LParen",e[e.RParen=41]="RParen",e[e.Comma=44]="Comma",e[e.Dot=46]="Dot",e[e.LBracket=91]="LBracket",e[e.Backslash=92]="Backslash",e[e.RBracket=93]="RBracket",e[e._0=48]="_0",e[e._9=57]="_9",e[e._=95]="_",e[e.A=64]="A",e[e.Z=90]="Z",e[e.a=97]="a",e[e.z=122]="z",e[e.DoubleQuote=34]="DoubleQuote",e[e.SingleQuote=39]="SingleQuote",e[e.Exclaim=33]="Exclaim",e[e.Equal=61]="Equal",e[e.Caret=94]="Caret",e[e.Tilde=126]="Tilde",e[e.Dollar=36]="Dollar",e[e.Less=60]="Less",e[e.Greater=62]="Greater",e[e.Bar=124]="Bar",e[e.Amp=38]="Amp"}(y||(y={})),function(e){e[e.Eof=0]="Eof",e[e.Error=1]="Error",e[e.Identifier=2]="Identifier",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Comma=5]="Comma",e[e.LParen=6]="LParen",e[e.RParen=7]="RParen",e[e.LBracket=8]="LBracket",e[e.RBracket=9]="RBracket",e[e.Exclaim=10]="Exclaim",e[e.TildeEqual=11]="TildeEqual",e[e.CaretEqual=12]="CaretEqual",e[e.DollarEqual=13]="DollarEqual",e[e.EqualEqual=14]="EqualEqual",e[e.ExclaimEqual=15]="ExclaimEqual",e[e.Less=16]="Less",e[e.Greater=17]="Greater",e[e.LessEqual=18]="LessEqual",e[e.GreaterEqual=19]="GreaterEqual",e[e.BarBar=20]="BarBar",e[e.AmpAmp=21]="AmpAmp"}(v||(v={}));var L=function(){function e(e){this.code=e,this.m_token=v.Error,this.m_index=0,this.m_char=y.Lf}return e.prototype.token=function(){return this.m_token},e.prototype.text=function(){return this.m_text||""},e.prototype.next=function(){if(this.m_token=this.yylex(),this.m_token===v.Error)throw new Error("unexpected character "+this.m_char);return this.m_token},e.prototype.yyinp=function(){this.m_char=this.code.codePointAt(this.m_index++)||0},e.prototype.yylex=function(){for(this.m_text=void 0;M(this.m_char);)this.yyinp();if(0===this.m_char)return v.Eof;var e=this.m_char;switch(this.yyinp(),e){case y.LParen:return v.LParen;case y.RParen:return v.RParen;case y.LBracket:return v.LBracket;case y.RBracket:return v.RBracket;case y.Comma:return v.Comma;case y.SingleQuote:case y.DoubleQuote:for(var t=this.m_index-1;this.m_char&&this.m_char!==e;)this.yyinp();if(this.m_char!==e)throw new Error("Unfinished string literal");return this.yyinp(),this.m_text=this.code.substring(t,this.m_index-2),v.String;case y.Exclaim:return this.m_char===y.Equal?(this.yyinp(),v.ExclaimEqual):v.Exclaim;case y.Caret:return this.m_char===y.Equal?(this.yyinp(),v.CaretEqual):v.Error;case y.Tilde:return this.m_char===y.Equal?(this.yyinp(),v.TildeEqual):v.Error;case y.Equal:return this.m_char===y.Equal?(this.yyinp(),v.EqualEqual):v.Error;case y.Less:return this.m_char===y.Equal?(this.yyinp(),v.LessEqual):v.Less;case y.Greater:return this.m_char===y.Equal?(this.yyinp(),v.GreaterEqual):v.Greater;case y.Bar:return this.m_char===y.Bar?(this.yyinp(),v.BarBar):v.Error;case y.Amp:return this.m_char===y.Amp?(this.yyinp(),v.AmpAmp):v.Error;default:t=this.m_index-2;if(S(e)||e===y._||e===y.Dollar&&T(this.m_char)){for(;T(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),v.Identifier}if(I(e)){for(;I(this.m_char);)this.yyinp();if(this.m_char===y.Dot)for(this.yyinp();I(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),v.Number}if(e===y.Dollar)return this.m_char===y.Equal?(this.yyinp(),v.DollarEqual):v.Error}return v.Error},e}();function O(e){switch(e){case v.TildeEqual:return"~=";case v.CaretEqual:return"^=";case v.DollarEqual:return"$=";case v.EqualEqual:return"==";case v.ExclaimEqual:return"!=";default:return}}function A(e){switch(e){case v.Less:return"<";case v.Greater:return">";case v.LessEqual:return"<=";case v.GreaterEqual:return">=";default:return}}var C=function(){function e(e){this.lex=new L(e),this.lex.next()}return e.prototype.parse=function(){return this.parseLogicalOr()},e.prototype.yyexpect=function(e){if(this.lex.token()!==e)throw new Error("Syntax error: Expected token '"+R(e)+"' but found '"+R(this.lex.token())+"'");this.lex.next()},e.prototype.parsePrimary=function(){switch(this.lex.token()){case v.Identifier:var e=this.lex.text();if("has"!==e){var t=new g(e);return this.lex.next(),t}this.lex.next(),this.yyexpect(v.LParen);var r=this.lex.text();return this.yyexpect(v.Identifier),this.yyexpect(v.RParen),new _(r);case v.Number:t=new m(parseFloat(this.lex.text()));return this.lex.next(),t;case v.String:t=new x(this.lex.text());return this.lex.next(),t;case v.LParen:this.lex.next();t=this.parseLogicalOr();return this.yyexpect(v.RParen),t}throw new Error("Syntax error")},e.prototype.parseUnary=function(){return this.lex.token()===v.Exclaim?(this.lex.next(),new b(this.parseUnary())):this.parsePrimary()},e.prototype.parseRelational=function(){for(var e=this.parseUnary();;)if(this.lex.token()===v.Identifier&&"in"===this.lex.text()){this.lex.next(),this.yyexpect(v.LBracket);for(var t=[this.parsePrimary()];this.lex.token()===v.Comma;)this.lex.next(),t.push(this.parsePrimary());this.yyexpect(v.RBracket),e=new E(e,t)}else{var r=A(this.lex.token());if(void 0===r)break;this.lex.next();var n=this.parseUnary();e=new w(r,e,n)}return e},e.prototype.parseEquality=function(){for(var e=this.parseRelational();;){var t=O(this.lex.token());if(void 0===t)break;this.lex.next();var r=this.parseRelational();e=new w(t,e,r)}return e},e.prototype.parseLogicalAnd=function(){for(var e=this.parseEquality();this.lex.token()===v.AmpAmp;){this.lex.next();var t=this.parseEquality();e=new P("&&",e,t)}return e},e.prototype.parseLogicalOr=function(){for(var e=this.parseLogicalAnd();this.lex.token()===v.BarBar;){this.lex.next();var t=this.parseLogicalAnd();e=new P("||",e,t)}return e},e}();function j(e){!function(e){for(var t,r=function(r){e.zoomLevels.findIndex(function(t){return t===e.zoomLevels[r]})!==r&&(e.zoomLevels.splice(--r,1),e.values.splice(--r,1)),t=r},n=0;n<e.values.length;++n)r(n),n=t}(e);var t,r=new Float32Array(e.zoomLevels);switch(typeof e.values[0]){default:case"number":return t=new Float32Array(e.values),{interpolationMode:void 0!==e.interpolation?u.InterpolationMode[e.interpolation]:u.InterpolationMode.Discrete,zoomLevels:r,values:t};case"boolean":t=new Float32Array(e.values.length);for(var n=0;n<e.values.length;++n)t[n]=e.values[n]?1:0;return{interpolationMode:u.InterpolationMode.Discrete,zoomLevels:r,values:t};case"string":t=new Float32Array(3*e.values.length);for(n=0;n<e.values.length;++n)for(var o=+e.values[n].replace("#","0x"),i=[(o>>16&255)/255,(o>>8&255)/255,(o>>0&255)/255],a=0;a<3*e.values.length;++a)t[3*n+a]=i[a];return{interpolationMode:void 0!==e.interpolation?u.InterpolationMode[e.interpolation]:u.InterpolationMode.Discrete,zoomLevels:r,values:t}}}t.createLight=function(e){switch(e.type){case"ambient":return(t=new l.AmbientLight(e.color,e.intensity)).name=e.name,t;case"directional":var t;return(t=new l.DirectionalLight(e.color,e.intensity)).name=e.name,void 0!==e.castShadow&&(t.castShadow=e.castShadow),t.position.set(e.direction.x,e.direction.y,e.direction.z),t.position.normalize(),t}};var q=function(){function e(e,t){var r,n,o=this;this.styleSet=e,this.validate=t,this.m_renderOrderBiasGroups=new Map,this.m_techniques=new Array;var s=0,u=function(e){var t,r;if(void 0!==e.renderOrderBiasGroup){var n=e.renderOrderBiasGroup?o.m_renderOrderBiasGroups.get(e.renderOrderBiasGroup):void 0;if(void 0!==e.renderOrderBiasRange&&void 0===n){void 0!==e.renderOrder&&c.warn("WARN: style.renderOrder will be overridden if renderOrderBiasGroup is set:",e);var l=a(e.renderOrderBiasRange,2),f=l[0],h=l[1];e.renderOrder=f<0?s+Math.abs(f):s,s+=Math.abs(f)+h,e.renderOrderBiasGroup&&o.m_renderOrderBiasGroups.set(e.renderOrderBiasGroup,e.renderOrder),s++}else n&&(void 0!==e.renderOrder&&c.warn("WARN: style.renderOrder will be overridden if renderOrderBiasGroup is set:",e),e.renderOrder=n)}if(void 0!==e.styles){o.validate&&(Array.isArray(e.styles)||c.error("ERROR: style.styles must be an Array:",e));try{for(var p=i(e.styles),d=p.next();!d.done;d=p.next()){var y=d.value;u(y)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=p.return)&&r.call(p)}finally{if(t)throw t.error}}}else void 0!==e.technique&&void 0!==e.attr&&void 0===e.attr.renderOrder&&(e.attr._renderOrderAuto=s++)};try{for(var l=i(e),f=l.next();!f.done;f=l.next()){var h=f.value;u(h)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}return e.prototype.getMatchingTechniques=function(e){var t,r,n=[],o=new Array;try{for(var a=i(this.styleSet),s=a.next();!s.done;s=a.next()){var u=s.value;if(this.validate&&0!==o.length)throw new Error("Internal error: style stack cleanup failed");if(this.processStyle(e,o,u,n))break}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return n},e.prototype.checkAddTechnique=function(e,t){var r=void 0===e._index?-1:e._index;return r<0?(t._index=r=this.m_techniques.length,this.m_techniques.push(t),e._index=r):t._index=r,r},Object.defineProperty(e.prototype,"techniques",{get:function(){return this.m_techniques},enumerable:!0,configurable:!0}),e.prototype.cleanupStyle=function(e,t){return"styles"===e?"[...]":e.startsWith("_")?void 0:t},e.prototype.processStyle=function(e,t,r,n){var o,a,s,u,l=this;if(void 0!==r.when&&(void 0===r._whenExpr&&(r._whenExpr=d.parse(r.when)),!r._whenExpr.evaluate(e)))return!1;if(void 0!==r.styles){if(r.debug&&c.log("\n======== style group =========\nenv:",JSON.stringify(e.unmap(),void 0,2),"\nstyle group:",JSON.stringify(r,this.cleanupStyle,2)),t.push(r),this.validate&&!Array.isArray(r.styles))return c.error("ERROR: style.styles must be an Array:",r),t.pop(),!1;try{for(var f=i(r.styles),h=f.next();!h.done;h=f.next()){var p=h.value;if(this.processStyle(e,t,p,n))return t.pop(),!0}}catch(e){o={error:e}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}t.pop()}else{if(void 0!==r.technique){if(void 0===r._index){var y={};y.name=r.technique;var v=function(e){void 0!==e.renderOrder&&(y.renderOrder=e.renderOrder),void 0!==e.transient&&(y.transient=e.transient),void 0!==e.renderOrderBiasProperty&&(y.renderOrderBiasProperty=e.renderOrderBiasProperty),void 0!==e.labelProperty&&(y.label=e.labelProperty),void 0!==e.renderOrderBiasRange&&(y.renderOrderBiasRange=e.renderOrderBiasRange),void 0!==e.renderOrderBiasGroup&&(y.renderOrderBiasGroup=e.renderOrderBiasGroup),void 0!==e.attr&&Object.getOwnPropertyNames(e.attr).forEach(function(t){if(l.validate&&("technique"===t?c.warn("WARNING: technique defined in attr (deprecated):",e):"renderOrder"===t&&c.warn("WARNING: renderOrder defined in attr (deprecated):",e)),void 0!==e.attr){var r=e.attr[t];if((n=r).values instanceof Array&&n.values.length>0&&void 0!==n.values[0]&&n.zoomLevels instanceof Array&&n.zoomLevels.length>0&&void 0!==n.zoomLevels[0]&&n.values.length===n.zoomLevels.length)switch(typeof r.values[0]){default:case"number":case"boolean":case"string":y[t]=j(r)}else y[t]=r}var n})};try{for(var g=i(t),m=g.next();!m.done;m=g.next()){v(p=m.value)}}catch(e){s={error:e}}finally{try{m&&!m.done&&(u=g.return)&&u.call(g)}finally{if(s)throw s.error}}v(r),this.checkAddTechnique(r,y),n.push(y),r.debug&&c.log("\n======== style w/ technique =========\nenv:",JSON.stringify(e.unmap(),void 0,2),"\nstyle:",JSON.stringify(r,this.cleanupStyle,2),"\ntechnique:",JSON.stringify(y,this.cleanupStyle,2))}else n.push(this.m_techniques[r._index]);return!0===r.final}this.validate&&c.warn("WARNING: No technique defined in style. Either sub-styles or a technique must be defined:",JSON.stringify(r))}return!1},e}();t.StyleSetEvaluator=q;var B=function(){function e(e){this.theme=e}return e.prototype.visitStyles=function(e){var t,r,n=function(t){var r,o;if(e(t))return!0;if(void 0!==t.styles)try{for(var a=i(t.styles),s=a.next();!s.done;s=a.next()){var u=s.value;if(n(u))return!0}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return!1};if(void 0!==this.theme.styles)for(var o in this.theme.styles)if(void 0!==this.theme.styles[o])try{for(var a=i(this.theme.styles[o]),s=a.next();!s.done;s=a.next()){var u=s.value;if(n(u))return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return!1},e}();t.ThemeVisitor=B},function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){void 0===t&&(t=new Array),this.priority=e,this.elements=t}return e.prototype.clone=function(){return new e(this.priority,this.elements.slice())},e}();t.PriorityListGroup=o;var i=function(){function e(){this.groups=new Map}return e.prototype.add=function(e){this.getGroup(e.priority).elements.push(e)},e.prototype.remove=function(e){var t=this.getGroup(e.priority);if(void 0!==t){var r=t.elements.indexOf(e);if(r>=0){if(t.elements.splice(r,1),0===t.elements.length){var n=Math.floor(e.priority);this.groups.delete(n)}return!0}}return!1},e.prototype.clear=function(){this.groups.clear()},e.prototype.merge=function(e){var t,r;try{for(var o=n(e.groups),i=o.next();!i.done;i=o.next()){var a=i.value,s=this.findGroup(a[1].priority);void 0!==s?s.elements=s.elements.concat(a[1].elements):this.groups.set(Math.floor(a[1].priority),a[1].clone())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return this},Object.defineProperty(e.prototype,"sortedGroups",{get:function(){var e,t,r=[];try{for(var o=n(this.groups),i=o.next();!i.done;i=o.next()){var a=i.value;r.push(a[1])}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return r.sort(function(e,t){return t.priority-e.priority}),r},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){var t,r;try{for(var o=n(this.groups),i=o.next();!i.done;i=o.next()){i.value[1].elements.forEach(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.findGroup=function(e){var t=Math.floor(e);return this.groups.get(t)},e.prototype.getGroup=function(e){var t=this.findGroup(e);if(void 0===t){var r=Math.floor(e);t=new o(r),this.groups.set(r,t)}return t},e}();t.GroupedPriorityList=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(22)),n(r(13)),n(r(23)),n(r(40)),n(r(42)),n(r(24))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(41),o=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this.m_instance||(this.m_instance=new n.LoggerManagerImpl)},enumerable:!0,configurable:!0}),e}();t.LoggerManager=o},function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(22),i=r(23),a=r(24),s=function(){function e(){this.m_loggers=[],this.channel="undefined"==typeof self||void 0!==self.document?new o.ConsoleChannel:new a.WorkerChannel}return e.prototype.getLoggerNames=function(){return this.m_loggers.map(function(e){return e.name})},e.prototype.getLogger=function(e){return this.m_loggers.find(function(t){return t.name===e})},e.prototype.create=function(e,t){var r=new i.Logger(e,this.channel,t);return this.m_loggers.push(r),r},e.prototype.dispose=function(e){var t=this.m_loggers.indexOf(e);if(t<0)throw new Error('Cannot unregister "'+e+'" : no such logger registered.');this.m_loggers.splice(t,1)},e.prototype.updateAll=function(e){var t,r;try{for(var o=n(this.m_loggers),i=o.next();!i.done;i=o.next()){i.value.update(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.update=function(e,t){var r,o;try{for(var i=n(this.m_loggers),a=i.next();!a.done;a=i.next()){var s=a.value;s.name===e&&s.update(t)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},e.prototype.enableAll=function(e){var t,r;try{for(var o=n(this.m_loggers),i=o.next();!i.done;i=o.next()){i.value.enabled=e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.enable=function(e,t){this.update(e,{enabled:t})},e.prototype.setLogLevelForAll=function(e){var t,r;try{for(var o=n(this.m_loggers),i=o.next();!i.done;i=o.next()){i.value.level=e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.setLogLevel=function(e,t){this.update(e,{level:t})},e.prototype.setChannel=function(e){this.channel=e},e}();t.LoggerManagerImpl=s},function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.channels=[],this.channels=e}return e.prototype.error=function(e){for(var t,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];try{for(var s=n(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.error.apply(l,i([e],o))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},e.prototype.debug=function(e){for(var t,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];try{for(var s=n(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.debug.apply(l,i([e],o))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},e.prototype.info=function(e){for(var t,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];try{for(var s=n(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.info.apply(l,i([e],o))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},e.prototype.log=function(e){for(var t,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];try{for(var s=n(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.log.apply(l,i([e],o))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},e.prototype.trace=function(e){for(var t,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];try{for(var s=n(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.trace.apply(l,i([e],o))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},e.prototype.warn=function(e){for(var t,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];try{for(var s=n(this.channels),u=s.next();!u.done;u=s.next()){var l=u.value;l.warn.apply(l,i([e],o))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},e}();t.MultiChannel=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=e,this.y=t,this.w=r,this.h=n}return e.prototype.set=function(e,t,r,n){this.x=e,this.y=t,this.w=r,this.h=n},e.prototype.contains=function(e,t){return this.x<=e&&this.x+this.w>=e&&this.y<=t&&this.y+this.h>=t},e.prototype.intersects=function(e){return this.x<=e.x+e.w&&this.x+this.w>=e.x&&this.y<=e.y+e.h&&this.y+this.h>=e.y},e}();function r(e,t,r,n){return(e-r)*(e-r)+(t-n)*(t-n)}e.Box=t,e.distSquared=r,e.computeSquaredLineLength=function(e){for(var t=0,r=e.length-3,n=0;n<r;n+=2){var o=e[n+2]-e[n],i=e[n+3]-e[n+1];t+=o*o+i*i}return t},e.distToSegmentSquared=function(e,t,n,o,i,a){var s=r(n,o,i,a);if(0===s)return r(e,t,n,o);var u=((e-n)*(i-n)+(t-o)*(a-o))/s;return r(e,t,n+(u=Math.max(0,Math.min(1,u)))*(i-n),o+u*(a-o))}}(t.Math2D||(t.Math2D={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function t(e,t,r){return e<t?t:e>r?r:e}e.clamp=t,e.smoothStep=function(e,r,n){return(n=t((n-e)/(r-e),0,1))*n*(3-2*n)},e.smootherStep=function(e,r,n){return(n=t((n-e)/(r-e),0,1))*n*n*(n*(6*n-15)+10)},e.lerp=function(e,t,r,n,o){return(e-t)*(o-n)/(r-t)+n},e.min2=function(e,t){var r;return void 0!==e&&(r=e),void 0!==t&&(r=void 0===r?t:Math.min(r,t)),r},e.max2=function(e,t){var r;return void 0!==e&&(r=e),void 0!==t&&(r=void 0===r?t:Math.max(r,t)),r},e.isClamped=function(e,t,r){return!(void 0!==t&&e<t||void 0!==r&&e>r)}}(t.MathUtils||(t.MathUtils={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyMixins=function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(r){e.prototype[r]=t.prototype[r]})})},t.applyMixinsWithoutProperties=function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(r){var n=Object.getOwnPropertyDescriptor(t.prototype,r);void 0!==n&&void 0===n.get&&(e.prototype[r]=t.prototype[r])})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!0;t.assert=function(e,t){if(!n&&!e)throw new Error(void 0!==t?t:"ASSERTION failed")},t.assertExists=function(e,t){if(!n&&null==e)throw new Error(void 0!==t?t:"ASSERTION failed: Element is undefined or null");return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.now=function(){return e.nowFunc()},e.getNowFunc=function(){return"undefined"!=typeof performance&&void 0!==performance.now?function(){return performance.now()}:function(){return(new Date).getTime()}},e.instance=new e,e.nowFunc=e.getNowFunc(),e}();t.PerformanceTimer=n},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getOptionValue=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var i=o(r),a=i.next();!a.done;a=i.next()){var s=a.value;if(null!=s)return s}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.mergeWithOptions=function(e,t){var r=n({},e);if(null==t)return r;for(var o in e)if(e.hasOwnProperty(o)){var i=t[o];null!=i&&(r[o]=i)}return r}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultUrlResolver=function(e){return void 0!==n?n(e):e},t.setDefaultUrlResolver=function(e){n=e},t.composeUrlResolvers=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduce(function(e,t){return void 0!==t?t(e):e},t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveReferenceUrl=function(e,t){return n.test(t)?t:t.startsWith("/")?i(e)+t:(t.startsWith("./")&&(t=t.substr(2)),o(e)+t)};var n=new RegExp("^(?:[a-z]+:)?//","i");function o(e){if(void 0===e)return"./";var t=e.lastIndexOf("/");return-1===t?"./":e.substring(0,t+1)}function i(e){if(void 0===e)return"";var t=a(e);return"file:"===t.protocol?"file://":t.host&&t.protocol?t.protocol+"//"+t.host:t.host?"//"+t.host:t.protocol?t.protocol+"//":""}function a(e){var t=new RegExp(/^(?:([a-z]+:))?\/\/([^\/]*)/,"i"),r=e.match(t);if(!r)throw new Error("getUrlHostAndProtocol: unable to parse URL '"+e+"'");return{protocol:r[1],host:r[2]}}t.baseUrl=o,t.getUrlOrigin=i,t.getUrlHostAndProtocol=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t;e.WORKER_SERVICE_MANAGER_SERVICE_ID="worker-service-manager",function(e){e.Initialized="initialized",e.Request="request",e.Response="response"}(t=e.ServiceMessageName||(e.ServiceMessageName={})),e.isInitializedMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Initialized},function(e){e.CreateService="create-service",e.DestroyService="destroy-service"}(e.Requests||(e.Requests={})),e.isRequestMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Request},e.isResponseMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Response}}(t.WorkerServiceProtocol||(t.WorkerServiceProtocol={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t;!function(e){e.RegisterIndex="register-index",e.TileRequest="tile-request"}(t=e.Requests||(e.Requests={})),e.isRegisterIndexRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.RegisterIndex},e.isTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.TileRequest}}(t.WorkerTilerProtocol||(t.WorkerTilerProtocol={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=new AbortController),this.priority=e,this.abortController=t}return Object.defineProperty(e.prototype,"signal",{get:function(){return this.abortController.signal},enumerable:!0,configurable:!0}),e.prototype.abort=function(){this.abortController.abort()},e}();t.RequestController=n,function(e){var t,r;!function(e){e.Configuration="configuration"}(t=e.DecoderMessageName||(e.DecoderMessageName={})),e.isConfigurationMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Configuration},function(e){e.DecodeTileRequest="decode-tile-request",e.TileInfoRequest="tile-info-request"}(r=e.Requests||(e.Requests={})),e.isDecodeTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===r.DecodeTileRequest},e.isTileInfoRequest=function(e){return e&&"string"==typeof e.type&&e.type===r.TileInfoRequest}}(t.WorkerDecoderProtocol||(t.WorkerDecoderProtocol={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.getArrayConstructor=function(e){switch(e){case"float":return Float32Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array}},function(e){e[e.Unspecified=0]="Unspecified",e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.SolidLine=3]="SolidLine",e[e.Text=4]="Text",e[e.TextPath=5]="TextPath",e[e.ExtrudedLine=6]="ExtrudedLine",e[e.Polygon=7]="Polygon",e[e.ExtrudedPolygon=8]="ExtrudedPolygon",e[e.Object3D=9]="Object3D",e[e.Other=1e3]="Other"}(t.GeometryType||(t.GeometryType={})),t.getProjection=function(e){switch(e){case"mercator":return n.mercatorProjection;case"webMercator":return n.webMercatorProjection;default:throw new Error("Unknown projection "+e)}},t.getProjectionName=function(e){if(e===n.mercatorProjection)return"mercator";if(e===n.webMercatorProjection)return"webMercator";throw new Error("Unknown projection")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8);new n.Vector2,new n.Vector2,new n.Vector2,new n.Vector2;t.addExtrudedWalls=function(e,t,r,n,o){for(var i=0;i<r.length;i+=2){var a=t+i,s=t+i+1,u=t+(i+2)%r.length,l=t+(i+3)%r.length;(void 0===n||n[i/2]||!n[i/2]&&!1!==o)&&e.push(a,s,l,l,u,a)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),o=new n.Vector2,i=new n.Vector2,a=new n.Vector2,s=new n.Vector2;t.addPolygonEdges=function(e,t,r,n,u,l,c){for(var f=0;f<r.length;f+=2){var h=f/2;if(n[h])if(!0===u){var p=t+f,d=t+f+1,y=t+(f+2)%r.length,v=t+(f+3)%r.length;!0===l&&e.push(p,y),e.push(d,v);var g=(0===f?r.length:f)-2;if(n[g/2])if(void 0!==c){var m=r[f],x=r[f+1],_=r[(f+2)%r.length],E=r[(f+3)%r.length];o.set(m,x),i.set(_,E),a.set(r[g],r[g+1]),s.set(o.x,o.y),s.sub(a).normalize().dot(i.sub(o).normalize())<=c&&e.push(p,d)}else e.push(p,d)}else{var b=t+h;d=t+(h+1)%n.length,e.push(b,d)}}}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),s=function(){return function(e,t){void 0===t&&(t=5e3),this.featureIds=new Array,this.numFeatures=0,this.numPositions=0,this.featureIds=new Array(t),this.featureIds.length=t,this.techniqueIndex=new Array(t),this.techniqueIndex.length=t,this.textIndex=new Array(t),this.textIndex.length=t,this.positionIndex=new Array(t),this.positionIndex.length=t,this.positions=new Array(10*t),this.positions.length=10*t,e&&(this.layerIndex=new Array(t),this.layerIndex.length=t,this.classIndex=new Array(t),this.classIndex.length=t,this.typeIndex=new Array(t),this.typeIndex.length=t)}}();t.FeatureGroup=s;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userData=[],t}return o(t,e),t}(s);t.LineFeatureGroup=u;var l=function(e){function t(t,r){void 0===r&&(r=5e3);var n=e.call(this,t,r)||this;return n.groupNumRings=0,n.outerRingStartIndex=new Array(r),n.outerRingStartIndex.length=r,n.innerRingIsOuterContour=new Array(r),n.innerRingIsOuterContour.length=r,n.innerRingStartIndex=new Array(r),n.innerRingStartIndex.length=r,n}return o(t,e),t}(s);t.PolygonFeatureGroup=l;var c=function(){return function(e,t){this.tileKey=e,this.textCatalog=new Array,this.techniqueCatalog=new Array,this.setupTime=0,this.pointGroup=new s(t),this.lineGroup=new u(t),this.polygonGroup=new l(t),t&&(this.layerCatalog=new Array,this.classCatalog=new Array,this.typeCatalog=new Array)}}();t.ExtendedTileInfo=c,function(e){function t(e){e.featureIds.length=e.numFeatures,e.techniqueIndex.length=e.numFeatures,e.textIndex.length=e.numFeatures,e.positionIndex.length=e.numFeatures,e.positions.length=e.numPositions,void 0!==e.layerIndex&&(e.layerIndex.length=e.numFeatures),void 0!==e.classIndex&&(e.classIndex.length=e.numFeatures),void 0!==e.typeIndex&&(e.typeIndex.length=e.numFeatures)}function r(e){return e.numPositions===e.positions.length}e.finish=function(e){var r,n;t(e.pointGroup),t(r=e.lineGroup),void 0!==r.segmentIds&&(r.segmentIds.length=r.numFeatures,r.segmentStartOffsets.length=r.numFeatures,r.segmentEndOffsets.length=r.numFeatures),t(n=e.polygonGroup),n.outerRingStartIndex.length=n.numFeatures,n.innerRingIsOuterContour.length=n.groupNumRings,n.innerRingStartIndex.length=n.groupNumRings},e.featureGroupSize=function(e){return e.numFeatures},e.featureGroupFinished=r,e.tileInfoFinished=function(e){return r(e.pointGroup)&&r(e.lineGroup)&&r(e.polygonGroup)},e.getFeatureName=function(e,t,r,n){var o,a,s;if(t){var u=e.lookup("name:short");if("string"==typeof u&&u.length>0)return u}if(r){var l=e.lookup("iso_code");if("string"==typeof l&&l.length>0)return l}if(void 0!==n)try{for(var c=i(n),f=c.next();!f.done;f=c.next()){var h=f.value;if("string"==typeof(s=e.lookup("name:"+h)||e.lookup("name_"+h))&&s.length>0)return s}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}if("string"==typeof(s=e.lookup("name")))return s}}(c=t.ExtendedTileInfo||(t.ExtendedTileInfo={})),t.ExtendedTileInfo=c;var f=function(){function e(e,t,r){this.tileInfo=e,this.storeExtendedTags=t,this.languages=r,this.techniqueIndexMap=new Map,this.stringMap=new Map,this.layerMap=new Map,this.classMap=new Map,this.typeMap=new Map}return e.prototype.addTechnique=function(e){if(void 0===e._index)throw new Error("ExtendedTileInfoEmitter#processPointFeature: Internal error - No technique index");var t=this.techniqueIndexMap.get(e._index);if(void 0!==t)return t;t=this.tileInfo.techniqueCatalog.length;var r={};return Object.getOwnPropertyNames(e).forEach(function(t){t.startsWith("_")||(r[t]=e[t])}),r._index=e._index,this.techniqueIndexMap.set(e._index,t),this.tileInfo.techniqueCatalog.push(r),t},e.prototype.addFeature=function(e,t,r,n,o,i){var s=t,u=s.label,l=s.useAbbreviation,f=s.useIsoCode,h="string"==typeof u?r.lookup(u):c.getFeatureName(r,l,f,this.languages),p=-1;if(h&&"string"==typeof h&&(p=this.addText(h)),e.featureIds[e.numFeatures]=n,e.techniqueIndex[e.numFeatures]=o,e.textIndex[e.numFeatures]=p,e.positionIndex[e.numFeatures]=e.numPositions,i){var d=e;a.assert(void 0!==d.outerRingStartIndex),a.assert(void 0!==d.innerRingStartIndex),a.assert(void 0!==d.innerRingIsOuterContour),d.outerRingStartIndex[e.numFeatures]=d.groupNumRings}this.storeExtendedTags&&(e.layerIndex[e.numFeatures]=this.addLayer(r.lookup("$layer")),e.classIndex[e.numFeatures]=this.addClass(r.lookup("class")),e.typeIndex[e.numFeatures]=this.addType(r.lookup("type"))),e.numFeatures++},e.prototype.addFeaturePoint=function(e,t,r){e.positions[e.numPositions++]=t,e.positions[e.numPositions++]=r},e.prototype.addFeaturePoints=function(e,t){for(var r=e.numPositions,n=t.length,o=e.positions,i=0;i<n;i++)o[r+i]=t[i];e.numPositions+=t.length},e.prototype.addRoadSegments=function(e,t,r,n){void 0===e.segmentIds&&(e.segmentIds=new Array,e.segmentStartOffsets=new Array,e.segmentEndOffsets=new Array),e.segmentIds[e.numFeatures-1]=t,e.segmentStartOffsets[e.numFeatures-1]=r,e.segmentEndOffsets[e.numFeatures-1]=n},e.prototype.addRingPoints=function(e,t,r){e.innerRingStartIndex[e.groupNumRings]=e.numPositions,e.innerRingIsOuterContour[e.groupNumRings]=r?1:0,e.groupNumRings++;for(var n=e.numPositions,o=t.length,i=e.positions,a=0;a<o;a++)i[n+a]=t[a];e.numPositions+=t.length},e.prototype.finish=function(){c.finish(this.tileInfo)},e.prototype.addText=function(e){return this.addStringValue(e,this.tileInfo.textCatalog,this.stringMap)},e.prototype.addLayer=function(e){return this.addStringValue(e,this.tileInfo.layerCatalog,this.layerMap)},e.prototype.addClass=function(e){return this.addStringValue(e,this.tileInfo.classCatalog,this.classMap)},e.prototype.addType=function(e){return this.addStringValue(e,this.tileInfo.typeCatalog,this.typeMap)},e.prototype.addStringValue=function(e,t,r){if(void 0===e)return-1;var n=e.toString(),o=r.get(n);return void 0!==o?o:(o=t.length,t.push(n),r.set(n,o),o)},e}();t.ExtendedTileInfoWriter=f;var h=function(){function e(){this.featureIndex=0,this.ringStart=0,this.numRings=0}return e.prototype.setup=function(e,t,r,n){this.polygons=e,this.featureIndex=t,this.ringStart=r,this.numRings=n},e.prototype.reset=function(){this.polygons=void 0,this.featureIndex=0,this.ringStart=0,this.numRings=0},e.prototype.isOuterRing=function(e){if(a.assert(e>=0),a.assert(e<this.numRings),a.assert(void 0!==this.polygons),e<0||e>=this.numRings||void 0===this.polygons)throw new Error("ExtendedTileInfoPolygonAccessor: Invalid ring index");return 0!==this.polygons.innerRingIsOuterContour[this.ringStart+e]},e.prototype.getPoints=function(e){if(a.assert(e>=0),a.assert(e<this.numRings),a.assert(void 0!==this.polygons),e<0||e>=this.numRings||void 0===this.polygons)throw new Error("ExtendedTileInfoPolygonAccessor: Invalid ring index");var t,r=this.polygons.innerRingStartIndex[this.ringStart+e];return t=e<this.numRings-1?this.polygons.innerRingStartIndex[this.ringStart+e+1]-r:this.ringStart+e<this.polygons.innerRingStartIndex.length-1?this.polygons.innerRingStartIndex[this.ringStart+e+1]-r:this.polygons.positions.length-r,{points:this.polygons.positions,pointsStart:r,numPointValues:t}},e}(),p=function(){function e(e){this.tileInfo=e}return e.prototype.visitAll=function(e){this.visitAllPointFeatures(e),this.visitAllLineFeatures(e),this.visitAllPolygonFeatures(e)},e.prototype.visitFeature=function(e,t){for(var r=0,n=this.tileInfo.pointGroup.numFeatures,o=this.tileInfo.pointGroup.featureIds,i=0;i<n;i++)o[i]===e&&(r++,this.visitPointFeature(i,t));var a=this.tileInfo.lineGroup.numFeatures,s=this.tileInfo.lineGroup.featureIds;for(i=0;i<a;i++)s[i]===e&&(r++,this.visitLineFeature(i,t));var u=this.tileInfo.polygonGroup.numFeatures,l=this.tileInfo.polygonGroup.featureIds;for(i=0;i<u;i++)l[i]===e&&(r++,this.visitPolygonFeature(i,t));return r},e.prototype.visitAllPointFeatures=function(e){for(var t=this.tileInfo.pointGroup.numFeatures,r=0;r<t;r++)this.visitPointFeature(r,e)},e.prototype.visitAllLineFeatures=function(e){for(var t=this.tileInfo.lineGroup.numFeatures,r=0;r<t;r++)this.visitLineFeature(r,e)},e.prototype.visitAllPolygonFeatures=function(e){for(var t=this.tileInfo.polygonGroup.numFeatures,r=0;r<t;r++)this.visitPolygonFeature(r,e)},e.prototype.getTag=function(e,t){return void 0!==t&&t[e]>=0?t[e]:-1},e.prototype.visitPointFeature=function(e,t){var r=this.tileInfo.pointGroup,n=r.positionIndex[e],o=r.positions[n],i=r.positions[n+1];t.acceptPoint&&t.acceptPoint(r.featureIds[e],r.techniqueIndex[e],o,i,r.textIndex[e],this.getTag(e,r.layerIndex),this.getTag(e,r.classIndex),this.getTag(e,r.typeIndex))},e.prototype.visitLineFeature=function(e,t){var r,n,o,i=this.tileInfo,a=i.lineGroup,s=a.numFeatures,u=a.positionIndex[e],l=e===s-1?a.positions.length-u:a.positionIndex[e+1]-u;void 0!==a.segmentIds&&(r=a.segmentIds[e],n=a.segmentStartOffsets[e],o=a.segmentEndOffsets[e]),t.acceptLine&&t.acceptLine(a.featureIds[e],a.techniqueIndex[e],a.textIndex[e],this.getTag(e,a.layerIndex),this.getTag(e,a.classIndex),this.getTag(e,a.typeIndex),i.lineGroup.positions,u,l,r,n,o)},e.prototype.visitPolygonFeature=function(t,r){if(void 0!==r.acceptPolygon){var n=this.tileInfo.polygonGroup,o=n.numFeatures,i=n.outerRingStartIndex[t],a=t===o-1?n.innerRingStartIndex.length-i:n.outerRingStartIndex[t+1]-i;e.polygonAccessor.setup(n,t,i,a),r.acceptPolygon(n.featureIds[t],n.techniqueIndex[t],n.textIndex[t],this.getTag(t,n.layerIndex),this.getTag(t,n.classIndex),this.getTag(t,n.typeIndex),e.polygonAccessor),e.polygonAccessor.reset()}},e.polygonAccessor=new h,e}();t.ExtendedTileInfoVisitor=p},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),a=r(5),s=r(1),u=r(9),l=s.LoggerManager.instance.create("TileDecoderService"),c=function(e){function t(t,r){var n=e.call(this,t)||this;return n.serviceId=t,n.m_decoder=r,n.m_decoder.connect(),n}return o(t,e),t.start=function(e,r){return new t(e,r)},t.prototype.handleRequest=function(t){return i.WorkerDecoderProtocol.isDecodeTileRequest(t)?this.handleDecodeTileRequest(t):i.WorkerDecoderProtocol.isTileInfoRequest(t)?this.handleTileInfoRequest(t):e.prototype.handleRequest.call(this,t)},t.prototype.handleMessage=function(e){i.WorkerDecoderProtocol.isConfigurationMessage(e)?this.handleConfigurationMessage(e):l.error("["+this.serviceId+"]: invalid message "+e.type)},t.prototype.handleDecodeTileRequest=function(e){var t=a.TileKey.fromMortonCode(e.tileKey),r=i.getProjection(e.projection);return this.m_decoder.decodeTile(e.data,t,r,e.displayZoomLevel).then(function(e){var t=[];return e.geometries.forEach(function(e){e.vertexAttributes.forEach(function(e){e.buffer instanceof ArrayBuffer&&t.push(e.buffer)}),e.index&&e.index.buffer instanceof ArrayBuffer&&t.push(e.index.buffer)}),e.techniques.forEach(function(e){i.isStandardTexturedTechnique(e)&&i.isTextureBuffer(e.texture)&&e.texture.buffer instanceof ArrayBuffer&&t.push(e.texture.buffer)}),{response:e,transferList:t}})},t.prototype.handleTileInfoRequest=function(e){var t=a.TileKey.fromMortonCode(e.tileKey),r=i.getProjection(e.projection);return this.m_decoder.getTileInfo(e.data,t,r,e.displayZoomLevel).then(function(e){return{response:e,transferList:void 0!==e&&void 0!==e.transferList?e.transferList:[]}})},t.prototype.handleConfigurationMessage=function(e){this.m_decoder.configure(e.styleSet,e.languages,e.options)},t}(u.WorkerService);t.TileDecoderService=c},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}u((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(2),u=r(5),l=r(1),c=r(9),f=r(61),h=l.LoggerManager.instance.create("TilerService"),p=function(e){function t(t){var r=e.call(this,t)||this;return r.serviceId=t,r.m_tileIndexMap=new Map,r}return o(t,e),t.start=function(e){return new t(e)},t.prototype.handleRequest=function(t){return s.WorkerTilerProtocol.isRegisterIndexRequest(t)?this.handleRegisterIndexRequest(t):s.WorkerTilerProtocol.isTileRequest(t)?this.handleTileRequest(t):e.prototype.handleRequest.call(this,t)},t.prototype.handleTileRequest=function(e){return i(this,void 0,void 0,function(){var t,r;return a(this,function(n){return void 0===(t=this.m_tileIndexMap.get(e.index))?[2,{response:{}}]:(r=u.TileKey.fromMortonCode(e.tileKey),[2,{response:t.getTile(r.level,r.column,r.row)||{}}])})})},t.prototype.handleRegisterIndexRequest=function(e){return i(this,void 0,void 0,function(){var t,r,n;return a(this,function(o){switch(o.label){case 0:return void 0!==(t=this.m_tileIndexMap.get(e.id))?[3,3]:[4,fetch(e.url)];case 1:return(r=o.sent()).ok?[4,r.text()]:(h.error(e.url+" Status Text:  "+r.statusText),[2,{response:{}}]);case 2:n=o.sent(),t=f.default(JSON.parse(n),{maxZoom:20,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:0,lineMetrics:!1,promoteId:null,generateId:!1,debug:0}),this.m_tileIndexMap.set(e.id,t),o.label=3;case 3:return[2,{response:{}}]}})})},t}(c.WorkerService);t.TilerService=p},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),a=r(1),s=r(9),u=(a.LoggerManager.instance.create("WorkerServiceManager"),function(e){function t(t){void 0===t&&(t=i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID);var r=e.call(this,t)||this;return r.m_factories=new Map,r.m_services=new Map,r}return o(t,e),t.getInstance=function(){return void 0===this.m_service&&(this.m_service=new t(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID)),this.m_service},t.prototype.register=function(e){this.m_factories.set(e.serviceType,e.factory)},t.prototype.handleRequest=function(e){if(e.type===i.WorkerServiceProtocol.Requests.CreateService){if(void 0!==this.m_services.get(e.targetServiceId))throw Error("error - service with targetServiceId='"+e.targetServiceId+"' already running, ignoring CreateService request");var t=this.m_factories.get(e.targetServiceType);if(void 0===t)throw Error("unknown targetServiceType requested: '"+e.targetServiceType+"'");var r=t(e.targetServiceId);this.m_services.set(e.targetServiceId,r)}if(e.type===i.WorkerServiceProtocol.Requests.DestroyService){if(void 0===(r=this.m_services.get(e.targetServiceId)))throw Error("unknown targetServiceId '"+e.targetServiceId+"'");r.destroy(),this.m_services.delete(e.targetServiceId)}return Promise.resolve({response:{}})},t}(s.WorkerService));t.WorkerServiceManager=u},function(e,t,r){"use strict";function n(e,t,r,n,o,i){var a=o-r,s=i-n;if(0!==a||0!==s){var u=((e-r)*a+(t-n)*s)/(a*a+s*s);u>1?(r=o,n=i):u>0&&(r+=a*u,n+=s*u)}return(a=e-r)*a+(s=t-n)*s}function o(e,t,r,n){var o={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)i(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)i(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)i(e,t[n][o])}(o),o}function i(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function a(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,c=t.geometry.type,f=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),h=[],p=t.id;if(r.promoteId?p=t.properties[r.promoteId]:r.generateId&&(p=n||0),"Point"===c)s(i,h);else if("MultiPoint"===c)for(var d=0;d<i.length;d++)s(i[d],h);else if("LineString"===c)u(i,h,f,!1);else if("MultiLineString"===c){if(r.lineMetrics){for(d=0;d<i.length;d++)h=[],u(i[d],h,f,!1),e.push(o(p,"LineString",h,t.properties));return}l(i,h,f,!1)}else if("Polygon"===c)l(i,h,f,!0);else{if("MultiPolygon"!==c){if("GeometryCollection"===c){for(d=0;d<t.geometry.geometries.length;d++)a(e,{id:p,geometry:t.geometry.geometries[d],properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(d=0;d<i.length;d++){var y=[];l(i[d],y,f,!0),h.push(y)}}e.push(o(p,c,h,t.properties))}}function s(e,t){t.push(c(e[0])),t.push(f(e[1])),t.push(0)}function u(e,t,r,o){for(var i,a,s=0,u=0;u<e.length;u++){var l=c(e[u][0]),h=f(e[u][1]);t.push(l),t.push(h),t.push(0),u>0&&(s+=o?(i*h-l*a)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(h-a,2))),i=l,a=h}var p=t.length-3;t[2]=1,function e(t,r,o,i){for(var a,s=i,u=o-r>>1,l=o-r,c=t[r],f=t[r+1],h=t[o],p=t[o+1],d=r+3;d<o;d+=3){var y=n(t[d],t[d+1],c,f,h,p);if(y>s)a=d,s=y;else if(y===s){var v=Math.abs(d-u);v<l&&(a=d,l=v)}}s>i&&(a-r>3&&e(t,r,a,i),t[a+2]=s,o-a>3&&e(t,a,o,i))}(t,0,p,r),t[p+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function l(e,t,r,n){for(var o=0;o<e.length;o++){var i=[];u(e[o],i,r,n),t.push(i)}}function c(e){return e/360+.5}function f(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function h(e,t,r,n,i,a,s,u){if(n/=t,a>=(r/=t)&&s<n)return e;if(s<r||a>=n)return null;for(var l=[],c=0;c<e.length;c++){var f=e[c],h=f.geometry,y=f.type,g=0===i?f.minX:f.minY,m=0===i?f.maxX:f.maxY;if(g>=r&&m<n)l.push(f);else if(!(m<r||g>=n)){var x=[];if("Point"===y||"MultiPoint"===y)p(h,x,r,n,i);else if("LineString"===y)d(h,x,r,n,i,!1,u.lineMetrics);else if("MultiLineString"===y)v(h,x,r,n,i,!1);else if("Polygon"===y)v(h,x,r,n,i,!0);else if("MultiPolygon"===y)for(var _=0;_<h.length;_++){var E=[];v(h[_],E,r,n,i,!0),E.length&&x.push(E)}if(x.length){if(u.lineMetrics&&"LineString"===y){for(_=0;_<x.length;_++)l.push(o(f.id,y,x[_],f.tags));continue}"LineString"!==y&&"MultiLineString"!==y||(1===x.length?(y="LineString",x=x[0]):y="MultiLineString"),"Point"!==y&&"MultiPoint"!==y||(y=3===x.length?"Point":"MultiPoint"),l.push(o(f.id,y,x,f.tags))}}}return l.length?l:null}function p(e,t,r,n,o){for(var i=0;i<e.length;i+=3){var a=e[i+o];a>=r&&a<=n&&(t.push(e[i]),t.push(e[i+1]),t.push(e[i+2]))}}function d(e,t,r,n,o,i,a){for(var s,u,l=y(e),c=0===o?m:x,f=e.start,h=0;h<e.length-3;h+=3){var p=e[h],d=e[h+1],v=e[h+2],_=e[h+3],E=e[h+4],b=0===o?p:d,w=0===o?_:E,P=!1;a&&(s=Math.sqrt(Math.pow(p-_,2)+Math.pow(d-E,2))),b<r?w>r&&(u=c(l,p,d,_,E,r),a&&(l.start=f+s*u)):b>n?w<n&&(u=c(l,p,d,_,E,n),a&&(l.start=f+s*u)):g(l,p,d,v),w<r&&b>=r&&(u=c(l,p,d,_,E,r),P=!0),w>n&&b<=n&&(u=c(l,p,d,_,E,n),P=!0),!i&&P&&(a&&(l.end=f+s*u),t.push(l),l=y(e)),a&&(f+=s)}var M=e.length-3;p=e[M],d=e[M+1],v=e[M+2],(b=0===o?p:d)>=r&&b<=n&&g(l,p,d,v),M=l.length-3,i&&M>=3&&(l[M]!==l[0]||l[M+1]!==l[1])&&g(l,l[0],l[1],l[2]),l.length&&t.push(l)}function y(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function v(e,t,r,n,o,i){for(var a=0;a<e.length;a++)d(e[a],t,r,n,o,i,!1)}function g(e,t,r,n){e.push(t),e.push(r),e.push(n)}function m(e,t,r,n,o,i){var a=(i-t)/(n-t);return e.push(i),e.push(r+(o-r)*a),e.push(1),a}function x(e,t,r,n,o,i){var a=(i-r)/(o-r);return e.push(t+(n-t)*a),e.push(i),e.push(1),a}function _(e,t){for(var r=[],n=0;n<e.length;n++){var i,a=e[n],s=a.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)i=E(a.geometry,t);else if("MultiLineString"===s||"Polygon"===s){i=[];for(var u=0;u<a.geometry.length;u++)i.push(E(a.geometry[u],t))}else if("MultiPolygon"===s)for(i=[],u=0;u<a.geometry.length;u++){for(var l=[],c=0;c<a.geometry[u].length;c++)l.push(E(a.geometry[u][c],t));i.push(l)}r.push(o(a.id,s,i,a.tags))}return r}function E(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function b(e,t){if(e.transformed)return e;var r,n,o,i=1<<e.z,a=e.x,s=e.y;for(r=0;r<e.features.length;r++){var u=e.features[r],l=u.geometry,c=u.type;if(u.geometry=[],1===c)for(n=0;n<l.length;n+=2)u.geometry.push(w(l[n],l[n+1],t,i,a,s));else for(n=0;n<l.length;n++){var f=[];for(o=0;o<l[n].length;o+=2)f.push(w(l[n][o],l[n][o+1],t,i,a,s));u.geometry.push(f)}}return e.transformed=!0,e}function w(e,t,r,n,o,i){return[Math.round(r*(e*n-o)),Math.round(r*(t*n-i))]}function P(e,t,r,n,o){for(var i=t===o.maxZoom?0:o.tolerance/((1<<t)*o.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,M(a,e[s],i,o);var u=e[s].minX,l=e[s].minY,c=e[s].maxX,f=e[s].maxY;u<a.minX&&(a.minX=u),l<a.minY&&(a.minY=l),c>a.maxX&&(a.maxX=c),f>a.maxY&&(a.maxY=f)}return a}function M(e,t,r,n){var o=t.geometry,i=t.type,a=[];if("Point"===i||"MultiPoint"===i)for(var s=0;s<o.length;s+=3)a.push(o[s]),a.push(o[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===i)I(a,o,e,r,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(s=0;s<o.length;s++)I(a,o[s],e,r,"Polygon"===i,0===s);else if("MultiPolygon"===i)for(var u=0;u<o.length;u++){var l=o[u];for(s=0;s<l.length;s++)I(a,l[s],e,r,!0,0===s)}if(a.length){var c=t.tags||null;if("LineString"===i&&n.lineMetrics){for(var f in c={},t.tags)c[f]=t.tags[f];c.mapbox_clip_start=o.start/o.size,c.mapbox_clip_end=o.end/o.size}var h={geometry:a,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:c};null!==t.id&&(h.id=t.id),e.features.push(h)}}function I(e,t,r,n,o,i){var a=n*n;if(n>0&&t.size<(o?a:n))r.numPoints+=t.length/3;else{for(var s=[],u=0;u<t.length;u+=3)(0===n||t[u+2]>a)&&(r.numSimplified++,s.push(t[u]),s.push(t[u+1])),r.numPoints++;o&&function(e,t){for(var r=0,n=0,o=e.length,i=o-2;n<o;i=n,n+=2)r+=(e[n]-e[i])*(e[n+1]+e[i+1]);if(r>0===t)for(n=0,o=e.length;n<o/2;n+=2){var a=e[n],s=e[n+1];e[n]=e[o-2-n],e[n+1]=e[o-1-n],e[o-2-n]=a,e[o-1-n]=s}}(s,i),e.push(s)}}function S(e,t){return new T(e,t)}function T(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)a(r,e.features[n],t,n);else"Feature"===e.type?a(r,e,t):a(r,{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(e,t){var r=t.buffer/t.extent,n=e,o=h(e,1,-1-r,r,0,-1,2,t),i=h(e,1,1-r,2+r,0,-1,2,t);return(o||i)&&(n=h(e,1,-r,1+r,0,-1,2,t)||[],o&&(n=_(o,1).concat(n)),i&&(n=n.concat(_(i,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function R(e,t,r){return 32*((1<<e)*r+t)+e}r.r(t),r.d(t,"default",function(){return S}),T.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},T.prototype.splitTile=function(e,t,r,n,o,i,a){for(var s=[e,t,r,n],u=this.options,l=u.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,f=R(t,r,n),p=this.tiles[f];if(!p&&(l>1&&console.time("creation"),p=this.tiles[f]=P(e,t,r,n,u),this.tileCoords.push({z:t,x:r,y:n}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+t;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=e,o){if(t===u.maxZoom||t===o)continue;var y=1<<o-t;if(r!==Math.floor(i/y)||n!==Math.floor(a/y))continue}else if(t===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(p.source=null,0!==e.length){l>1&&console.time("clipping");var v,g,m,x,_,E,b=.5*u.buffer/u.extent,w=.5-b,M=.5+b,I=1+b;v=g=m=x=null,_=h(e,c,r-b,r+M,0,p.minX,p.maxX,u),E=h(e,c,r+w,r+I,0,p.minX,p.maxX,u),e=null,_&&(v=h(_,c,n-b,n+M,1,p.minY,p.maxY,u),g=h(_,c,n+w,n+I,1,p.minY,p.maxY,u),_=null),E&&(m=h(E,c,n-b,n+M,1,p.minY,p.maxY,u),x=h(E,c,n+w,n+I,1,p.minY,p.maxY,u),E=null),l>1&&console.timeEnd("clipping"),s.push(v||[],t+1,2*r,2*n),s.push(g||[],t+1,2*r,2*n+1),s.push(m||[],t+1,2*r+1,2*n),s.push(x||[],t+1,2*r+1,2*n+1)}}},T.prototype.getTile=function(e,t,r){var n=this.options,o=n.extent,i=n.debug;if(e<0||e>24)return null;var a=1<<e,s=R(e,t=(t%a+a)%a,r);if(this.tiles[s])return b(this.tiles[s],o);i>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var u,l=e,c=t,f=r;!u&&l>0;)l--,c=Math.floor(c/2),f=Math.floor(f/2),u=this.tiles[R(l,c,f)];return u&&u.source?(i>1&&console.log("found parent tile z%d-%d-%d",l,c,f),i>1&&console.time("drilling down"),this.splitTile(u.source,l,c,f,e,t,r),i>1&&console.timeEnd("drilling down"),this.tiles[s]?b(this.tiles[s],o):null):null}}]);
//# sourceMappingURL=quantized-mesh-decoder.bundle.js.map